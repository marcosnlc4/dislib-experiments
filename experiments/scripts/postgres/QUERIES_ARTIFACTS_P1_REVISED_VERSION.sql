-- ### FINAL QUERIES FOR GITHUB REPO
--QUERIES CHARTS PAPER
-- #### FIGURE 7. End-to-end performance analysis (MODE == 200) ####
-- FIGURE 7(a) - PART 1 - SPEEDUPS MATMUL
WITH T_CPU AS (
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_COMMUNICATION_TIME,
	(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
			AND A.NR_ALGORITHM_ITERATION <> 0
		) X
		WHERE
		X.DS_FUNCTION = 'MATMUL_FUNC'
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y

),
T_GPU AS (                         
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_COMMUNICATION_TIME,
	(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
			AND A.NR_ALGORITHM_ITERATION <> 0
		) X
		WHERE
		X.DS_FUNCTION = 'MATMUL_FUNC'
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y
)
SELECT
T_CPU.DS_ALGORITHM,
T_CPU.DS_DATASET,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)   || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
CASE
WHEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME)
ELSE -(T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME)
END AS SPEEDUP_GPU_TOTAL_EXECUTION_TIME
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
AND T_CPU.ds_dataset = 'S_8GB_1'
AND T_CPU.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET



-- FIGURE 7(a) - PART 2 - EXECUTION TIMES MATMUL
SELECT
DS_ALGORITHM,
DS_DEVICE,
CASE
	WHEN DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
VL_BLOCK_ROW_X_COLUMN_DIMENSION,
VL_GRID_ROW_X_COLUMN_DIMENSION,
VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_USER_CODE_TIME,
VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME,
VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME,
VL_COMMUNICATION_TIME AS VL_CPU_GPU_COMMUNICATION_TIME
FROM
(
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_COMMUNICATION_TIME,
		Y.VL_ADDITIONAL_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
		Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
					A.DT_PROCESSING,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM EXPERIMENT_RAW A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				A.NR_ALGORITHM_ITERATION <> 0
			) X
			GROUP BY
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
) ZZ
WHERE
ZZ.ds_algorithm='MATMUL_DISLIB'
AND ZZ.ds_dataset = 'S_8GB_1'
AND ZZ.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
AND ZZ.ds_device = 'GPU'
ORDER BY
DS_DEVICE,
VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
DS_ALGORITHM DESC


-- #### FIGURE 7(a) - PART 3 - SPEEDUPS MATMUL - LARGER DATASETS  ####
WITH T_CPU AS (
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_COMMUNICATION_TIME,
	(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		) X
		WHERE
		X.DS_FUNCTION = 'MATMUL_FUNC'
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y

),
T_GPU AS (                         
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_COMMUNICATION_TIME,
	(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
			AND A.ID_EXPERIMENT NOT IN (370685,370675,370662,370681,370667,370670,370676,370652,370679,370669) -- GRID ROW DIM 16
			AND A.ID_EXPERIMENT NOT IN (380224,380190,380234,380233,380206,380248,380156,380152,380151,380158) -- GRID ROW DIM 8
			AND A.ID_EXPERIMENT NOT IN (362026,362018,362024,362037,362036,362028,362032,362029,362023,362052) -- GRID ROW DIM 4
		) X
		WHERE
		X.DS_FUNCTION = 'MATMUL_FUNC'
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y
)
SELECT
T_CPU.DS_ALGORITHM,
T_CPU.DS_DATASET,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)   || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
CASE
WHEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME)
ELSE -(T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME)
END AS SPEEDUP_GPU_TOTAL_EXECUTION_TIME
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
AND T_CPU.ds_dataset = 'S_32GB_1'
AND T_CPU.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET



-- #### FIGURE 7(a) - PART 3 - EXECUTION TIMES MATMUL - LARGER DATASETS  ####
SELECT
DS_ALGORITHM,
DS_DEVICE,
CASE
	WHEN DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
VL_BLOCK_ROW_X_COLUMN_DIMENSION,
VL_GRID_ROW_X_COLUMN_DIMENSION,
VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_USER_CODE_TIME,
VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME,
VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME,
VL_COMMUNICATION_TIME AS VL_CPU_GPU_COMMUNICATION_TIME
FROM
(
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_COMMUNICATION_TIME,
		Y.VL_ADDITIONAL_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
		Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
					A.DT_PROCESSING,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM EXPERIMENT_RAW A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				A.ID_EXPERIMENT NOT IN (370685,370675,370662,370681,370667,370670,370676,370652,370679,370669) -- GRID ROW DIM 16
				AND A.ID_EXPERIMENT NOT IN (380224,380190,380234,380233,380206,380248,380156,380152,380151,380158) -- GRID ROW DIM 8
				AND A.ID_EXPERIMENT NOT IN (362026,362018,362024,362037,362036,362028,362032,362029,362023,362052) -- GRID ROW DIM 4
			) X
			GROUP BY
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
) ZZ
WHERE
ZZ.ds_algorithm='MATMUL_DISLIB'
AND ZZ.ds_dataset = 'S_32GB_1'
AND ZZ.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
AND ZZ.ds_device = 'GPU'
ORDER BY
DS_DEVICE,
VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
DS_ALGORITHM DESC





-- FIGURE 7(b) - PART 1 - SPEEDUPS KMEANS
WITH T_CPU AS (                                                 
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_COMMUNICATION_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_ADDITIONAL_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION,
		Y.ID_PARAMETER,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_FUNCTION,
		Y.DS_FUNCTION,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					A.DT_PROCESSING,
					B.ID_PARAMETER,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM schema_dev.ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM schema_dev.FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM schema_dev.FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM schema_dev.FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM schema_dev.EXPERIMENT_RAW A
				INNER JOIN schema_dev.PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN schema_dev.RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN schema_dev.DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				(SELECT DISTINCT Z.DS_DEVICE FROM schema_dev.FUNCTION W INNER JOIN schema_dev.DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
				AND A.NR_ALGORITHM_ITERATION <> 0
			) X
			GROUP BY
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y

	),
T_GPU AS (
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_COMMUNICATION_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_ADDITIONAL_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION,
		Y.ID_PARAMETER,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_FUNCTION,
		Y.DS_FUNCTION,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					A.DT_PROCESSING,
					B.ID_PARAMETER,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM schema_dev.ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM schema_dev.EXPERIMENT_RAW A
				INNER JOIN schema_dev.PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN schema_dev.RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN schema_dev.DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN schema_dev.DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
				AND A.NR_ALGORITHM_ITERATION <> 0
			) X
			GROUP BY
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
)
SELECT
T_CPU.DS_ALGORITHM,
T_CPU.DS_DATASET,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
END AS SPEEDUP_PARALLEL_FRACTION,--SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION)
END AS SPEEDUP_USER_CODE,--SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
CASE
WHEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME)
ELSE -(T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME)
END AS SPEEDUP_PARALLEL_TASK--SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
AND T_CPU.ds_dataset = 'S_10GB_1'
AND T_CPU.ds_parameter_type = 'VAR_GRID_ROW_5'
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET








-- FIGURE 7(b) - PART 2 - EXECUTION TIMES KMEANS
SELECT
DS_ALGORITHM,
DS_DEVICE,
CASE
	WHEN DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
VL_BLOCK_ROW_X_COLUMN_DIMENSION,
VL_GRID_ROW_X_COLUMN_DIMENSION,
VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_USER_CODE_TIME,
VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME,
VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME,
VL_COMMUNICATION_TIME AS VL_CPU_GPU_COMMUNICATION_TIME
FROM
(
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_COMMUNICATION_TIME,
		Y.VL_ADDITIONAL_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
		Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
					A.DT_PROCESSING,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM EXPERIMENT_RAW A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				A.NR_ALGORITHM_ITERATION <> 0
			) X
			GROUP BY
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
) ZZ
WHERE
ZZ.nr_iterations = 5
AND ZZ.ds_algorithm='KMEANS'
AND ZZ.ds_dataset = 'S_10GB_1'
AND ZZ.ds_parameter_type = 'VAR_GRID_ROW_5'
AND ZZ.ds_device = 'GPU'
ORDER BY
DS_DEVICE,
VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
DS_ALGORITHM DESC




-- FIGURE 7(b) - PART 2 - SPEEDUPS KMEANS - LARGER DATASETS
WITH T_CPU AS (                                                 
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_COMMUNICATION_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_ADDITIONAL_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION,
		Y.ID_PARAMETER,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_FUNCTION,
		Y.DS_FUNCTION,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					A.DT_PROCESSING,
					B.ID_PARAMETER,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM schema_dev.ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM schema_dev.FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM schema_dev.FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM schema_dev.FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM schema_dev.EXPERIMENT_RAW A
				INNER JOIN schema_dev.PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN schema_dev.RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN schema_dev.DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				(SELECT DISTINCT Z.DS_DEVICE FROM schema_dev.FUNCTION W INNER JOIN schema_dev.DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
			) X
			GROUP BY
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y

	),
T_GPU AS (
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_COMMUNICATION_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_ADDITIONAL_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION,
		Y.ID_PARAMETER,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_FUNCTION,
		Y.DS_FUNCTION,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					A.DT_PROCESSING,
					B.ID_PARAMETER,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM schema_dev.ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN schema_dev.DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM schema_dev.PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM schema_dev.EXPERIMENT_RAW A
				INNER JOIN schema_dev.PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN schema_dev.RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN schema_dev.DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN schema_dev.DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
				AND A.ID_EXPERIMENT NOT IN (778235,778499,778234,778250,778251,778249,778248,778241,778240,778239) -- GRID ROW DIM 256
				AND A.ID_EXPERIMENT NOT IN (791476,791478,791474,791498,791473,791614,791472,791471,791501,791613) -- GRID ROW DIM 128
				AND A.ID_EXPERIMENT NOT IN (790508,790515,790496,790510,790517,790516,790518,790498,790497,790525) -- GRID ROW DIM 64
				AND A.ID_EXPERIMENT NOT IN (776778,776777,776780,776779,776776,776794,776793,776795,776792,776791) -- GRID ROW DIM 32
				AND A.ID_EXPERIMENT NOT IN (790087,790094,790086,790098,790100,790099,790096,790097,790149,790104) -- GRID ROW DIM 16
			) X
			GROUP BY
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
)
SELECT
T_CPU.DS_ALGORITHM,
T_CPU.DS_DATASET,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
END AS SPEEDUP_PARALLEL_FRACTION,--SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION)
ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_COMMUNICATION)
END AS SPEEDUP_USER_CODE,--SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
CASE
WHEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME)
ELSE -(T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME)
END AS SPEEDUP_PARALLEL_TASK--SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
AND T_CPU.ds_dataset = 'S_100GB_1'
AND T_CPU.ds_parameter_type = 'VAR_GRID_ROW_5'
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET



-- FIGURE 7(b) - PART 2 - EXECUTION TIMES KMEANS - LARGER DATASETS
SELECT
DS_ALGORITHM,
DS_DEVICE,
CASE
	WHEN DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION + VL_GRID_ROW_DIMENSION*VL_GRID_ROW_DIMENSION*(VL_GRID_ROW_DIMENSION-1)  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
VL_BLOCK_ROW_X_COLUMN_DIMENSION,
VL_GRID_ROW_X_COLUMN_DIMENSION,
VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_USER_CODE_TIME,
VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME,
VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME,
VL_COMMUNICATION_TIME AS VL_CPU_GPU_COMMUNICATION_TIME
FROM
(
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_COMMUNICATION_TIME,
		Y.VL_ADDITIONAL_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
		Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
					A.DT_PROCESSING,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM EXPERIMENT_RAW A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				A.ID_EXPERIMENT NOT IN (778235,778499,778234,778250,778251,778249,778248,778241,778240,778239) -- GRID ROW DIM 256
				AND A.ID_EXPERIMENT NOT IN (791476,791478,791474,791498,791473,791614,791472,791471,791501,791613) -- GRID ROW DIM 128
				AND A.ID_EXPERIMENT NOT IN (790508,790515,790496,790510,790517,790516,790518,790498,790497,790525) -- GRID ROW DIM 64
				AND A.ID_EXPERIMENT NOT IN (776778,776777,776780,776779,776776,776794,776793,776795,776792,776791) -- GRID ROW DIM 32
				AND A.ID_EXPERIMENT NOT IN (790087,790094,790086,790098,790100,790099,790096,790097,790149,790104) -- GRID ROW DIM 16
			) X
			GROUP BY
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
) ZZ
WHERE
ZZ.nr_iterations = 5
AND ZZ.ds_algorithm='KMEANS'
AND ZZ.ds_dataset = 'S_100GB_1'
AND ZZ.ds_parameter_type = 'VAR_GRID_ROW_5'
AND ZZ.ds_device = 'GPU'
ORDER BY
DS_DEVICE,
VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
DS_ALGORITHM DESC














-- #### FIGURE 8. Task computational complexity in Matmul (MODE == 100) ####
WITH T_CPU AS (
	SELECT
				Y.VL_TOTAL_EXECUTION_TIME,
				Y.VL_INTER_TASK_EXECUTION_TIME,
				Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
				Y.VL_COMMUNICATION_TIME,
				Y.ID_PARAMETER,
				Y.CD_PARAMETER,
				Y.CD_CONFIGURATION,
				Y.ID_ALGORITHM,
				Y.DS_ALGORITHM,
				Y.ID_FUNCTION,
				Y.DS_FUNCTION,
				Y.ID_DEVICE,
				Y.DS_DEVICE,
				Y.ID_DATASET,
				Y.ID_RESOURCE,
				Y.ID_PARAMETER_TYPE,
				Y.DS_PARAMETER_TYPE,
				Y.DS_PARAMETER_ATTRIBUTE,
				Y.NR_ITERATIONS,
				Y.VL_GRID_ROW_DIMENSION,
				Y.VL_GRID_COLUMN_DIMENSION,
				Y.VL_BLOCK_ROW_DIMENSION,
				Y.VL_BLOCK_COLUMN_DIMENSION,
				Y.VL_BLOCK_MEMORY_SIZE,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				Y.DS_RESOURCE,
				Y.NR_NODES,
				Y.NR_COMPUTING_UNITS_CPU,
				Y.NR_COMPUTING_UNITS_GPU,
				Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				Y.DS_DATASET,
				Y.VL_DATASET_MEMORY_SIZE,
				Y.DS_DATA_TYPE,
				Y.VL_DATA_TYPE_MEMORY_SIZE,
				Y.VL_DATASET_DIMENSION,
				Y.VL_DATASET_ROW_DIMENSION,
				Y.VL_DATASET_COLUMN_DIMENSION,
				Y.NR_RANDOM_STATE
				FROM
				(
					SELECT
					AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
					AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
					AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
					AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
					AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
					AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
					AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
					AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
					X.ID_PARAMETER,
					X.CD_PARAMETER,
					X.CD_CONFIGURATION,
					X.ID_ALGORITHM,
					X.DS_ALGORITHM,
					X.ID_FUNCTION,
					X.DS_FUNCTION,
					X.ID_DEVICE,
					X.DS_DEVICE,
					X.ID_DATASET,
					X.ID_RESOURCE,
					X.ID_PARAMETER_TYPE,
					X.DS_PARAMETER_TYPE,
					X.DS_PARAMETER_ATTRIBUTE,
					X.NR_ITERATIONS,
					X.VL_GRID_ROW_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION,
					X.VL_GRID_ROW_X_COLUMN_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_BLOCK_ROW_DIMENSION,
					X.VL_BLOCK_COLUMN_DIMENSION,
					X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					X.VL_BLOCK_MEMORY_SIZE,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.DS_RESOURCE,
					X.NR_NODES,
					X.NR_COMPUTING_UNITS_CPU,
					X.NR_COMPUTING_UNITS_GPU,
					X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					X.DS_DATASET,
					X.VL_DATASET_MEMORY_SIZE,
					X.DS_DATA_TYPE,
					X.VL_DATA_TYPE_MEMORY_SIZE,
					X.VL_DATASET_DIMENSION,
					X.VL_DATASET_ROW_DIMENSION,
					X.VL_DATASET_COLUMN_DIMENSION,
					X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
					X.NR_RANDOM_STATE
					FROM
					(
						SELECT
							A.ID_EXPERIMENT,
							A.VL_TOTAL_EXECUTION_TIME,
							A.VL_INTER_TASK_EXECUTION_TIME,
							A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
							A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
							A.VL_COMMUNICATION_TIME_1,
							A.VL_COMMUNICATION_TIME_2,
							A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
							A.VL_ADDITIONAL_TIME_1,
							A.VL_ADDITIONAL_TIME_2,
							A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
							A.DT_PROCESSING,
							B.ID_PARAMETER,
							B.CD_PARAMETER,
							B.CD_CONFIGURATION,
							B.ID_ALGORITHM,
							(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
							B.ID_FUNCTION,
							(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
							(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
							(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
							B.ID_DATASET,
							B.ID_RESOURCE,
							B.ID_PARAMETER_TYPE,
							(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
							(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
							B.NR_ITERATIONS,
							B.VL_GRID_ROW_DIMENSION,
							B.VL_GRID_COLUMN_DIMENSION,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
							ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
							B.VL_BLOCK_ROW_DIMENSION,
							B.VL_BLOCK_COLUMN_DIMENSION,
							B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
							B.VL_BLOCK_MEMORY_SIZE,
							B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
							B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
							ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							C.DS_RESOURCE,
							C.NR_NODES,
							C.NR_COMPUTING_UNITS_CPU,
							C.NR_COMPUTING_UNITS_GPU,
							C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
							C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
							D.DS_DATASET,
							D.VL_DATASET_MEMORY_SIZE,
							D.DS_DATA_TYPE,
							D.VL_DATA_TYPE_MEMORY_SIZE,
							D.VL_DATASET_DIMENSION,
							D.VL_DATASET_ROW_DIMENSION,
							D.VL_DATASET_COLUMN_DIMENSION,
							D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
							D.NR_RANDOM_STATE
						FROM EXPERIMENT_RAW A
						INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
						INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
						INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
						WHERE
						(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
						AND A.NR_ALGORITHM_ITERATION <> 0
					) X
					WHERE
					-- START FILTERS FOR FIGURE 8 PART 1
						X.DS_FUNCTION = 'MATMUL_FUNC'
					-- END FILTERS FOR FIGURE 8 PART 1
					-- START FILTERS FOR FIGURE 8 PART 2
						--X.DS_FUNCTION = 'ADD_FUNC'
					-- END FILTERS FOR FIGURE 8 PART 2
					GROUP BY
					X.ID_PARAMETER,
					X.CD_PARAMETER,
					X.CD_CONFIGURATION,
					X.ID_ALGORITHM,
					X.DS_ALGORITHM,
					X.ID_FUNCTION,
					X.DS_FUNCTION,
					X.ID_DEVICE,
					X.DS_DEVICE,
					X.ID_DATASET,
					X.ID_RESOURCE,
					X.ID_PARAMETER_TYPE,
					X.DS_PARAMETER_TYPE,
					X.DS_PARAMETER_ATTRIBUTE,
					X.NR_ITERATIONS,
					X.VL_GRID_ROW_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION,
					X.VL_GRID_ROW_X_COLUMN_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_BLOCK_ROW_DIMENSION,
					X.VL_BLOCK_COLUMN_DIMENSION,
					X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					X.VL_BLOCK_MEMORY_SIZE,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.DS_RESOURCE,
					X.NR_NODES,
					X.NR_COMPUTING_UNITS_CPU,
					X.NR_COMPUTING_UNITS_GPU,
					X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					X.DS_DATASET,
					X.VL_DATASET_MEMORY_SIZE,
					X.DS_DATA_TYPE,
					X.VL_DATA_TYPE_MEMORY_SIZE,
					X.VL_DATASET_DIMENSION,
					X.VL_DATASET_ROW_DIMENSION,
					X.VL_DATASET_COLUMN_DIMENSION,
					X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
					X.NR_RANDOM_STATE
				) Y

			),
T_GPU AS (
	SELECT
				Y.VL_TOTAL_EXECUTION_TIME,
				Y.VL_INTER_TASK_EXECUTION_TIME,
				Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
				Y.VL_COMMUNICATION_TIME,
				Y.ID_PARAMETER,
				Y.CD_PARAMETER,
				Y.CD_CONFIGURATION,
				Y.ID_ALGORITHM,
				Y.DS_ALGORITHM,
				Y.ID_FUNCTION,
				Y.DS_FUNCTION,
				Y.ID_DEVICE,
				Y.DS_DEVICE,
				Y.ID_DATASET,
				Y.ID_RESOURCE,
				Y.ID_PARAMETER_TYPE,
				Y.DS_PARAMETER_TYPE,
				Y.DS_PARAMETER_ATTRIBUTE,
				Y.NR_ITERATIONS,
				Y.VL_GRID_ROW_DIMENSION,
				Y.VL_GRID_COLUMN_DIMENSION,
				Y.VL_BLOCK_ROW_DIMENSION,
				Y.VL_BLOCK_COLUMN_DIMENSION,
				Y.VL_BLOCK_MEMORY_SIZE,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				Y.DS_RESOURCE,
				Y.NR_NODES,
				Y.NR_COMPUTING_UNITS_CPU,
				Y.NR_COMPUTING_UNITS_GPU,
				Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				Y.DS_DATASET,
				Y.VL_DATASET_MEMORY_SIZE,
				Y.DS_DATA_TYPE,
				Y.VL_DATA_TYPE_MEMORY_SIZE,
				Y.VL_DATASET_DIMENSION,
				Y.VL_DATASET_ROW_DIMENSION,
				Y.VL_DATASET_COLUMN_DIMENSION,
				Y.NR_RANDOM_STATE
				FROM
				(
					SELECT
					AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
					AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
					AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
					AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
					AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
					AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
					AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
					AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
					X.ID_PARAMETER,
					X.CD_PARAMETER,
					X.CD_CONFIGURATION,
					X.ID_ALGORITHM,
					X.DS_ALGORITHM,
					X.ID_FUNCTION,
					X.DS_FUNCTION,
					X.ID_DEVICE,
					X.DS_DEVICE,
					X.ID_DATASET,
					X.ID_RESOURCE,
					X.ID_PARAMETER_TYPE,
					X.DS_PARAMETER_TYPE,
					X.DS_PARAMETER_ATTRIBUTE,
					X.NR_ITERATIONS,
					X.VL_GRID_ROW_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION,
					X.VL_GRID_ROW_X_COLUMN_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_BLOCK_ROW_DIMENSION,
					X.VL_BLOCK_COLUMN_DIMENSION,
					X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					X.VL_BLOCK_MEMORY_SIZE,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.DS_RESOURCE,
					X.NR_NODES,
					X.NR_COMPUTING_UNITS_CPU,
					X.NR_COMPUTING_UNITS_GPU,
					X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					X.DS_DATASET,
					X.VL_DATASET_MEMORY_SIZE,
					X.DS_DATA_TYPE,
					X.VL_DATA_TYPE_MEMORY_SIZE,
					X.VL_DATASET_DIMENSION,
					X.VL_DATASET_ROW_DIMENSION,
					X.VL_DATASET_COLUMN_DIMENSION,
					X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
					X.NR_RANDOM_STATE
					FROM
					(
						SELECT
							A.ID_EXPERIMENT,
							A.VL_TOTAL_EXECUTION_TIME,
							A.VL_INTER_TASK_EXECUTION_TIME,
							A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
							A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
							A.VL_COMMUNICATION_TIME_1,
							A.VL_COMMUNICATION_TIME_2,
							A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
							A.VL_ADDITIONAL_TIME_1,
							A.VL_ADDITIONAL_TIME_2,
							A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
							A.DT_PROCESSING,
							B.ID_PARAMETER,
							B.CD_PARAMETER,
							B.CD_CONFIGURATION,
							B.ID_ALGORITHM,
							(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
							B.ID_FUNCTION,
							(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
							(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
							(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
							B.ID_DATASET,
							B.ID_RESOURCE,
							B.ID_PARAMETER_TYPE,
							(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
							(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
							B.NR_ITERATIONS,
							B.VL_GRID_ROW_DIMENSION,
							B.VL_GRID_COLUMN_DIMENSION,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
							ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
							B.VL_BLOCK_ROW_DIMENSION,
							B.VL_BLOCK_COLUMN_DIMENSION,
							B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
							B.VL_BLOCK_MEMORY_SIZE,
							B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
							B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
							ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							C.DS_RESOURCE,
							C.NR_NODES,
							C.NR_COMPUTING_UNITS_CPU,
							C.NR_COMPUTING_UNITS_GPU,
							C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
							C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
							D.DS_DATASET,
							D.VL_DATASET_MEMORY_SIZE,
							D.DS_DATA_TYPE,
							D.VL_DATA_TYPE_MEMORY_SIZE,
							D.VL_DATASET_DIMENSION,
							D.VL_DATASET_ROW_DIMENSION,
							D.VL_DATASET_COLUMN_DIMENSION,
							D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
							D.NR_RANDOM_STATE
						FROM EXPERIMENT_RAW A
						INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
						INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
						INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
						WHERE
						(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
						AND A.NR_ALGORITHM_ITERATION <> 0
					) X
					WHERE
					-- START FILTERS FOR FIGURE PART 1
						X.DS_FUNCTION = 'MATMUL_FUNC'
					-- END FILTERS FOR FIGURE PART 1
					-- START FILTERS FOR FIGURE PART 2
						--X.DS_FUNCTION = 'ADD_FUNC'
					-- END FILTERS FOR FIGURE PART 2
					GROUP BY
					X.ID_PARAMETER,
					X.CD_PARAMETER,
					X.CD_CONFIGURATION,
					X.ID_ALGORITHM,
					X.DS_ALGORITHM,
					X.ID_FUNCTION,
					X.DS_FUNCTION,
					X.ID_DEVICE,
					X.DS_DEVICE,
					X.ID_DATASET,
					X.ID_RESOURCE,
					X.ID_PARAMETER_TYPE,
					X.DS_PARAMETER_TYPE,
					X.DS_PARAMETER_ATTRIBUTE,
					X.NR_ITERATIONS,
					X.VL_GRID_ROW_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION,
					X.VL_GRID_ROW_X_COLUMN_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_BLOCK_ROW_DIMENSION,
					X.VL_BLOCK_COLUMN_DIMENSION,
					X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					X.VL_BLOCK_MEMORY_SIZE,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.DS_RESOURCE,
					X.NR_NODES,
					X.NR_COMPUTING_UNITS_CPU,
					X.NR_COMPUTING_UNITS_GPU,
					X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					X.DS_DATASET,
					X.VL_DATASET_MEMORY_SIZE,
					X.DS_DATA_TYPE,
					X.VL_DATA_TYPE_MEMORY_SIZE,
					X.VL_DATASET_DIMENSION,
					X.VL_DATASET_ROW_DIMENSION,
					X.VL_DATASET_COLUMN_DIMENSION,
					X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
					X.NR_RANDOM_STATE
				) Y
)
SELECT
T_CPU.ID_PARAMETER_TYPE,
T_CPU.CD_PARAMETER,
T_CPU.DS_ALGORITHM,
T_CPU.DS_FUNCTION,
T_CPU.NR_ITERATIONS,
CASE
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3
ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) END AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
CASE
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' END AS CONCAT_BLOCK_PERCENT_DATASET_GRID_DIMENSION,
T_CPU.DS_RESOURCE,
T_CPU.DS_PARAMETER_TYPE,
T_CPU.DS_PARAMETER_ATTRIBUTE,
T_CPU.DS_DATASET,
CAST(T_CPU.VL_DATASET_MEMORY_SIZE*1e-6 AS BIGINT) as VL_DATASET_MEMORY_SIZE,
T_CPU.VL_DATASET_DIMENSION,
T_CPU.VL_DATASET_ROW_DIMENSION,
T_CPU.VL_DATASET_COLUMN_DIMENSION,
T_CPU.VL_GRID_ROW_DIMENSION,
T_CPU.VL_GRID_COLUMN_DIMENSION,
T_CPU.VL_BLOCK_ROW_DIMENSION,
T_CPU.VL_BLOCK_COLUMN_DIMENSION,
T_CPU.VL_BLOCK_MEMORY_SIZE,
ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0)::varchar(255) as VL_BLOCK_MEMORY_SIZE_MB,
ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
	ELSE
		'999999999999'
END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC_CPU,
T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC_GPU,
T_CPU.VL_ADDITIONAL_TIME AS VL_ADDITIONAL_TIME_CPU,
T_GPU.VL_ADDITIONAL_TIME AS VL_ADDITIONAL_TIME_GPU,
T_CPU.VL_COMMUNICATION_TIME AS VL_COMMUNICATION_TIME_CPU,
T_GPU.VL_COMMUNICATION_TIME AS VL_COMMUNICATION_TIME_GPU,
CASE
WHEN ROUND((T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2) > 1.00 THEN ROUND((T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2)
ELSE -ROUND((T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2)
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
FROM T_CPU LEFT JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER
								AND T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
								AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
								AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
								AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION)
WHERE
T_CPU.ds_algorithm='MATMUL_DISLIB'
AND T_CPU.nr_iterations = 5
AND T_CPU.ds_dataset = 'S_8GB_1'
AND T_CPU.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
AND T_CPU.id_resource = 1
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET;




-- #### FIGURE 9(a). The effects of CPU-GPU communication and serial fraction processing on K-means for different clusters (MODE == 100) ####
WITH T_CPU AS (
	SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
	Y.VL_COMMUNICATION_TIME,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.DS_STORAGE,
	Y.NR_CLUSTER,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.DS_STORAGE,
		X.NR_CLUSTER,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				(SELECT X.DS_STORAGE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_STORAGE,
				(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS NR_CLUSTER,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
			AND A.NR_ALGORITHM_ITERATION <> 0
		) X
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.DS_STORAGE,
		X.NR_CLUSTER,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y

),
	T_GPU AS (
		SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
		Y.VL_COMMUNICATION_TIME,
		Y.ID_PARAMETER,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_FUNCTION,
		Y.DS_FUNCTION,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.DS_STORAGE,
		Y.NR_CLUSTER,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.DS_STORAGE,
			X.NR_CLUSTER,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					A.DT_PROCESSING,
					B.ID_PARAMETER,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					(SELECT X.DS_STORAGE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_STORAGE,
					(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS NR_CLUSTER,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM EXPERIMENT_RAW A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
				AND A.NR_ALGORITHM_ITERATION <> 0
			) X
			GROUP BY
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.DS_STORAGE,
			X.NR_CLUSTER,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) Y
	)
	SELECT
	T_CPU.ID_PARAMETER_TYPE,
	T_CPU.CD_PARAMETER,
	T_CPU.DS_ALGORITHM,
	T_CPU.DS_FUNCTION,
	T_CPU.NR_ITERATIONS,
	CASE
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3
	ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) END AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	CASE
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' END AS CONCAT_BLOCK_PERCENT_DATASET_GRID_DIMENSION,
	--ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	T_CPU.DS_RESOURCE,
	T_CPU.DS_PARAMETER_TYPE,
	T_CPU.DS_PARAMETER_ATTRIBUTE,
	T_CPU.DS_STORAGE,
	T_CPU.NR_CLUSTER,
	T_CPU.DS_DATASET,
	CAST(T_CPU.VL_DATASET_MEMORY_SIZE*1e-6 AS BIGINT) as VL_DATASET_MEMORY_SIZE,
	T_CPU.VL_DATASET_DIMENSION,
	T_CPU.VL_DATASET_ROW_DIMENSION,
	T_CPU.VL_DATASET_COLUMN_DIMENSION,
	T_CPU.VL_GRID_ROW_DIMENSION,
	T_CPU.VL_GRID_COLUMN_DIMENSION,
	T_CPU.VL_BLOCK_ROW_DIMENSION,
	T_CPU.VL_BLOCK_COLUMN_DIMENSION,
	T_CPU.VL_BLOCK_MEMORY_SIZE,
	ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0)::varchar(255) as VL_BLOCK_MEMORY_SIZE_MB,
	ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
	CASE
		WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
			THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
		WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
			THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
		ELSE
			'999999999999'
	END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
	CASE
		WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
			THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION || ' ; ' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
		WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
			THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION || ' ; ' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
		ELSE
			'999999999999'
	END AS VL_CONCAT_BLOCK_SIZE_MB_GRID_DIMENSION_NR_TASKS,
	CASE
		WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
			THEN
				CASE
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				END
		WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
			THEN
				CASE
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				END
		ELSE
			'999999999999'
	END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
	T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC_CPU,
	T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC_GPU,
	T_CPU.VL_ADDITIONAL_TIME AS VL_ADDITIONAL_TIME_CPU,
	T_GPU.VL_ADDITIONAL_TIME AS VL_ADDITIONAL_TIME_GPU,
	T_CPU.VL_COMMUNICATION_TIME AS VL_COMMUNICATION_TIME_CPU,
	T_GPU.VL_COMMUNICATION_TIME AS VL_COMMUNICATION_TIME_GPU,
	CASE
	WHEN ROUND((T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2) > 1.00 THEN ROUND((T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2)
	ELSE -ROUND((T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2)
	END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	CASE
	WHEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME)
	ELSE -(T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME)
	END AS SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME
	FROM T_CPU LEFT JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER
									AND T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
									AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
									AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
									AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION)
WHERE
-- START FILTERS FOR FIGURE 9 PART 1 (10 CLUSTERS)
	T_CPU.ds_algorithm='KMEANS'
	AND T_CPU.nr_iterations = 5
	AND T_CPU.ds_dataset = 'S_10GB_1'
	AND T_CPU.ds_parameter_type = 'VAR_GRID_ROW_5'
	AND T_CPU.id_resource = 18
-- END FILTERS FOR FIGURE 9 PART 1 (10 CLUSTERS)
-- START FILTERS FOR FIGURE 9 PART 2 (100 CLUSTERS)
	--T_CPU.ds_algorithm='KMEANS'
	--AND T_CPU.nr_iterations = 5
	--AND T_CPU.ds_dataset = 'S_10GB_1'
	--AND T_CPU.ds_parameter_type = 'VAR_GRID_ROW_6'
	--AND T_CPU.id_resource = 18
-- END FILTERS FOR FIGURE 9 PART 2 (100 CLUSTERS)
-- START FILTERS FOR FIGURE 9 PART 3 (1000 CLUSTERS)
	--T_CPU.ds_algorithm='KMEANS'
	--AND T_CPU.nr_iterations = 5
	--AND T_CPU.ds_dataset = 'S_10GB_1'
	--AND T_CPU.ds_parameter_type = 'VAR_GRID_ROW_7'
	--AND T_CPU.id_resource = 18
-- END FILTERS FOR FIGURE 9 PART 3 (1000 CLUSTERS)
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET;



-- #### FIGURE 9(b). The effects of CPU-GPU communication and serial fraction processing on K-means for different data skewness (MODE == 100) ####
WITH T_CPU AS (
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
	Y.VL_COMMUNICATION_TIME,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.DS_STORAGE,
	Y.NR_CLUSTER,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE,
	Y.DEVICE_SKEWNESS
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.DS_STORAGE,
		X.NR_CLUSTER,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE,
		X.DEVICE_SKEWNESS
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				(SELECT X.DS_STORAGE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_STORAGE,
				(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS NR_CLUSTER,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE,
				CASE
					WHEN (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU' AND D.VL_DATA_SKEWNESS = 0 THEN 'CPU NOT SKEWED'
					WHEN (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU' AND D.VL_DATA_SKEWNESS = 0.5 THEN 'CPU SKEWED'
					WHEN (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU' AND D.VL_DATA_SKEWNESS = 0 THEN 'GPU NOT SKEWED'
					WHEN (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU' AND D.VL_DATA_SKEWNESS = 0.5 THEN 'GPU SKEWED'
				ELSE ''
				END AS DEVICE_SKEWNESS
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		) X
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.DS_STORAGE,
		X.NR_CLUSTER,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE,
		X.DEVICE_SKEWNESS
	) Y

),
	T_GPU AS (
					SELECT
					Y.VL_TOTAL_EXECUTION_TIME,
					Y.VL_INTER_TASK_EXECUTION_TIME,
					Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
					Y.VL_COMMUNICATION_TIME,
					Y.ID_PARAMETER,
					Y.CD_PARAMETER,
					Y.CD_CONFIGURATION,
					Y.ID_ALGORITHM,
					Y.DS_ALGORITHM,
					Y.ID_FUNCTION,
					Y.DS_FUNCTION,
					Y.ID_DEVICE,
					Y.DS_DEVICE,
					Y.ID_DATASET,
					Y.ID_RESOURCE,
					Y.ID_PARAMETER_TYPE,
					Y.DS_PARAMETER_TYPE,
					Y.DS_PARAMETER_ATTRIBUTE,
					Y.DS_STORAGE,
					Y.NR_CLUSTER,
					Y.NR_ITERATIONS,
					Y.VL_GRID_ROW_DIMENSION,
					Y.VL_GRID_COLUMN_DIMENSION,
					Y.VL_BLOCK_ROW_DIMENSION,
					Y.VL_BLOCK_COLUMN_DIMENSION,
					Y.VL_BLOCK_MEMORY_SIZE,
					Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					Y.DS_RESOURCE,
					Y.NR_NODES,
					Y.NR_COMPUTING_UNITS_CPU,
					Y.NR_COMPUTING_UNITS_GPU,
					Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					Y.DS_DATASET,
					Y.VL_DATASET_MEMORY_SIZE,
					Y.DS_DATA_TYPE,
					Y.VL_DATA_TYPE_MEMORY_SIZE,
					Y.VL_DATASET_DIMENSION,
					Y.VL_DATASET_ROW_DIMENSION,
					Y.VL_DATASET_COLUMN_DIMENSION,
					Y.NR_RANDOM_STATE,
					Y.DEVICE_SKEWNESS
					FROM
					(
						SELECT
						AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
						AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
						AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
						AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
						AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
						AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
						AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
						AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
						AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
						AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
						X.ID_PARAMETER,
						X.CD_PARAMETER,
						X.CD_CONFIGURATION,
						X.ID_ALGORITHM,
						X.DS_ALGORITHM,
						X.ID_FUNCTION,
						X.DS_FUNCTION,
						X.ID_DEVICE,
						X.DS_DEVICE,
						X.ID_DATASET,
						X.ID_RESOURCE,
						X.ID_PARAMETER_TYPE,
						X.DS_PARAMETER_TYPE,
						X.DS_PARAMETER_ATTRIBUTE,
						X.DS_STORAGE,
						X.NR_CLUSTER,
						X.NR_ITERATIONS,
						X.VL_GRID_ROW_DIMENSION,
						X.VL_GRID_COLUMN_DIMENSION,
						X.VL_GRID_ROW_X_COLUMN_DIMENSION,
						X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
						X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
						X.VL_BLOCK_ROW_DIMENSION,
						X.VL_BLOCK_COLUMN_DIMENSION,
						X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
						X.VL_BLOCK_MEMORY_SIZE,
						X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
						X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
						X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
						X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
						X.DS_RESOURCE,
						X.NR_NODES,
						X.NR_COMPUTING_UNITS_CPU,
						X.NR_COMPUTING_UNITS_GPU,
						X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
						X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
						X.DS_DATASET,
						X.VL_DATASET_MEMORY_SIZE,
						X.DS_DATA_TYPE,
						X.VL_DATA_TYPE_MEMORY_SIZE,
						X.VL_DATASET_DIMENSION,
						X.VL_DATASET_ROW_DIMENSION,
						X.VL_DATASET_COLUMN_DIMENSION,
						X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
						X.NR_RANDOM_STATE,
						X.DEVICE_SKEWNESS
						FROM
						(
							SELECT
								A.ID_EXPERIMENT,
								A.VL_TOTAL_EXECUTION_TIME,
								A.VL_INTER_TASK_EXECUTION_TIME,
								A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
								A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
								A.VL_COMMUNICATION_TIME_1,
								A.VL_COMMUNICATION_TIME_2,
								A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
								A.VL_ADDITIONAL_TIME_1,
								A.VL_ADDITIONAL_TIME_2,
								A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
								A.DT_PROCESSING,
								B.ID_PARAMETER,
								B.CD_PARAMETER,
								B.CD_CONFIGURATION,
								B.ID_ALGORITHM,
								(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
								B.ID_FUNCTION,
								(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
								(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
								(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
								B.ID_DATASET,
								B.ID_RESOURCE,
								B.ID_PARAMETER_TYPE,
								(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
								(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
								(SELECT X.DS_STORAGE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_STORAGE,
								(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS NR_CLUSTER,
								B.NR_ITERATIONS,
								B.VL_GRID_ROW_DIMENSION,
								B.VL_GRID_COLUMN_DIMENSION,
								B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
								ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
								B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
								B.VL_BLOCK_ROW_DIMENSION,
								B.VL_BLOCK_COLUMN_DIMENSION,
								B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
								B.VL_BLOCK_MEMORY_SIZE,
								B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
								B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
								ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
								ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
								C.DS_RESOURCE,
								C.NR_NODES,
								C.NR_COMPUTING_UNITS_CPU,
								C.NR_COMPUTING_UNITS_GPU,
								C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
								C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
								D.DS_DATASET,
								D.VL_DATASET_MEMORY_SIZE,
								D.DS_DATA_TYPE,
								D.VL_DATA_TYPE_MEMORY_SIZE,
								D.VL_DATASET_DIMENSION,
								D.VL_DATASET_ROW_DIMENSION,
								D.VL_DATASET_COLUMN_DIMENSION,
								D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
								D.NR_RANDOM_STATE,
								CASE
									WHEN (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU' AND D.VL_DATA_SKEWNESS = 0 THEN 'CPU NOT SKEWED'
									WHEN (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU' AND D.VL_DATA_SKEWNESS = 0.5 THEN 'CPU SKEWED'
									WHEN (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU' AND D.VL_DATA_SKEWNESS = 0 THEN 'GPU NOT SKEWED'
									WHEN (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU' AND D.VL_DATA_SKEWNESS = 0.5 THEN 'GPU SKEWED'
								ELSE ''
								END AS DEVICE_SKEWNESS
							FROM EXPERIMENT_RAW A
							INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
							INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
							INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
							WHERE
							(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
							AND A.ID_EXPERIMENT NOT IN (784797,784799,784798) -- GRID ROW DIM 2 SKEWED ('S_1GB_1')
							AND A.ID_EXPERIMENT NOT IN (779557,779558,779559) -- GRID ROW DIM 2 NOT SKEWED ('S_1GB_3')
							AND A.ID_EXPERIMENT NOT IN (784838,784839,784836,784845,784837,784847,784844) -- GRID ROW DIM 4 SKEWED ('S_1GB_1')
							AND A.ID_EXPERIMENT NOT IN (779598,779599,779609,779614,779610,779597,779604) -- GRID ROW DIM 4 NOT SKEWED ('S_1GB_3')
							AND A.ID_EXPERIMENT NOT IN (784911,784913,784912,784910,784909,784908,784944,784929,784928,784938) -- GRID ROW DIM 8 SKEWED ('S_1GB_1')
							AND A.ID_EXPERIMENT NOT IN (779672,779671,779673,779670,779668,779669,779667,779676,779683,779677) -- GRID ROW DIM 8 NOT SKEWED ('S_1GB_3')
							AND A.ID_EXPERIMENT NOT IN (785049,785048,785046,785047,785038,785039,785057,785095,785067,785060) -- GRID ROW DIM 16 SKEWED ('S_1GB_1')
							AND A.ID_EXPERIMENT NOT IN (779805,779807,779806,779810,779811,779808,779809,779800,779799,779798) -- GRID ROW DIM 16 NOT SKEWED ('S_1GB_3')
							AND A.ID_EXPERIMENT NOT IN (785321,785320,785323,785322,785310,785309,785311,785308,785317,785318) -- GRID ROW DIM 32 SKEWED ('S_1GB_1')
							AND A.ID_EXPERIMENT NOT IN (780079,780078,780074,780075,780076,780077,780083,780082,780081,780080) -- GRID ROW DIM 32 NOT SKEWED ('S_1GB_3')
							AND A.ID_EXPERIMENT NOT IN (785827,785832,785825,785826,785828,785834,785824,785823,786016,786080) -- GRID ROW DIM 64 SKEWED ('S_1GB_1')
							AND A.ID_EXPERIMENT NOT IN (780603,780602,780607,780606,780601,780605,780568,780565,780589,780567) -- GRID ROW DIM 64 NOT SKEWED ('S_1GB_3')
							AND A.ID_EXPERIMENT NOT IN (786781,786784,786780,786783,786793,786827,786812,786807,786808,786803) -- GRID ROW DIM 128 SKEWED ('S_1GB_1')
							AND A.ID_EXPERIMENT NOT IN (781551,781549,781548,781544,781545,781541,781546,781540,781562,781542) -- GRID ROW DIM 128 NOT SKEWED ('S_1GB_3')
							AND A.ID_EXPERIMENT NOT IN (788843,788847,788728,788729,788735,788734,788739,788738,788727,788733) -- GRID ROW DIM 256 SKEWED ('S_1GB_1')
						) X
						GROUP BY
						X.ID_PARAMETER,
						X.CD_PARAMETER,
						X.CD_CONFIGURATION,
						X.ID_ALGORITHM,
						X.DS_ALGORITHM,
						X.ID_FUNCTION,
						X.DS_FUNCTION,
						X.ID_DEVICE,
						X.DS_DEVICE,
						X.ID_DATASET,
						X.ID_RESOURCE,
						X.ID_PARAMETER_TYPE,
						X.DS_PARAMETER_TYPE,
						X.DS_PARAMETER_ATTRIBUTE,
						X.DS_STORAGE,
						X.NR_CLUSTER,
						X.NR_ITERATIONS,
						X.VL_GRID_ROW_DIMENSION,
						X.VL_GRID_COLUMN_DIMENSION,
						X.VL_GRID_ROW_X_COLUMN_DIMENSION,
						X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
						X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
						X.VL_BLOCK_ROW_DIMENSION,
						X.VL_BLOCK_COLUMN_DIMENSION,
						X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
						X.VL_BLOCK_MEMORY_SIZE,
						X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
						X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
						X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
						X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
						X.DS_RESOURCE,
						X.NR_NODES,
						X.NR_COMPUTING_UNITS_CPU,
						X.NR_COMPUTING_UNITS_GPU,
						X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
						X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
						X.DS_DATASET,
						X.VL_DATASET_MEMORY_SIZE,
						X.DS_DATA_TYPE,
						X.VL_DATA_TYPE_MEMORY_SIZE,
						X.VL_DATASET_DIMENSION,
						X.VL_DATASET_ROW_DIMENSION,
						X.VL_DATASET_COLUMN_DIMENSION,
						X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
						X.NR_RANDOM_STATE,
						X.DEVICE_SKEWNESS
					) Y
	)
	SELECT
	T_CPU.ID_PARAMETER_TYPE,
	T_CPU.CD_PARAMETER,
	T_CPU.DS_ALGORITHM,
	T_CPU.DS_FUNCTION,
	T_CPU.NR_ITERATIONS,
	T_GPU.DEVICE_SKEWNESS,
	CASE
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3
	ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) END AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	CASE
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
	ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' END AS CONCAT_BLOCK_PERCENT_DATASET_GRID_DIMENSION,
	--ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	T_CPU.DS_RESOURCE,
	T_CPU.DS_PARAMETER_TYPE,
	T_CPU.DS_PARAMETER_ATTRIBUTE,
	T_CPU.DS_STORAGE,
	T_CPU.NR_CLUSTER,
	T_CPU.DS_DATASET,
	CAST(T_CPU.VL_DATASET_MEMORY_SIZE*1e-6 AS BIGINT) as VL_DATASET_MEMORY_SIZE,
	T_CPU.VL_DATASET_DIMENSION,
	T_CPU.VL_DATASET_ROW_DIMENSION,
	T_CPU.VL_DATASET_COLUMN_DIMENSION,
	T_CPU.VL_GRID_ROW_DIMENSION,
	T_CPU.VL_GRID_COLUMN_DIMENSION,
	T_CPU.VL_BLOCK_ROW_DIMENSION,
	T_CPU.VL_BLOCK_COLUMN_DIMENSION,
	T_CPU.VL_BLOCK_MEMORY_SIZE,
	ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0)::varchar(255) as VL_BLOCK_MEMORY_SIZE_MB,
	ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
	CASE
		WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
			THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
		WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
			THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
		ELSE
			'999999999999'
	END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
	CASE
		WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
			THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION || ' ; ' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
		WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
			THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION || ' ; ' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
		ELSE
			'999999999999'
	END AS VL_CONCAT_BLOCK_SIZE_MB_GRID_DIMENSION_NR_TASKS,
	CASE
		WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
			THEN
				CASE
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
					ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				END
		WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
			THEN
				CASE
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
					ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				END
		ELSE
			'999999999999'
	END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
	T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC_CPU,
	T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC_GPU,
	T_CPU.VL_ADDITIONAL_TIME AS VL_ADDITIONAL_TIME_CPU,
	T_GPU.VL_ADDITIONAL_TIME AS VL_ADDITIONAL_TIME_GPU,
	T_CPU.VL_COMMUNICATION_TIME AS VL_COMMUNICATION_TIME_CPU,
	T_GPU.VL_COMMUNICATION_TIME AS VL_COMMUNICATION_TIME_GPU,
	CASE
	WHEN ROUND((T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2) > 1.00 THEN ROUND((T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2)
	ELSE -ROUND((T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2)
	END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	CASE
	WHEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME)
	ELSE -(T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME)
	END AS SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME
	FROM T_CPU LEFT JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER
									AND T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
									AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
									AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
									AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION)
WHERE
-- START FILTERS FOR FIGURE 9(b)
	T_CPU.ds_algorithm='KMEANS'
	AND T_CPU.nr_iterations = 5
	AND T_CPU.ds_dataset in ('S_1GB_1','S_1GB_3')
	AND T_CPU.ds_parameter_type = 'VAR_GRID_ROW_5'
	AND T_CPU.id_resource = 18
-- END FILTERS FOR FIGURE 9(b)
	ORDER BY
	T_CPU.DS_DATASET,
	T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET;










-- #### FIGURE 10(a). The effects of storage architecture and scheduling policy on Matmul (MODE == 15) (MODE == 16 IN REVISION) ####
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME AS VL_PARALLEL_TASK_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_USER_CODE_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME,
	Y.VL_COMMUNICATION_TIME,
	Y.VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME,
	ROUND(((Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)/(Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC-Y.VL_COMMUNICATION_TIME))::numeric,2) AS P_FRACTION,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
	Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
	Y.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
	Y.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
	ROUND(Y.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
	(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE,
	CASE
		WHEN Y.DS_DEVICE = 'CPU' AND Y.VL_DATA_SPARSITY = 0 THEN 'CPU dense'
		WHEN Y.DS_DEVICE = 'CPU' AND Y.VL_DATA_SPARSITY = 1 THEN 'CPU sparse'
		WHEN Y.DS_DEVICE = 'GPU' AND Y.VL_DATA_SPARSITY = 0 THEN 'GPU dense'
		WHEN Y.DS_DEVICE = 'GPU' AND Y.VL_DATA_SPARSITY = 1 THEN 'GPU sparse'
		ELSE ''
	END AS DEVICE_SPARSITY
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		CASE
			WHEN X.DS_FUNCTION = 'MATMUL_FUNC' THEN AVG(X.VL_INTER_TASK_EXECUTION_TIME)
			WHEN X.DS_FUNCTION = 'ADD_FUNC' THEN AVG(X.VL_INTER_TASK_EXECUTION_TIME)*ceil(ln(X.VL_GRID_ROW_DIMENSION)/ln(2))
			ELSE AVG(X.VL_INTER_TASK_EXECUTION_TIME)
		END AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		STDDEV(X.VL_TOTAL_EXECUTION_TIME) AS VL_STD_TOTAL_EXECUTION_TIME,
		STDDEV(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_STD_INTER_TASK_EXECUTION_TIME,
		STDDEV(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		STDDEV(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		STDDEV(X.VL_COMMUNICATION_TIME) AS VL_STD_COMMUNICATION_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
		X.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		ROUND(X.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE,
		X.VL_DATA_SPARSITY
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
				ROUND(D.VL_DATASET_MEMORY_SIZE*1e-6,0) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				CASE
					WHEN (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'KMEANS'
						THEN ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'MATMUL_DISLIB'
						THEN ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION + B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*(B.VL_GRID_ROW_DIMENSION-1)  || ')'
					ELSE
						'999999999999'
				END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE,
				D.VL_DATA_SPARSITY
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			A.NR_ALGORITHM_ITERATION <> 0
		) X
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
		X.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE,
		X.VL_DATA_SPARSITY
	) Y
	WHERE
	-- START FILTERS FOR FIGURE 10(a) PART 1 (LOCAL DISK, TASK GENERATION ORDER)
		Y.ds_algorithm='MATMUL_DISLIB'
		AND Y.nr_iterations = 5
		AND Y.ds_dataset = 'S_8GB_1'
		AND Y.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_6'
		AND Y.id_resource = 1
		AND Y.ds_function = 'MATMUL_FUNC'
	-- END FILTERS FOR FIGURE 10(a) PART 1 (LOCAL DISK, TASK GENERATION ORDER)
	-- START FILTERS FOR FIGURE 10(a) PART 2 (LOCAL DISK, DATA LOCALITY)
		--Y.ds_algorithm='MATMUL_DISLIB'
		--AND Y.nr_iterations = 5
		--AND Y.ds_dataset = 'S_8GB_1'
		--AND Y.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_2'
		--AND Y.id_resource = 1
		--AND Y.ds_function = 'MATMUL_FUNC'
	-- END FILTERS FOR FIGURE 10(a) PART 2 (LOCAL DISK, DATA LOCALITY)
	-- START FILTERS FOR FIGURE 10(a) PART 3 (SHARED DISK, TASK GENERATION ORDER)
		--Y.ds_algorithm='MATMUL_DISLIB'
		--AND Y.nr_iterations = 5
		--AND Y.ds_dataset = 'S_8GB_1'
		--AND Y.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
		--AND Y.id_resource = 1
		--AND Y.ds_function = 'MATMUL_FUNC'
	-- END FILTERS FOR FIGURE 10(a) PART 3 (SHARED DISK, TASK GENERATION ORDER)
	-- START FILTERS FOR FIGURE 10(a) PART 4 (SHARED DISK, DATA LOCALITY)
		--Y.ds_algorithm='MATMUL_DISLIB'
		--AND Y.nr_iterations = 5
		--AND Y.ds_dataset = 'S_8GB_1'
		--AND Y.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_5'
		--AND Y.id_resource = 1
		--AND Y.ds_function = 'MATMUL_FUNC'
	-- END FILTERS FOR FIGURE 10(a) PART 4 (SHARED DISK, DATA LOCALITY)
	ORDER BY ID_PARAMETER;
	

-- #### FIGURE 10(b). The effects of storage architecture and scheduling policy on K-means, 10 clusters (MODE == 15) (MODE == 16 IN REVISION) ####
SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME AS VL_PARALLEL_TASK_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_USER_CODE_TIME,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME,
	Y.VL_COMMUNICATION_TIME,
	Y.VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME,
	ROUND(((Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)/(Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC-Y.VL_COMMUNICATION_TIME))::numeric,2) AS P_FRACTION,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
	Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
	Y.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
	Y.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
	ROUND(Y.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
	(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE,
	CASE
		WHEN Y.DS_DEVICE = 'CPU' AND Y.VL_DATA_SKEWNESS = 0 THEN 'CPU NOT SKEWED'
		WHEN Y.DS_DEVICE = 'CPU' AND Y.VL_DATA_SKEWNESS = 0.5 THEN 'CPU SKEWED'
		WHEN Y.DS_DEVICE = 'GPU' AND Y.VL_DATA_SKEWNESS = 0 THEN 'GPU NOT SKEWED'
		WHEN Y.DS_DEVICE = 'GPU' AND Y.VL_DATA_SKEWNESS = 0.5 THEN 'GPU SKEWED'
		ELSE ''
	END AS DEVICE_SKEWNESS
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		CASE
			WHEN X.DS_FUNCTION = 'MATMUL_FUNC' THEN AVG(X.VL_INTER_TASK_EXECUTION_TIME)
			WHEN X.DS_FUNCTION = 'ADD_FUNC' THEN AVG(X.VL_INTER_TASK_EXECUTION_TIME)*ceil(ln(X.VL_GRID_ROW_DIMENSION)/ln(2))
			ELSE AVG(X.VL_INTER_TASK_EXECUTION_TIME)
		END AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		STDDEV(X.VL_TOTAL_EXECUTION_TIME) AS VL_STD_TOTAL_EXECUTION_TIME,
		STDDEV(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_STD_INTER_TASK_EXECUTION_TIME,
		STDDEV(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		STDDEV(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		STDDEV(X.VL_COMMUNICATION_TIME) AS VL_STD_COMMUNICATION_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
		X.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		ROUND(X.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE,
		X.VL_DATA_SPARSITY,
		X.VL_DATA_SKEWNESS
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
				ROUND(D.VL_DATASET_MEMORY_SIZE*1e-6,0) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				CASE
					WHEN (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'KMEANS'
						THEN ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION*5  || ')'
					WHEN (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'MATMUL_DISLIB'
						THEN ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION + B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*(B.VL_GRID_ROW_DIMENSION-1)  || ')'
					ELSE
						'999999999999'
				END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE,
				D.VL_DATA_SPARSITY,
				D.VL_DATA_SKEWNESS
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			A.NR_ALGORITHM_ITERATION <> 0
		) X
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
		X.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE,
		X.VL_DATA_SPARSITY,
		X.VL_DATA_SKEWNESS
	) Y
	WHERE
	-- START FILTERS FOR FIGURE 10(b) PART 1 (LOCAL DISK, TASK GENERATION ORDER)
		Y.ds_algorithm='KMEANS'
		AND Y.nr_iterations = 5
		AND Y.ds_dataset = 'S_10GB_1'
		AND Y.ds_parameter_type = 'VAR_GRID_ROW_11'
		AND Y.id_resource = 18
	-- END FILTERS FOR FIGURE 10(b) PART 1 (LOCAL DISK, TASK GENERATION ORDER)
	-- START FILTERS FOR FIGURE 10(b) PART 2 (LOCAL DISK, DATA LOCALITY)
		--Y.ds_algorithm='KMEANS'
		--AND Y.nr_iterations = 5
		--AND Y.ds_dataset = 'S_10GB_1'
		--AND Y.ds_parameter_type = 'VAR_GRID_ROW_8'
		--AND Y.id_resource = 18
	-- END FILTERS FOR FIGURE 10(b) PART 2 (LOCAL DISK, DATA LOCALITY)
	-- START FILTERS FOR FIGURE 10(b) PART 3 (SHARED DISK, TASK GENERATION ORDER)
		--Y.ds_algorithm='KMEANS'
		--AND Y.nr_iterations = 5
		--AND Y.ds_dataset = 'S_10GB_1'
		--AND Y.ds_parameter_type = 'VAR_GRID_ROW_5'
		--AND Y.id_resource = 18
	-- END FILTERS FOR FIGURE 10(b) PART 3 (SHARED DISK, TASK GENERATION ORDER)
	-- START FILTERS FOR FIGURE 10(b) PART 4 (SHARED DISK, DATA LOCALITY)
		--Y.ds_algorithm='KMEANS'
		--AND Y.nr_iterations = 5
		--AND Y.ds_dataset = 'S_10GB_1'
		--AND Y.ds_parameter_type = 'VAR_GRID_ROW_14'
		--AND Y.id_resource = 18
	-- END FILTERS FOR FIGURE 10(b) PART 4 (SHARED DISK, DATA LOCALITY)
	ORDER BY ID_PARAMETER;



-- #### FIGURE 11. CORRELATION MATRIX OF KEY FEATURES (MODE == 300)####
--MATMUL
SELECT
ZZZ.VL_EXECUTION_TIME AS "Parallel task exec. time",
ZZZ.VL_BLOCK_MEMORY_SIZE as "Block size",
ZZZ.VL_GRID_DIMENSION_SIZE as "Grid dimension",
ZZZ.P_FRACTION as "Parallel fraction",
ZZZ.PARAMETER_X as "Algorithm-specific param.",
ZZZ.TASK_COMPUTATIONAL_COMPLEXITY as "Computational complexity",
ZZZ.DAG_MAX_WIDTH as "DAG maximum width",
ZZZ.DAG_MAX_HEIGHT as "DAG maximum height",
ZZZ.VL_DATASET_MEMORY_SIZE as "Dataset size",
ZZZ.CPU as "CPU",
ZZZ.GPU as "GPU",
ZZZ.SHARED_DISK as "Shared disk storage",
ZZZ.LOCAL_DISK as "Local disk storage",
ZZZ.ORDER_STRICT_SCHEDULER as "Task gen. order scheduling",
ZZZ.DATA_LOCAL_SCHEDULER as "Data locality scheduling"
FROM
(
SELECT
ROUND(CAST(ZZ.VL_TOTAL_EXECUTION_TIME AS NUMERIC),2) AS VL_EXECUTION_TIME,
ZZ.VL_BLOCK_MEMORY_SIZE,
ZZ.VL_GRID_ROW_DIMENSION*ZZ.VL_GRID_COLUMN_DIMENSION AS VL_GRID_DIMENSION_SIZE,
ZZ.P_FRACTION,
ZZ.PARAMETER_X,
ROUND(CAST((ZZ.VL_BLOCK_ROW_DIMENSION*ZZ.VL_BLOCK_ROW_DIMENSION*ZZ.VL_BLOCK_ROW_DIMENSION + ZZ.VL_BLOCK_ROW_DIMENSION)*1E-9 AS NUMERIC),2) TASK_COMPUTATIONAL_COMPLEXITY,
ZZ.VL_GRID_ROW_DIMENSION*ZZ.VL_GRID_ROW_DIMENSION*ZZ.VL_GRID_ROW_DIMENSION AS DAG_MAX_WIDTH,
ROUND(CAST((1+log(2,ZZ.VL_GRID_ROW_DIMENSION)) AS NUMERIC),0) AS DAG_MAX_HEIGHT,
ZZ.VL_DATASET_MEMORY_SIZE,
CASE
	WHEN ZZ.DS_DEVICE = 'CPU' THEN 1
	ELSE 0
END AS CPU,
CASE
	WHEN ZZ.DS_DEVICE = 'GPU' THEN 1
	ELSE 0
END AS GPU,
CASE
	WHEN ZZ.DS_STORAGE = 'GPFS' THEN 1
	ELSE 0
END AS SHARED_DISK,
CASE
	WHEN ZZ.DS_STORAGE = 'LOCAL_DISK' THEN 1
	ELSE 0
END AS LOCAL_DISK,
CASE
	WHEN ZZ.DS_SCHEDULER = 'es.bsc.compss.scheduler.orderstrict.fifo.FifoTS' THEN 1
	ELSE 0
END AS ORDER_STRICT_SCHEDULER,
CASE
	WHEN ZZ.DS_SCHEDULER = 'es.bsc.compss.scheduler.lookahead.successors.fifolocality.FifoLocalityTS' THEN 1
	ELSE 0
END AS DATA_LOCAL_SCHEDULER
FROM
(
	SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_COMMUNICATION_TIME,
	Y.VL_ADDITIONAL_TIME,
	(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	COALESCE(ROUND(((Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)/(Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC-Y.VL_COMMUNICATION_TIME))::numeric,2),1.00) AS P_FRACTION,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.PARAMETER_X,
	Y.DS_STORAGE,
	Y.DS_SCHEDULER,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
	Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
	Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
	(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.PARAMETER_X,
		X.DS_STORAGE,
		X.DS_SCHEDULER,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS PARAMETER_X,
				(SELECT X.DS_STORAGE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_STORAGE,
				(SELECT X.DS_SCHDEULER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_SCHEDULER,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			A.NR_ALGORITHM_ITERATION <> 0
		) X
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.PARAMETER_X,
		X.DS_STORAGE,
		X.DS_SCHEDULER,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y
) ZZ
WHERE ZZ.ds_algorithm='MATMUL_DISLIB'
AND ZZ.nr_iterations = 5
AND ZZ.ds_dataset = 'S_8GB_1'
AND ZZ.id_resource = 1
AND ZZ.ID_PARAMETER_TYPE IN (1,2,5,6)
AND ZZ.VL_TOTAL_EXECUTION_TIME IS NOT NULL
) AS ZZZ


--KMEANS
SELECT
ZZZ.VL_EXECUTION_TIME AS "Parallel task exec. time",
ZZZ.VL_BLOCK_MEMORY_SIZE as "Block size",
ZZZ.VL_GRID_DIMENSION_SIZE as "Grid dimension",
ZZZ.P_FRACTION as "Parallel fraction",
ZZZ.PARAMETER_X as "Algorithm-specific param.",
ZZZ.TASK_COMPUTATIONAL_COMPLEXITY as "Computational complexity",
ZZZ.DAG_MAX_WIDTH as "DAG maximum width",
ZZZ.DAG_MAX_HEIGHT as "DAG maximum height",
ZZZ.VL_DATASET_MEMORY_SIZE as "Dataset size",
ZZZ.CPU as "CPU",
ZZZ.GPU as "GPU",
ZZZ.SHARED_DISK as "Shared disk storage",
ZZZ.LOCAL_DISK as "Local disk storage",
ZZZ.ORDER_STRICT_SCHEDULER as "Task gen order scheduling",
ZZZ.DATA_LOCAL_SCHEDULER as "Data locality scheduling"
FROM
(
SELECT
ROUND(CAST(ZZ.VL_INTER_TASK_EXECUTION_TIME AS NUMERIC),2) AS VL_EXECUTION_TIME,
ZZ.VL_BLOCK_MEMORY_SIZE,
ZZ.VL_GRID_ROW_DIMENSION*ZZ.VL_GRID_COLUMN_DIMENSION AS VL_GRID_DIMENSION_SIZE,
ZZ.P_FRACTION,
ZZ.PARAMETER_X,
ROUND(CAST(ZZ.VL_BLOCK_ROW_DIMENSION*ZZ.VL_BLOCK_COLUMN_DIMENSION*(ZZ.PARAMETER_X*ZZ.PARAMETER_X)*1E-9 AS NUMERIC),2) TASK_COMPUTATIONAL_COMPLEXITY,
ZZ.VL_GRID_ROW_DIMENSION AS DAG_MAX_WIDTH,
5 AS DAG_MAX_HEIGHT,
ZZ.VL_DATASET_MEMORY_SIZE,
CASE
	WHEN ZZ.DS_DEVICE = 'CPU' THEN 1
	ELSE 0
END AS CPU,
CASE
	WHEN ZZ.DS_DEVICE = 'GPU' THEN 1
	ELSE 0
END AS GPU,
CASE
	WHEN ZZ.DS_STORAGE = 'GPFS' THEN 1
	ELSE 0
END AS SHARED_DISK,
CASE
	WHEN ZZ.DS_STORAGE = 'LOCAL_DISK' THEN 1
	ELSE 0
END AS LOCAL_DISK,
CASE
	WHEN ZZ.DS_SCHEDULER = 'es.bsc.compss.scheduler.orderstrict.fifo.FifoTS' THEN 1
	ELSE 0
END AS ORDER_STRICT_SCHEDULER,
CASE
	WHEN ZZ.DS_SCHEDULER = 'es.bsc.compss.scheduler.lookahead.successors.fifolocality.FifoLocalityTS' THEN 1
	ELSE 0
END AS DATA_LOCAL_SCHEDULER
FROM
(
	SELECT
	Y.VL_TOTAL_EXECUTION_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME,
	(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
	Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
	Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	Y.VL_COMMUNICATION_TIME,
	Y.VL_ADDITIONAL_TIME,
	(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	ROUND(((Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)/(Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC-Y.VL_COMMUNICATION_TIME))::numeric,2) AS P_FRACTION,
	Y.ID_PARAMETER,
	Y.CD_PARAMETER,
	Y.CD_CONFIGURATION,
	Y.ID_ALGORITHM,
	Y.DS_ALGORITHM,
	Y.ID_FUNCTION,
	Y.DS_FUNCTION,
	Y.ID_DEVICE,
	Y.DS_DEVICE,
	Y.ID_DATASET,
	Y.ID_RESOURCE,
	Y.ID_PARAMETER_TYPE,
	Y.DS_PARAMETER_TYPE,
	Y.DS_PARAMETER_ATTRIBUTE,
	Y.PARAMETER_X,
	Y.DS_STORAGE,
	Y.DS_SCHEDULER,
	Y.NR_ITERATIONS,
	Y.VL_GRID_ROW_DIMENSION,
	Y.VL_GRID_COLUMN_DIMENSION,
	Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
	Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
	Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	Y.VL_BLOCK_ROW_DIMENSION,
	Y.VL_BLOCK_COLUMN_DIMENSION,
	Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
	Y.VL_BLOCK_MEMORY_SIZE,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	Y.DS_RESOURCE,
	Y.NR_NODES,
	Y.NR_COMPUTING_UNITS_CPU,
	(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
	(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
	Y.NR_COMPUTING_UNITS_GPU,
	Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	Y.DS_DATASET,
	Y.VL_DATASET_MEMORY_SIZE,
	Y.DS_DATA_TYPE,
	Y.VL_DATA_TYPE_MEMORY_SIZE,
	Y.VL_DATASET_DIMENSION,
	Y.VL_DATASET_ROW_DIMENSION,
	Y.VL_DATASET_COLUMN_DIMENSION,
	Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
	Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.PARAMETER_X,
		X.DS_STORAGE,
		X.DS_SCHEDULER,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS PARAMETER_X,
				(SELECT X.DS_STORAGE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_STORAGE,
				(SELECT X.DS_SCHDEULER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_SCHEDULER,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			A.NR_ALGORITHM_ITERATION <> 0
		) X
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.PARAMETER_X,
		X.DS_STORAGE,
		X.DS_SCHEDULER,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y
) ZZ
WHERE ZZ.ds_algorithm='KMEANS'
AND ZZ.nr_iterations = 5
AND ZZ.ds_dataset = 'S_10GB_1'
AND ZZ.id_resource = 18
AND ZZ.ID_PARAMETER_TYPE BETWEEN 17 AND 28
AND ZZ.VL_INTER_TASK_EXECUTION_TIME IS NOT NULL
) AS ZZZ










-- #### FIGURE 12 - ADDITIONAL ALGORITHM - MATMUL FMA ####
WITH T_CPU AS (
	SELECT
        Y.VL_TOTAL_EXECUTION_TIME,
        Y.VL_INTER_TASK_EXECUTION_TIME,
        Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
        Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
        Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
        Y.VL_COMMUNICATION_TIME,
        Y.ID_PARAMETER,
        Y.CD_PARAMETER,
        Y.CD_CONFIGURATION,
        Y.ID_ALGORITHM,
        Y.DS_ALGORITHM,
        Y.ID_FUNCTION,
        Y.DS_FUNCTION,
        Y.ID_DEVICE,
        Y.DS_DEVICE,
        Y.ID_DATASET,
        Y.ID_RESOURCE,
        Y.ID_PARAMETER_TYPE,
        Y.DS_PARAMETER_TYPE,
        Y.DS_PARAMETER_ATTRIBUTE,
        Y.DS_STORAGE,
        Y.NR_ITERATIONS,
        Y.VL_GRID_ROW_DIMENSION,
        Y.VL_GRID_COLUMN_DIMENSION,
        Y.VL_BLOCK_ROW_DIMENSION,
        Y.VL_BLOCK_COLUMN_DIMENSION,
        Y.VL_BLOCK_MEMORY_SIZE,
        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
        Y.DS_RESOURCE,
        Y.NR_NODES,
        Y.NR_COMPUTING_UNITS_CPU,
        Y.NR_COMPUTING_UNITS_GPU,
        Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
        Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
        Y.DS_DATASET,
        Y.VL_DATASET_MEMORY_SIZE,
        Y.DS_DATA_TYPE,
        Y.VL_DATA_TYPE_MEMORY_SIZE,
        Y.VL_DATASET_DIMENSION,
        Y.VL_DATASET_ROW_DIMENSION,
        Y.VL_DATASET_COLUMN_DIMENSION,
        Y.NR_RANDOM_STATE
        FROM
        (
            SELECT
            AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
            AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
            AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
            AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
            AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
            AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
            AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
            AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
            X.ID_PARAMETER,
            X.CD_PARAMETER,
            X.CD_CONFIGURATION,
            X.ID_ALGORITHM,
            X.DS_ALGORITHM,
            X.ID_FUNCTION,
            X.DS_FUNCTION,
            X.ID_DEVICE,
            X.DS_DEVICE,
            X.ID_DATASET,
            X.ID_RESOURCE,
            X.ID_PARAMETER_TYPE,
            X.DS_PARAMETER_TYPE,
            X.DS_PARAMETER_ATTRIBUTE,
            X.DS_STORAGE,
            X.NR_ITERATIONS,
            X.VL_GRID_ROW_DIMENSION,
            X.VL_GRID_COLUMN_DIMENSION,
            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
            X.VL_BLOCK_ROW_DIMENSION,
            X.VL_BLOCK_COLUMN_DIMENSION,
            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
            X.VL_BLOCK_MEMORY_SIZE,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
            X.DS_RESOURCE,
            X.NR_NODES,
            X.NR_COMPUTING_UNITS_CPU,
            X.NR_COMPUTING_UNITS_GPU,
            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
            X.DS_DATASET,
            X.VL_DATASET_MEMORY_SIZE,
            X.DS_DATA_TYPE,
            X.VL_DATA_TYPE_MEMORY_SIZE,
            X.VL_DATASET_DIMENSION,
            X.VL_DATASET_ROW_DIMENSION,
            X.VL_DATASET_COLUMN_DIMENSION,
            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
            X.NR_RANDOM_STATE
            FROM
            (
                SELECT
                    A.ID_EXPERIMENT,
                    A.VL_TOTAL_EXECUTION_TIME,
                    A.VL_INTER_TASK_EXECUTION_TIME,
                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                    A.VL_COMMUNICATION_TIME_1,
                    A.VL_COMMUNICATION_TIME_2,
                    A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                    A.VL_ADDITIONAL_TIME_1,
                    A.VL_ADDITIONAL_TIME_2,
                    A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                    A.DT_PROCESSING,
                    B.ID_PARAMETER,
                    B.CD_PARAMETER,
                    B.CD_CONFIGURATION,
                    B.ID_ALGORITHM,
                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                    B.ID_FUNCTION,
                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                    B.ID_DATASET,
                    B.ID_RESOURCE,
                    B.ID_PARAMETER_TYPE,
                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                    (SELECT X.DS_STORAGE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_STORAGE,
                    B.NR_ITERATIONS,
                    B.VL_GRID_ROW_DIMENSION,
                    B.VL_GRID_COLUMN_DIMENSION,
                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                    ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                    B.VL_BLOCK_ROW_DIMENSION,
                    B.VL_BLOCK_COLUMN_DIMENSION,
                    B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                    B.VL_BLOCK_MEMORY_SIZE,
                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                    ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                    C.DS_RESOURCE,
                    C.NR_NODES,
                    C.NR_COMPUTING_UNITS_CPU,
                    C.NR_COMPUTING_UNITS_GPU,
                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                    D.DS_DATASET,
                    D.VL_DATASET_MEMORY_SIZE,
                    D.DS_DATA_TYPE,
                    D.VL_DATA_TYPE_MEMORY_SIZE,
                    D.VL_DATASET_DIMENSION,
                    D.VL_DATASET_ROW_DIMENSION,
                    D.VL_DATASET_COLUMN_DIMENSION,
                    D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                    D.NR_RANDOM_STATE
                FROM EXPERIMENT_RAW A
                INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                WHERE
                (SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
             ) X
            GROUP BY
            X.ID_PARAMETER,
            X.CD_PARAMETER,
            X.CD_CONFIGURATION,
            X.ID_ALGORITHM,
            X.DS_ALGORITHM,
            X.ID_FUNCTION,
            X.DS_FUNCTION,
            X.ID_DEVICE,
            X.DS_DEVICE,
            X.ID_DATASET,
            X.ID_RESOURCE,
            X.ID_PARAMETER_TYPE,
            X.DS_PARAMETER_TYPE,
            X.DS_PARAMETER_ATTRIBUTE,
            X.DS_STORAGE,
            X.NR_ITERATIONS,
            X.VL_GRID_ROW_DIMENSION,
            X.VL_GRID_COLUMN_DIMENSION,
            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
            X.VL_BLOCK_ROW_DIMENSION,
            X.VL_BLOCK_COLUMN_DIMENSION,
            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
            X.VL_BLOCK_MEMORY_SIZE,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
            X.DS_RESOURCE,
            X.NR_NODES,
            X.NR_COMPUTING_UNITS_CPU,
            X.NR_COMPUTING_UNITS_GPU,
            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
            X.DS_DATASET,
            X.VL_DATASET_MEMORY_SIZE,
            X.DS_DATA_TYPE,
            X.VL_DATA_TYPE_MEMORY_SIZE,
            X.VL_DATASET_DIMENSION,
            X.VL_DATASET_ROW_DIMENSION,
            X.VL_DATASET_COLUMN_DIMENSION,
            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
            X.NR_RANDOM_STATE
	) Y
),
T_GPU AS (
    SELECT
        Y.VL_TOTAL_EXECUTION_TIME,
        Y.VL_INTER_TASK_EXECUTION_TIME,
        Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
        Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
        Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+Y.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
        Y.VL_COMMUNICATION_TIME,
        Y.ID_PARAMETER,
        Y.CD_PARAMETER,
        Y.CD_CONFIGURATION,
        Y.ID_ALGORITHM,
        Y.DS_ALGORITHM,
        Y.ID_FUNCTION,
        Y.DS_FUNCTION,
        Y.ID_DEVICE,
        Y.DS_DEVICE,
        Y.ID_DATASET,
        Y.ID_RESOURCE,
        Y.ID_PARAMETER_TYPE,
        Y.DS_PARAMETER_TYPE,
        Y.DS_PARAMETER_ATTRIBUTE,
        Y.DS_STORAGE,
        Y.NR_ITERATIONS,
        Y.VL_GRID_ROW_DIMENSION,
        Y.VL_GRID_COLUMN_DIMENSION,
        Y.VL_BLOCK_ROW_DIMENSION,
        Y.VL_BLOCK_COLUMN_DIMENSION,
        Y.VL_BLOCK_MEMORY_SIZE,
        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
        Y.DS_RESOURCE,
        Y.NR_NODES,
        Y.NR_COMPUTING_UNITS_CPU,
        Y.NR_COMPUTING_UNITS_GPU,
        Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
        Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
        Y.DS_DATASET,
        Y.VL_DATASET_MEMORY_SIZE,
        Y.DS_DATA_TYPE,
        Y.VL_DATA_TYPE_MEMORY_SIZE,
        Y.VL_DATASET_DIMENSION,
        Y.VL_DATASET_ROW_DIMENSION,
        Y.VL_DATASET_COLUMN_DIMENSION,
        Y.NR_RANDOM_STATE
        FROM
        (
            SELECT
            AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
            AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
            AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
            AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
            AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
            AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
            AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
            AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
            X.ID_PARAMETER,
            X.CD_PARAMETER,
            X.CD_CONFIGURATION,
            X.ID_ALGORITHM,
            X.DS_ALGORITHM,
            X.ID_FUNCTION,
            X.DS_FUNCTION,
            X.ID_DEVICE,
            X.DS_DEVICE,
            X.ID_DATASET,
            X.ID_RESOURCE,
            X.ID_PARAMETER_TYPE,
            X.DS_PARAMETER_TYPE,
            X.DS_PARAMETER_ATTRIBUTE,
            X.DS_STORAGE,
            X.NR_ITERATIONS,
            X.VL_GRID_ROW_DIMENSION,
            X.VL_GRID_COLUMN_DIMENSION,
            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
            X.VL_BLOCK_ROW_DIMENSION,
            X.VL_BLOCK_COLUMN_DIMENSION,
            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
            X.VL_BLOCK_MEMORY_SIZE,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
            X.DS_RESOURCE,
            X.NR_NODES,
            X.NR_COMPUTING_UNITS_CPU,
            X.NR_COMPUTING_UNITS_GPU,
            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
            X.DS_DATASET,
            X.VL_DATASET_MEMORY_SIZE,
            X.DS_DATA_TYPE,
            X.VL_DATA_TYPE_MEMORY_SIZE,
            X.VL_DATASET_DIMENSION,
            X.VL_DATASET_ROW_DIMENSION,
            X.VL_DATASET_COLUMN_DIMENSION,
            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
            X.NR_RANDOM_STATE
            FROM
            (
                SELECT
                    A.ID_EXPERIMENT,
                    A.VL_TOTAL_EXECUTION_TIME,
                    A.VL_INTER_TASK_EXECUTION_TIME,
                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                    A.VL_COMMUNICATION_TIME_1,
                    A.VL_COMMUNICATION_TIME_2,
                    A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                    A.VL_ADDITIONAL_TIME_1,
                    A.VL_ADDITIONAL_TIME_2,
                    A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                    A.DT_PROCESSING,
                    B.ID_PARAMETER,
                    B.CD_PARAMETER,
                    B.CD_CONFIGURATION,
                    B.ID_ALGORITHM,
                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                    B.ID_FUNCTION,
                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                    B.ID_DATASET,
                    B.ID_RESOURCE,
                    B.ID_PARAMETER_TYPE,
                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                    (SELECT X.DS_STORAGE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_STORAGE,
                    B.NR_ITERATIONS,
                    B.VL_GRID_ROW_DIMENSION,
                    B.VL_GRID_COLUMN_DIMENSION,
                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                    ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                    B.VL_BLOCK_ROW_DIMENSION,
                    B.VL_BLOCK_COLUMN_DIMENSION,
                    B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                    B.VL_BLOCK_MEMORY_SIZE,
                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                    ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                    C.DS_RESOURCE,
                    C.NR_NODES,
                    C.NR_COMPUTING_UNITS_CPU,
                    C.NR_COMPUTING_UNITS_GPU,
                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                    D.DS_DATASET,
                    D.VL_DATASET_MEMORY_SIZE,
                    D.DS_DATA_TYPE,
                    D.VL_DATA_TYPE_MEMORY_SIZE,
                    D.VL_DATASET_DIMENSION,
                    D.VL_DATASET_ROW_DIMENSION,
                    D.VL_DATASET_COLUMN_DIMENSION,
                    D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                    D.NR_RANDOM_STATE
                FROM EXPERIMENT_RAW A
                INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                WHERE
                (SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
            ) X
            GROUP BY
            X.ID_PARAMETER,
            X.CD_PARAMETER,
            X.CD_CONFIGURATION,
            X.ID_ALGORITHM,
            X.DS_ALGORITHM,
            X.ID_FUNCTION,
            X.DS_FUNCTION,
            X.ID_DEVICE,
            X.DS_DEVICE,
            X.ID_DATASET,
            X.ID_RESOURCE,
            X.ID_PARAMETER_TYPE,
            X.DS_PARAMETER_TYPE,
            X.DS_PARAMETER_ATTRIBUTE,
            X.DS_STORAGE,
            X.NR_ITERATIONS,
            X.VL_GRID_ROW_DIMENSION,
            X.VL_GRID_COLUMN_DIMENSION,
            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
            X.VL_BLOCK_ROW_DIMENSION,
            X.VL_BLOCK_COLUMN_DIMENSION,
            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
            X.VL_BLOCK_MEMORY_SIZE,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
            X.DS_RESOURCE,
            X.NR_NODES,
            X.NR_COMPUTING_UNITS_CPU,
            X.NR_COMPUTING_UNITS_GPU,
            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
            X.DS_DATASET,
            X.VL_DATASET_MEMORY_SIZE,
            X.DS_DATA_TYPE,
            X.VL_DATA_TYPE_MEMORY_SIZE,
            X.VL_DATASET_DIMENSION,
            X.VL_DATASET_ROW_DIMENSION,
            X.VL_DATASET_COLUMN_DIMENSION,
            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
            X.NR_RANDOM_STATE
        ) Y
)
SELECT
T_CPU.ID_PARAMETER_TYPE,
T_CPU.CD_PARAMETER,
T_CPU.DS_ALGORITHM,
T_CPU.DS_FUNCTION,
T_CPU.NR_ITERATIONS,
CASE
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3
ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) END AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
CASE
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' END AS CONCAT_BLOCK_PERCENT_DATASET_GRID_DIMENSION,
T_CPU.DS_RESOURCE,
T_CPU.DS_PARAMETER_TYPE,
T_CPU.DS_PARAMETER_ATTRIBUTE,
T_CPU.DS_STORAGE,
T_CPU.DS_DATASET,
CAST(T_CPU.VL_DATASET_MEMORY_SIZE*1e-6 AS BIGINT) as VL_DATASET_MEMORY_SIZE,
T_CPU.VL_DATASET_DIMENSION,
T_CPU.VL_DATASET_ROW_DIMENSION,
T_CPU.VL_DATASET_COLUMN_DIMENSION,
T_CPU.VL_GRID_ROW_DIMENSION,
T_CPU.VL_GRID_COLUMN_DIMENSION,
T_CPU.VL_BLOCK_ROW_DIMENSION,
T_CPU.VL_BLOCK_COLUMN_DIMENSION,
T_CPU.VL_BLOCK_MEMORY_SIZE,
ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0)::varchar(255) as VL_BLOCK_MEMORY_SIZE_MB,
ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
	ELSE
		'999999999999'
END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION || ' ; ' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION || ' ; ' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
	ELSE
		'999999999999'
END AS VL_CONCAT_BLOCK_SIZE_MB_GRID_DIMENSION_NR_TASKS,
CASE
	WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
			END
	WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
		THEN
			CASE
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
				ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
			END
	ELSE
		'999999999999'
END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME_CPU,
T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_PARALLEL_FRACTION_TIME_GPU,
T_CPU.VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME_CPU,
T_GPU.VL_ADDITIONAL_TIME AS VL_SERIAL_FRACTION_TIME_GPU,
T_CPU.VL_COMMUNICATION_TIME AS VL_COMMUNICATION_TIME_CPU,
T_GPU.VL_COMMUNICATION_TIME AS VL_COMMUNICATION_TIME_GPU,
CASE
WHEN ROUND((T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2) > 1.00 THEN ROUND((T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2)
ELSE -ROUND((T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)::numeric,2)
END AS SPEEDUP_USER_CODE,
CASE
WHEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME)
ELSE -(T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME)
END AS SPEEDUP_PARALLEL_TASK
FROM T_CPU LEFT JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER
								AND T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
								AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
								AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
								AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION)
WHERE
	T_CPU.ds_algorithm='MATMUL_FMA'
	AND T_CPU.nr_iterations = 5
	AND T_CPU.ds_dataset = 'S_8GB_1'
	AND T_CPU.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
	AND T_CPU.id_resource = 1
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET;