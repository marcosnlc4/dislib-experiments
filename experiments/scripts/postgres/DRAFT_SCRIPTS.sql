CALL INSERT_DATA()
CALL DELETE_TABLES()

CALL CREATE_TABLES()
CALL DROP_TABLES()



SELECT * FROM DEVICE
SELECT * FROM FUNCTION
SELECT * FROM ALGORITHM
SELECT * FROM CONFIGURATION
SELECT * FROM RESOURCE
SELECT * FROM DATASET
SELECT * FROM PARAMETER_TYPE
SELECT * FROM PARAMETER
SELECT * FROM EXPERIMENT
SELECT * FROM EXPERIMENT_RAW


-- Transfering tables between schemas schemas
SELECT * into public.DEVICE FROM schema_dev.DEVICE
SELECT * into public.FUNCTION FROM schema_dev.FUNCTION
SELECT * into public.ALGORITHM FROM schema_dev.ALGORITHM
SELECT * into public.CONFIGURATION FROM schema_dev.CONFIGURATION
SELECT * into public.RESOURCE FROM schema_dev.RESOURCE
SELECT * into public.DATASET FROM schema_dev.DATASET
SELECT * into public.PARAMETER_TYPE FROM schema_dev.PARAMETER_TYPE
SELECT * into public.PARAMETER FROM schema_dev.PARAMETER
SELECT * into public.EXPERIMENT FROM schema_dev.EXPERIMENT


-- INSERTING NULL VALUES FOR PARAMETERS WHERE EXPERIMENTS HAD PROHIBITIVE EXECUTION TIMES (EXCEEDED THE WALL CLOCK)
--INSERT INTO EXPERIMENT(ID_PARAMETER, VL_TOTAL_EXECUTION_TIME, VL_INTER_TASK_EXECUTION_TIME, VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC, VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC, VL_COMMUNICATION_TIME, DT_PROCESSING)
--VALUES 
--(129,NULL,NULL,NULL,NULL,NULL,now() AT TIME ZONE current_setting('timezone')),
--(130,NULL,NULL,NULL,NULL,NULL,now() AT TIME ZONE current_setting('timezone'))
--ON CONFLICT (ID_PARAMETER,VL_TOTAL_EXECUTION_TIME,VL_INTER_TASK_EXECUTION_TIME,VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,VL_COMMUNICATION_TIME,DT_PROCESSING) DO NOTHING


--PARAMETER QUERY V4


--PARAMETER QUERY V4
SELECT
	A.ID_PARAMETER,
	A.CD_PARAMETER,
	A.CD_CONFIGURATION,
	A.ID_ALGORITHM,
	(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) AS DS_ALGORITHM,
	A.ID_FUNCTION,
	(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_FUNCTION,
	(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS ID_DEVICE,
	(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_DEVICE,
	A.ID_DATASET,
	A.ID_RESOURCE,
	A.ID_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
	(SELECT X.DS_COMPSS_VERSION FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_COMPSS_VERSION,
	(SELECT X.DS_DISLIB_VERSION FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_DISLIB_VERSION,
	(SELECT X.DS_SCHDEULER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_SCHDEULER,
	(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS NR_CLUSTER,
	A.NR_ITERATIONS,
	A.VL_GRID_ROW_DIMENSION,
	A.VL_GRID_COLUMN_DIMENSION,
	A.VL_BLOCK_ROW_DIMENSION,
	A.VL_BLOCK_COLUMN_DIMENSION,
	A.VL_BLOCK_MEMORY_SIZE,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	B.DS_RESOURCE,
	B.NR_NODES,
	B.NR_COMPUTING_UNITS_CPU,
	B.NR_COMPUTING_UNITS_GPU,
	B.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	B.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	C.DS_DATASET,
	C.VL_DATASET_MEMORY_SIZE,
	C.DS_DATA_TYPE,
	C.VL_DATA_TYPE_MEMORY_SIZE,
	C.VL_DATASET_DIMENSION,
	C.VL_DATASET_ROW_DIMENSION,
	C.VL_DATASET_COLUMN_DIMENSION,
	C.NR_RANDOM_STATE
FROM PARAMETER A
INNER JOIN RESOURCE B ON (A.ID_RESOURCE = B.ID_RESOURCE)
INNER JOIN DATASET C ON (A.ID_DATASET = C.ID_DATASET)
WHERE
--(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) = 'KMEANS' -- FIXED VALUE
--AND A.NR_ITERATIONS = 5 -- FIXED VALUE
--AND C.DS_DATASET = 'S_10GB_1'
--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'VAR_GRID_ROW_6'
--AND B.DS_RESOURCE = 'MINOTAURO_9_NODES_1_CORE'
(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) = 'MATMUL_DISLIB' -- FIXED VALUE
AND A.NR_ITERATIONS = 5 -- FIXED VALUE
AND C.DS_DATASET = 'S_8GB_1'
AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'VAR_GRID_SHAPE_MATMUL_6'
AND B.DS_RESOURCE = 'MINOTAURO_9_NODES_1_CORE'
ORDER BY A.ID_PARAMETER






-- PARAMETER QUERY V3
SELECT
	A.ID_PARAMETER,
	A.CD_PARAMETER,
	A.CD_CONFIGURATION,
	A.ID_ALGORITHM,
	(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) AS DS_ALGORITHM,
	A.ID_FUNCTION,
	(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_FUNCTION,
	(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS ID_DEVICE,
	(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_DEVICE,
	A.ID_DATASET,
	A.ID_RESOURCE,
	A.ID_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
	(SELECT X.DS_COMPSS_VERSION FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_COMPSS_VERSION,
	(SELECT X.DS_DISLIB_VERSION FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_DISLIB_VERSION,
	(SELECT X.DS_SCHDEULER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_SCHDEULER,
	(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS NR_CLUSTER,
	A.NR_ITERATIONS,
	A.VL_GRID_ROW_DIMENSION,
	A.VL_GRID_COLUMN_DIMENSION,
	A.VL_BLOCK_ROW_DIMENSION,
	A.VL_BLOCK_COLUMN_DIMENSION,
	A.VL_BLOCK_MEMORY_SIZE,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	B.DS_RESOURCE,
	B.NR_NODES,
	B.NR_COMPUTING_UNITS_CPU,
	B.NR_COMPUTING_UNITS_GPU,
	B.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	B.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	C.DS_DATASET,
	C.VL_DATASET_MEMORY_SIZE,
	C.DS_DATA_TYPE,
	C.VL_DATA_TYPE_MEMORY_SIZE,
	C.VL_DATASET_DIMENSION,
	C.VL_DATASET_ROW_DIMENSION,
	C.VL_DATASET_COLUMN_DIMENSION,
	C.NR_RANDOM_STATE
FROM PARAMETER A
INNER JOIN RESOURCE B ON (A.ID_RESOURCE = B.ID_RESOURCE)
INNER JOIN DATASET C ON (A.ID_DATASET = C.ID_DATASET)
WHERE
(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) = 'KMEANS' -- FIXED VALUE
AND A.NR_ITERATIONS = 5 -- FIXED VALUE
AND C.DS_DATASET = 'S_100GB_1'
AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'VAR_CORES_CLUSTER_1'
AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_16_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_3_NODES_16_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_4_NODES_16_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_5_NODES_16_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_6_NODES_16_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_7_NODES_16_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_8_NODES_16_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_9_NODES_16_CORES'
--#####
--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'VAR_CORES_SINGLE_NODE_1'
--AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_2_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_4_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_6_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_8_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_10_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_12_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_14_CORES'
--AND B.DS_RESOURCE = 'MINOTAURO_2_NODES_16_CORES'
ORDER BY A.ID_PARAMETER



-- PARAMETER QUERY V2
SELECT
	A.ID_PARAMETER,
	A.CD_PARAMETER,
	A.CD_CONFIGURATION,
	A.ID_ALGORITHM,
	(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) AS DS_ALGORITHM,
	A.ID_FUNCTION,
	(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_FUNCTION,
	(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS ID_DEVICE,
	(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_DEVICE,
	A.ID_DATASET,
	A.ID_RESOURCE,
	A.ID_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
	A.NR_ITERATIONS,
	A.VL_GRID_ROW_DIMENSION,
	A.VL_GRID_COLUMN_DIMENSION,
	A.VL_BLOCK_ROW_DIMENSION,
	A.VL_BLOCK_COLUMN_DIMENSION,
	A.VL_BLOCK_MEMORY_SIZE,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	B.DS_RESOURCE,
	B.NR_NODES,
	B.NR_COMPUTING_UNITS_CPU,
	B.NR_COMPUTING_UNITS_GPU,
	B.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	B.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	C.DS_DATASET,
	C.VL_DATASET_MEMORY_SIZE,
	C.DS_DATA_TYPE,
	C.VL_DATA_TYPE_MEMORY_SIZE,
	C.VL_DATASET_DIMENSION,
	C.VL_DATASET_ROW_DIMENSION,
	C.VL_DATASET_COLUMN_DIMENSION,
	C.NR_RANDOM_STATE
FROM PARAMETER A
INNER JOIN RESOURCE B ON (A.ID_RESOURCE = B.ID_RESOURCE)
INNER JOIN DATASET C ON (A.ID_DATASET = C.ID_DATASET)
WHERE
(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) = 'KMEANS' -- FIXED VALUE
AND A.NR_ITERATIONS = 5 -- FIXED VALUE
--AND C.DS_DATASET IN ('S_10MB_1','S_100MB_1','S_1GB_1','S_10GB_1')
AND C.DS_DATASET = 'S_100GB_1'
AND B.DS_RESOURCE = 'MINOTAURO_9_NODES_16_CORES'
AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'VAR_GRID_ROW'
--AND A.ID_PARAMETER NOT IN (11832,11830,11828,11827,11826,11825)
ORDER BY A.ID_PARAMETER



-- PARAMETER QUERY
SELECT
	A.ID_PARAMETER,
	A.CD_PARAMETER,
	A.CD_CONFIGURATION,
	A.ID_ALGORITHM,
	(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) AS DS_ALGORITHM,
	A.ID_FUNCTION,
	(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_FUNCTION,
	(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS ID_DEVICE,
	(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_DEVICE,
	A.ID_DATASET,
	A.ID_RESOURCE,
	A.ID_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
	A.NR_ITERATIONS,
	A.VL_GRID_ROW_DIMENSION,
	A.VL_GRID_COLUMN_DIMENSION,
	A.VL_BLOCK_ROW_DIMENSION,
	A.VL_BLOCK_COLUMN_DIMENSION,
	A.VL_BLOCK_MEMORY_SIZE,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	B.DS_RESOURCE,
	B.NR_NODES,
	B.NR_COMPUTING_UNITS_CPU,
	B.NR_COMPUTING_UNITS_GPU,
	B.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	B.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	C.DS_DATASET,
	C.VL_DATASET_MEMORY_SIZE,
	C.DS_DATA_TYPE,
	C.VL_DATA_TYPE_MEMORY_SIZE,
	C.VL_DATASET_DIMENSION,
	C.VL_DATASET_ROW_DIMENSION,
	C.VL_DATASET_COLUMN_DIMENSION,
	C.NR_RANDOM_STATE
FROM PARAMETER A
INNER JOIN RESOURCE B ON (A.ID_RESOURCE = B.ID_RESOURCE)
INNER JOIN DATASET C ON (A.ID_DATASET = C.ID_DATASET)
WHERE
(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) = 'KMEANS' -- FIXED VALUE
AND A.NR_ITERATIONS = 5 -- FIXED VALUE
AND B.DS_RESOURCE = 'MINOTAURO_2' -- FIXED VALUE
--AND C.DS_DATASET IN ('S_A_1','S_A_2','S_A_3','S_A_4','S_B_1','S_B_2','S_B_3','S_B_4','S_C_1','S_C_2','S_C_3','S_C_4') -- FIXED VALUE
AND C.DS_DATASET IN ('S_AA_1','S_AA_2','S_AA_3','S_AA_4','S_BB_1','S_BB_2','S_BB_3','S_BB_4','S_CC_1','S_CC_2','S_CC_3','S_CC_4') -- FIXED VALUE
AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'VAR_BLOCK_CAPACITY_SIZE' -- 1.1, 1.2, 1.3, 1.4
--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'VAR_PARALLELISM_LEVEL' -- 2.1, 2.2
--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = '0.25' -- 1.1
--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = '0.50' -- 1.2
--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = '0.75' -- 1.3
--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = '1.00' -- 1.4
--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'MIN_INTER_MAX_INTRA'--2.1
--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'MAX_INTER_MIN_INTRA'--2.2
--AND C.VL_DATASET_MEMORY_SIZE = 400 -- 2.2.1
--AND C.VL_DATASET_MEMORY_SIZE = 400000 -- 2.2.2
--AND C.VL_DATASET_MEMORY_SIZE = 400000000 -- 2.2.3
--AND C.VL_DATASET_MEMORY_SIZE = 640 -- 2.2.1
--AND C.VL_DATASET_MEMORY_SIZE = 640000 -- 2.2.2
AND C.VL_DATASET_MEMORY_SIZE <> 640000000 -- 2.2.3
ORDER BY A.ID_PARAMETER


-- MAIN EXPERIMENT QUERY
SELECT
*
FROM
(
SELECT
                            A.VL_TOTAL_EXECUTION_TIME,
                            A.VL_INTER_TASK_EXECUTION_TIME,
                            (A.VL_INTER_TASK_EXECUTION_TIME - A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
                            A.VL_INTER_TASK_EXECUTION_TIME - (A.VL_INTER_TASK_EXECUTION_TIME - A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
                            A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                            A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                            A.VL_COMMUNICATION_TIME,
                            A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+A.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
                            (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                            B.ID_PARAMETER,
                            B.CD_PARAMETER,
                            B.CD_CONFIGURATION,
                            B.ID_ALGORITHM,
                            (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                            B.ID_FUNCTION,
                            (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                            (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                            (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                            B.ID_DATASET,
                            B.ID_RESOURCE,
                            B.ID_PARAMETER_TYPE,
                            (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                            (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                            B.NR_ITERATIONS,
                            B.VL_GRID_ROW_DIMENSION,
                            B.VL_GRID_COLUMN_DIMENSION,
                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            B.VL_BLOCK_ROW_DIMENSION,
                            B.VL_BLOCK_COLUMN_DIMENSION,
                            B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                            B.VL_BLOCK_MEMORY_SIZE,
                            B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            C.DS_RESOURCE,
                            C.NR_NODES,
                            C.NR_COMPUTING_UNITS_CPU,
                            (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
                            (C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
                            C.NR_COMPUTING_UNITS_GPU,
                            C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            D.DS_DATASET,
                            D.VL_DATASET_MEMORY_SIZE,
                            D.DS_DATA_TYPE,
                            D.VL_DATA_TYPE_MEMORY_SIZE,
                            D.VL_DATASET_DIMENSION,
                            D.VL_DATASET_ROW_DIMENSION,
                            D.VL_DATASET_COLUMN_DIMENSION,
                            D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            D.NR_RANDOM_STATE
                        FROM EXPERIMENT A
                        INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                        INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                        INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                        WHERE
                        A.VL_TOTAL_EXECUTION_TIME is not null
                        --(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) <> 'MAX_INTER_MIN_INTRA'

                        UNION ALL


                        -- EXPERIMENT RAW QUERY
                        SELECT
                        Y.VL_TOTAL_EXECUTION_TIME,
                        Y.VL_INTER_TASK_EXECUTION_TIME,
                        (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
                        Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
                        Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                        Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                        Y.VL_COMMUNICATION_TIME,
                        Y.VL_ADDITIONAL_TIME,
                        (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                        Y.ID_PARAMETER,
                        Y.CD_PARAMETER,
                        Y.CD_CONFIGURATION,
                        Y.ID_ALGORITHM,
                        Y.DS_ALGORITHM,
                        Y.ID_FUNCTION,
                        Y.DS_FUNCTION,
                        Y.ID_DEVICE,
                        Y.DS_DEVICE,
                        Y.ID_DATASET,
                        Y.ID_RESOURCE,
                        Y.ID_PARAMETER_TYPE,
                        Y.DS_PARAMETER_TYPE,
                        Y.DS_PARAMETER_ATTRIBUTE,
                        Y.NR_ITERATIONS,
                        Y.VL_GRID_ROW_DIMENSION,
                        Y.VL_GRID_COLUMN_DIMENSION,
                        Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
						Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                        Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                        Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                        Y.VL_BLOCK_ROW_DIMENSION,
                        Y.VL_BLOCK_COLUMN_DIMENSION,
                        Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                        Y.VL_BLOCK_MEMORY_SIZE,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                        Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                        Y.DS_RESOURCE,
                        Y.NR_NODES,
                        Y.NR_COMPUTING_UNITS_CPU,
                        (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
                        (Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
                        Y.NR_COMPUTING_UNITS_GPU,
                        Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                        Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                        Y.DS_DATASET,
                        Y.VL_DATASET_MEMORY_SIZE,
                        Y.DS_DATA_TYPE,
                        Y.VL_DATA_TYPE_MEMORY_SIZE,
                        Y.VL_DATASET_DIMENSION,
                        Y.VL_DATASET_ROW_DIMENSION,
                        Y.VL_DATASET_COLUMN_DIMENSION,
                        Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                        Y.NR_RANDOM_STATE
                        FROM
                        (
                            SELECT
                            AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                            AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
                            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                            AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                            AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                            AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                            AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                            AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                            AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                            X.ID_PARAMETER,
                            X.CD_PARAMETER,
                            X.CD_CONFIGURATION,
                            X.ID_ALGORITHM,
                            X.DS_ALGORITHM,
                            X.ID_FUNCTION,
                            X.DS_FUNCTION,
                            X.ID_DEVICE,
                            X.DS_DEVICE,
                            X.ID_DATASET,
                            X.ID_RESOURCE,
                            X.ID_PARAMETER_TYPE,
                            X.DS_PARAMETER_TYPE,
                            X.DS_PARAMETER_ATTRIBUTE,
                            X.NR_ITERATIONS,
                            X.VL_GRID_ROW_DIMENSION,
                            X.VL_GRID_COLUMN_DIMENSION,
                            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
							X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_BLOCK_ROW_DIMENSION,
                            X.VL_BLOCK_COLUMN_DIMENSION,
                            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                            X.VL_BLOCK_MEMORY_SIZE,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.DS_RESOURCE,
                            X.NR_NODES,
                            X.NR_COMPUTING_UNITS_CPU,
                            X.NR_COMPUTING_UNITS_GPU,
                            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            X.DS_DATASET,
                            X.VL_DATASET_MEMORY_SIZE,
                            X.DS_DATA_TYPE,
                            X.VL_DATA_TYPE_MEMORY_SIZE,
                            X.VL_DATASET_DIMENSION,
                            X.VL_DATASET_ROW_DIMENSION,
                            X.VL_DATASET_COLUMN_DIMENSION,
                            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            X.NR_RANDOM_STATE
                            FROM
                            (
                                SELECT
                                    A.ID_EXPERIMENT,
                                    A.VL_TOTAL_EXECUTION_TIME,
                                    A.VL_INTER_TASK_EXECUTION_TIME,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    A.VL_COMMUNICATION_TIME_1,
                                    A.VL_COMMUNICATION_TIME_2,
                                    A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                    A.VL_ADDITIONAL_TIME_1,
                                    A.VL_ADDITIONAL_TIME_2,
                                    A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                    (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    A.DT_PROCESSING,
                                    B.ID_PARAMETER,
                                    B.CD_PARAMETER,
                                    B.CD_CONFIGURATION,
                                    B.ID_ALGORITHM,
                                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                    B.ID_FUNCTION,
                                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                    B.ID_DATASET,
                                    B.ID_RESOURCE,
                                    B.ID_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                    B.NR_ITERATIONS,
                                    B.VL_GRID_ROW_DIMENSION,
                                    B.VL_GRID_COLUMN_DIMENSION,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
									ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    B.VL_BLOCK_ROW_DIMENSION,
                                    B.VL_BLOCK_COLUMN_DIMENSION,
                                    B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                    B.VL_BLOCK_MEMORY_SIZE,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    C.DS_RESOURCE,
                                    C.NR_NODES,
                                    C.NR_COMPUTING_UNITS_CPU,
                                    C.NR_COMPUTING_UNITS_GPU,
                                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    D.DS_DATASET,
                                    D.VL_DATASET_MEMORY_SIZE,
                                    D.DS_DATA_TYPE,
                                    D.VL_DATA_TYPE_MEMORY_SIZE,
                                    D.VL_DATASET_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION,
                                    D.VL_DATASET_COLUMN_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                    D.NR_RANDOM_STATE
                                FROM EXPERIMENT_RAW A
                                INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                WHERE
                                A.NR_ALGORITHM_ITERATION <> 0
                            ) X
                            GROUP BY
                            X.ID_PARAMETER,
                            X.CD_PARAMETER,
                            X.CD_CONFIGURATION,
                            X.ID_ALGORITHM,
                            X.DS_ALGORITHM,
                            X.ID_FUNCTION,
                            X.DS_FUNCTION,
                            X.ID_DEVICE,
                            X.DS_DEVICE,
                            X.ID_DATASET,
                            X.ID_RESOURCE,
                            X.ID_PARAMETER_TYPE,
                            X.DS_PARAMETER_TYPE,
                            X.DS_PARAMETER_ATTRIBUTE,
                            X.NR_ITERATIONS,
                            X.VL_GRID_ROW_DIMENSION,
                            X.VL_GRID_COLUMN_DIMENSION,
                            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
							X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_BLOCK_ROW_DIMENSION,
                            X.VL_BLOCK_COLUMN_DIMENSION,
                            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                            X.VL_BLOCK_MEMORY_SIZE,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.DS_RESOURCE,
                            X.NR_NODES,
                            X.NR_COMPUTING_UNITS_CPU,
                            X.NR_COMPUTING_UNITS_GPU,
                            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            X.DS_DATASET,
                            X.VL_DATASET_MEMORY_SIZE,
                            X.DS_DATA_TYPE,
                            X.VL_DATA_TYPE_MEMORY_SIZE,
                            X.VL_DATASET_DIMENSION,
                            X.VL_DATASET_ROW_DIMENSION,
                            X.VL_DATASET_COLUMN_DIMENSION,
                            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            X.NR_RANDOM_STATE
                        ) Y
		) ZZ
WHERE ZZ.ds_algorithm='KMEANS'
AND ZZ.nr_iterations = 5
AND ZZ.ds_dataset = 'S_10GB_1'
--AND ZZ.ds_parameter_type = 'VAR_CORES_CLUSTER_1'
--AND ZZ.id_resource IN (3,4,5,6,7,8,9,10)
AND ZZ.ds_parameter_type = 'VAR_CORES_SINGLE_NODE_1'
AND ZZ.id_resource IN (3,11,12,13,14,15,16)
ORDER BY ZZ.ID_PARAMETER


-- Merging intra time results from experiment and inter time results from experiment_raw
SELECT
	AVG(ZZ.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
	AVG(ZZ.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
	AVG(ZZ.VL_INTER_TASK_EXECUTION_TIME) - AVG(ZZ.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
	AVG(ZZ.VL_INTER_TASK_EXECUTION_TIME) - (AVG(ZZ.VL_INTER_TASK_EXECUTION_TIME) - AVG(ZZ.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
	AVG(ZZ.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	AVG(ZZ.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	AVG(ZZ.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
	AVG(ZZ.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
	AVG(VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	ZZ.ID_PARAMETER,
	ZZ.CD_PARAMETER,
	ZZ.CD_CONFIGURATION,
	ZZ.ID_ALGORITHM,
	ZZ.DS_ALGORITHM,
	ZZ.ID_FUNCTION,
	ZZ.DS_FUNCTION,
	ZZ.ID_DEVICE,
	ZZ.DS_DEVICE,
	ZZ.ID_DATASET,
	ZZ.ID_RESOURCE,
	ZZ.ID_PARAMETER_TYPE,
	ZZ.DS_PARAMETER_TYPE,
	ZZ.DS_PARAMETER_ATTRIBUTE,
	ZZ.NR_ITERATIONS,
	ZZ.VL_GRID_ROW_DIMENSION,
	ZZ.VL_GRID_COLUMN_DIMENSION,
	ZZ.VL_GRID_ROW_X_COLUMN_DIMENSION,
	ZZ.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
	ZZ.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	ZZ.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	ZZ.VL_BLOCK_ROW_DIMENSION,
	ZZ.VL_BLOCK_COLUMN_DIMENSION,
	ZZ.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
	ZZ.VL_BLOCK_MEMORY_SIZE,
	ZZ.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	ZZ.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	ZZ.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	ZZ.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	ZZ.DS_RESOURCE,
	ZZ.NR_NODES,
	ZZ.NR_COMPUTING_UNITS_CPU,
	ZZ.NR_TOTAL_COMPUTING_UNITS_CPU,
	ZZ.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
	ZZ.NR_COMPUTING_UNITS_GPU,
	ZZ.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	ZZ.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	ZZ.DS_DATASET,
	ZZ.VL_DATASET_MEMORY_SIZE,
	ZZ.DS_DATA_TYPE,
	ZZ.VL_DATA_TYPE_MEMORY_SIZE,
	ZZ.VL_DATASET_DIMENSION,
	ZZ.VL_DATASET_ROW_DIMENSION,
	ZZ.VL_DATASET_COLUMN_DIMENSION,
	ZZ.VL_DATASET_ROW_X_COLUMN_DIMENSION,
	ZZ.NR_RANDOM_STATE
FROM
(
	SELECT
		A.VL_TOTAL_EXECUTION_TIME,
		NULL AS VL_INTER_TASK_EXECUTION_TIME,
		A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		A.VL_COMMUNICATION_TIME,
		A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+A.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
		(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		B.ID_PARAMETER,
		B.CD_PARAMETER,
		B.CD_CONFIGURATION,
		B.ID_ALGORITHM,
		(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
		B.ID_FUNCTION,
		(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
		(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
		(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
		B.ID_DATASET,
		B.ID_RESOURCE,
		B.ID_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
		B.NR_ITERATIONS,
		B.VL_GRID_ROW_DIMENSION,
		B.VL_GRID_COLUMN_DIMENSION,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		B.VL_BLOCK_ROW_DIMENSION,
		B.VL_BLOCK_COLUMN_DIMENSION,
		B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		B.VL_BLOCK_MEMORY_SIZE,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		C.DS_RESOURCE,
		C.NR_NODES,
		C.NR_COMPUTING_UNITS_CPU,
		(C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
		(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
		C.NR_COMPUTING_UNITS_GPU,
		C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		D.DS_DATASET,
		D.VL_DATASET_MEMORY_SIZE,
		D.DS_DATA_TYPE,
		D.VL_DATA_TYPE_MEMORY_SIZE,
		D.VL_DATASET_DIMENSION,
		D.VL_DATASET_ROW_DIMENSION,
		D.VL_DATASET_COLUMN_DIMENSION,
		D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
		D.NR_RANDOM_STATE
	FROM EXPERIMENT A
	INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
	INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
	INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
	WHERE
	A.VL_TOTAL_EXECUTION_TIME is not null

	UNION ALL

	-- EXPERIMENT RAW QUERY
	SELECT
		Y.VL_TOTAL_EXECUTION_TIME,
		Y.VL_INTER_TASK_EXECUTION_TIME,
		Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		Y.VL_COMMUNICATION_TIME,
		Y.VL_ADDITIONAL_TIME,
		(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
		Y.ID_PARAMETER,
		Y.CD_PARAMETER,
		Y.CD_CONFIGURATION,
		Y.ID_ALGORITHM,
		Y.DS_ALGORITHM,
		Y.ID_FUNCTION,
		Y.DS_FUNCTION,
		Y.ID_DEVICE,
		Y.DS_DEVICE,
		Y.ID_DATASET,
		Y.ID_RESOURCE,
		Y.ID_PARAMETER_TYPE,
		Y.DS_PARAMETER_TYPE,
		Y.DS_PARAMETER_ATTRIBUTE,
		Y.NR_ITERATIONS,
		Y.VL_GRID_ROW_DIMENSION,
		Y.VL_GRID_COLUMN_DIMENSION,
		Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
		Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		Y.VL_BLOCK_ROW_DIMENSION,
		Y.VL_BLOCK_COLUMN_DIMENSION,
		Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		Y.VL_BLOCK_MEMORY_SIZE,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		Y.DS_RESOURCE,
		Y.NR_NODES,
		Y.NR_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
		(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
		Y.NR_COMPUTING_UNITS_GPU,
		Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		Y.DS_DATASET,
		Y.VL_DATASET_MEMORY_SIZE,
		Y.DS_DATA_TYPE,
		Y.VL_DATA_TYPE_MEMORY_SIZE,
		Y.VL_DATASET_DIMENSION,
		Y.VL_DATASET_ROW_DIMENSION,
		Y.VL_DATASET_COLUMN_DIMENSION,
		Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		Y.NR_RANDOM_STATE
	FROM
	(
		SELECT
		AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
		FROM
		(
			SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_COMMUNICATION_TIME_1,
				A.VL_COMMUNICATION_TIME_2,
				A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
				A.VL_ADDITIONAL_TIME_1,
				A.VL_ADDITIONAL_TIME_2,
				A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
				(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
				ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT_RAW A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			A.NR_ALGORITHM_ITERATION <> 0
		) X
		GROUP BY
		X.ID_PARAMETER,
		X.CD_PARAMETER,
		X.CD_CONFIGURATION,
		X.ID_ALGORITHM,
		X.DS_ALGORITHM,
		X.ID_FUNCTION,
		X.DS_FUNCTION,
		X.ID_DEVICE,
		X.DS_DEVICE,
		X.ID_DATASET,
		X.ID_RESOURCE,
		X.ID_PARAMETER_TYPE,
		X.DS_PARAMETER_TYPE,
		X.DS_PARAMETER_ATTRIBUTE,
		X.NR_ITERATIONS,
		X.VL_GRID_ROW_DIMENSION,
		X.VL_GRID_COLUMN_DIMENSION,
		X.VL_GRID_ROW_X_COLUMN_DIMENSION,
		X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		X.VL_BLOCK_ROW_DIMENSION,
		X.VL_BLOCK_COLUMN_DIMENSION,
		X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		X.VL_BLOCK_MEMORY_SIZE,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		X.DS_RESOURCE,
		X.NR_NODES,
		X.NR_COMPUTING_UNITS_CPU,
		X.NR_COMPUTING_UNITS_GPU,
		X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		X.DS_DATASET,
		X.VL_DATASET_MEMORY_SIZE,
		X.DS_DATA_TYPE,
		X.VL_DATA_TYPE_MEMORY_SIZE,
		X.VL_DATASET_DIMENSION,
		X.VL_DATASET_ROW_DIMENSION,
		X.VL_DATASET_COLUMN_DIMENSION,
		X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		X.NR_RANDOM_STATE
	) Y
) ZZ
WHERE ZZ.ds_algorithm='KMEANS'
AND ZZ.nr_iterations = 5
AND ZZ.DS_RESOURCE = 'MINOTAURO_9_NODES_16_CORES'
AND ZZ.ds_dataset = 'S_10GB_1'
AND ZZ.ds_parameter_type = 'VAR_GRID_ROW'
GROUP BY
ZZ.ID_PARAMETER,
ZZ.CD_PARAMETER,
ZZ.CD_CONFIGURATION,
ZZ.ID_ALGORITHM,
ZZ.DS_ALGORITHM,
ZZ.ID_FUNCTION,
ZZ.DS_FUNCTION,
ZZ.ID_DEVICE,
ZZ.DS_DEVICE,
ZZ.ID_DATASET,
ZZ.ID_RESOURCE,
ZZ.ID_PARAMETER_TYPE,
ZZ.DS_PARAMETER_TYPE,
ZZ.DS_PARAMETER_ATTRIBUTE,
ZZ.NR_ITERATIONS,
ZZ.VL_GRID_ROW_DIMENSION,
ZZ.VL_GRID_COLUMN_DIMENSION,
ZZ.VL_GRID_ROW_X_COLUMN_DIMENSION,
ZZ.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
ZZ.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
ZZ.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
ZZ.VL_BLOCK_ROW_DIMENSION,
ZZ.VL_BLOCK_COLUMN_DIMENSION,
ZZ.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
ZZ.VL_BLOCK_MEMORY_SIZE,
ZZ.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
ZZ.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
ZZ.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
ZZ.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
ZZ.DS_RESOURCE,
ZZ.NR_NODES,
ZZ.NR_COMPUTING_UNITS_CPU,
ZZ.NR_TOTAL_COMPUTING_UNITS_CPU,
ZZ.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
ZZ.NR_COMPUTING_UNITS_GPU,
ZZ.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
ZZ.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
ZZ.DS_DATASET,
ZZ.VL_DATASET_MEMORY_SIZE,
ZZ.DS_DATA_TYPE,
ZZ.VL_DATA_TYPE_MEMORY_SIZE,
ZZ.VL_DATASET_DIMENSION,
ZZ.VL_DATASET_ROW_DIMENSION,
ZZ.VL_DATASET_COLUMN_DIMENSION,
ZZ.VL_DATASET_ROW_X_COLUMN_DIMENSION,
ZZ.NR_RANDOM_STATE
ORDER BY ZZ.ID_PARAMETER


-- EXPERIMENT QUERY
SELECT
	A.ID_EXPERIMENT,
	A.VL_TOTAL_EXECUTION_TIME,
	A.VL_INTER_TASK_EXECUTION_TIME,
	(A.VL_INTER_TASK_EXECUTION_TIME - A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
	A.VL_INTER_TASK_EXECUTION_TIME - (A.VL_INTER_TASK_EXECUTION_TIME - A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
	A.VL_INTER_TASK_EXECUTION_TIME - (VL_INTER_TASK_EXECUTION_TIME - (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME)) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD_FREE_ADDITIONAL,
	A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	A.VL_COMMUNICATION_TIME,
	A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+A.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
	(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	A.DT_PROCESSING,
	B.ID_PARAMETER,
	B.CD_PARAMETER,
	B.CD_CONFIGURATION,
	B.ID_ALGORITHM,
	(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
	B.ID_FUNCTION,
	(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
	(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
	(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
	B.ID_DATASET,
	B.ID_RESOURCE,
	B.ID_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
	B.NR_ITERATIONS,
	B.VL_GRID_ROW_DIMENSION,
	B.VL_GRID_COLUMN_DIMENSION,
	B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
	B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
	ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	B.VL_BLOCK_ROW_DIMENSION,
	B.VL_BLOCK_COLUMN_DIMENSION,
	B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
	B.VL_BLOCK_MEMORY_SIZE,
	B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	C.DS_RESOURCE,
	C.NR_NODES,
	C.NR_COMPUTING_UNITS_CPU,
	C.NR_COMPUTING_UNITS_GPU,
	C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	D.DS_DATASET,
	D.VL_DATASET_MEMORY_SIZE,
	D.DS_DATA_TYPE,
	D.VL_DATA_TYPE_MEMORY_SIZE,
	D.VL_DATASET_DIMENSION,
	D.VL_DATASET_ROW_DIMENSION,
	D.VL_DATASET_COLUMN_DIMENSION,
	D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
	D.NR_RANDOM_STATE
FROM EXPERIMENT A
INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
WHERE
C.DS_RESOURCE = 'MINOTAURO_9_NODES_16_CORES'
AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_GRID_ROW'
AND D.DS_DATASET = 'S_1GB_1'
--ORDER BY ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2)
ORDER BY A.ID_PARAMETER;



-- EXPERIMENT QUERIES
-- MODE 1: BEHAVIOR OF DEVICES ACCORDING TO DATA SET MEMORY SIZE
SELECT
--SBQ.DS_DATASET,
SBQ.DS_DEVICE,
SBQ.VL_DATASET_MEMORY_SIZE,
AVG(SBQ.VL_TOTAL_EXECUTION_TIME) AS AVG_VL_TOTAL_EXECUTION_TIME,
AVG(SBQ.VL_INTER_TASK_EXECUTION_TIME) AS AVG_VL_INTER_TASK_EXECUTION_TIME,
AVG(SBQ.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS AVG_VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
AVG(SBQ.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS AVG_VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
AVG(SBQ.VL_COMMUNICATION_TIME) AS AVG_VL_COMMUNICATION_TIME
FROM
(
			SELECT
			A.ID_EXPERIMENT,
			A.VL_TOTAL_EXECUTION_TIME,
			A.VL_INTER_TASK_EXECUTION_TIME,
			A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			A.VL_COMMUNICATION_TIME,
			A.DT_PROCESSING,
			B.ID_PARAMETER,
			B.CD_PARAMETER,
			B.CD_CONFIGURATION,
			B.ID_ALGORITHM,
			(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
			B.ID_FUNCTION,
			(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
			(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
			B.ID_DATASET,
			B.ID_RESOURCE,
			B.ID_PARAMETER_TYPE,
			(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
			(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
			B.NR_ITERATIONS,
			B.VL_GRID_ROW_DIMENSION,
			B.VL_GRID_COLUMN_DIMENSION,
			B.VL_BLOCK_ROW_DIMENSION,
			B.VL_BLOCK_COLUMN_DIMENSION,
			B.VL_BLOCK_MEMORY_SIZE,
			B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			C.DS_RESOURCE,
			C.NR_NODES,
			C.NR_COMPUTING_UNITS_CPU,
			C.NR_COMPUTING_UNITS_GPU,
			C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			D.DS_DATASET,
			D.VL_DATASET_MEMORY_SIZE,
			D.DS_DATA_TYPE,
			D.VL_DATA_TYPE_MEMORY_SIZE,
			D.VL_DATASET_DIMENSION,
			D.VL_DATASET_ROW_DIMENSION,
			D.VL_DATASET_COLUMN_DIMENSION,
			D.NR_RANDOM_STATE
		FROM EXPERIMENT A
		INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
		INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
		INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
		WHERE
		(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'KMEANS' -- FIXED VALUE
		AND B.NR_ITERATIONS = 5 -- FIXED VALUE
		AND C.DS_RESOURCE = 'MINOTAURO_1' -- FIXED VALUE
		--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_BLOCK_CAPACITY_SIZE' -- 1.1, 1.2, 1.3, 1.4
		--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_PARALLELISM_LEVEL' -- 2.1, 2.2
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.25' -- 1.1
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.50' -- 1.2
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.75' -- 1.3
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '1.00' -- 1.4
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'MIN_INTER_MAX_INTRA'--2.1
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'MAX_INTER_MIN_INTRA'--2.2
		
) SBQ
GROUP BY
--SBQ.DS_DATASET,
SBQ.DS_DEVICE,
SBQ.VL_DATASET_MEMORY_SIZE
ORDER BY
AVG(SBQ.VL_TOTAL_EXECUTION_TIME) DESC




-- MODE 8.1: CPU SPEEDUP OVER GPU
WITH T_CPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		),
T_GPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
		)
SELECT 
T_CPU.CD_PARAMETER,
T_CPU.DS_ALGORITHM,
T_CPU.NR_ITERATIONS,
T_CPU.DS_RESOURCE,
T_CPU.DS_PARAMETER_TYPE,
T_CPU.DS_PARAMETER_ATTRIBUTE,
T_CPU.DS_DATASET,
T_CPU.VL_DATASET_MEMORY_SIZE,
T_CPU.VL_DATASET_DIMENSION,
T_CPU.VL_DATASET_ROW_DIMENSION,
T_CPU.VL_DATASET_COLUMN_DIMENSION,
T_CPU.VL_GRID_ROW_DIMENSION,
T_CPU.VL_GRID_COLUMN_DIMENSION,
T_CPU.VL_BLOCK_ROW_DIMENSION,
T_CPU.VL_BLOCK_COLUMN_DIMENSION,
T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME AS SPEEDUP_CPU_TOTAL_EXECUTION_TIME,
T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME AS SPEEDUP_CPU_INTER_TASK_EXECUTION_TIME,
T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_TOTAL_EXECUTION_TIME < T_GPU.VL_TOTAL_EXECUTION_TIME
--AND T_CPU.VL_INTER_TASK_EXECUTION_TIME < T_GPU.VL_INTER_TASK_EXECUTION_TIME
--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
--AND T_CPU.DS_PARAMETER_TYPE = 'VAR_BLOCK_CAPACITY_SIZE'
--AND T_CPU.DS_PARAMETER_TYPE = 'VAR_PARALLELISM_LEVEL'
ORDER BY T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME DESC


-- MODE 8.2: CPU SPEEDUP OVER GPU (GROUPED)
WITH T_CPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		),
T_GPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
		)
SELECT 
--T_CPU.CD_PARAMETER,
--T_CPU.DS_PARAMETER_TYPE,
--T_CPU.DS_PARAMETER_ATTRIBUTE,
--T_CPU.DS_DATASET,
T_CPU.VL_DATASET_MEMORY_SIZE,
--T_CPU.VL_DATASET_DIMENSION,
--T_CPU.VL_DATASET_ROW_DIMENSION,
--T_CPU.VL_DATASET_COLUMN_DIMENSION,
--T_CPU.VL_GRID_ROW_DIMENSION,
--T_CPU.VL_GRID_COLUMN_DIMENSION,
--T_CPU.VL_BLOCK_ROW_DIMENSION,
--T_CPU.VL_BLOCK_COLUMN_DIMENSION,
AVG(T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME) AS SPEEDUP_CPU_TOTAL_EXECUTION_TIME,
AVG(T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME) AS SPEEDUP_CPU_INTER_TASK_EXECUTION_TIME,
AVG(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
AVG(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_TOTAL_EXECUTION_TIME < T_GPU.VL_TOTAL_EXECUTION_TIME
--AND T_CPU.VL_INTER_TASK_EXECUTION_TIME < T_GPU.VL_INTER_TASK_EXECUTION_TIME
--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
--AND T_CPU.DS_PARAMETER_TYPE = 'VAR_BLOCK_CAPACITY_SIZE'
--AND T_CPU.DS_PARAMETER_TYPE = 'VAR_PARALLELISM_LEVEL'
GROUP BY T_CPU.VL_DATASET_MEMORY_SIZE
ORDER BY AVG(T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME) DESC


-- MODE 8.3: CPU SPEEDUP OVER GPU - HEATMAP
SELECT
X.DS_DATASET,
X.DS_PARAMETER_ATTRIBUTE,
X.SPEEDUP_CPU_TOTAL_EXECUTION_TIME
FROM
(
WITH T_CPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		),
T_GPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
		)
SELECT 
T_CPU.CD_PARAMETER,
T_CPU.DS_ALGORITHM,
T_CPU.NR_ITERATIONS,
T_CPU.DS_RESOURCE,
T_CPU.DS_PARAMETER_TYPE,
T_CPU.DS_PARAMETER_ATTRIBUTE,
T_CPU.DS_DATASET,
T_CPU.VL_DATASET_MEMORY_SIZE,
T_CPU.VL_DATASET_DIMENSION,
T_CPU.VL_DATASET_ROW_DIMENSION,
T_CPU.VL_DATASET_COLUMN_DIMENSION,
T_CPU.VL_GRID_ROW_DIMENSION,
T_CPU.VL_GRID_COLUMN_DIMENSION,
T_CPU.VL_BLOCK_ROW_DIMENSION,
T_CPU.VL_BLOCK_COLUMN_DIMENSION,
T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME AS SPEEDUP_CPU_TOTAL_EXECUTION_TIME,
T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME AS SPEEDUP_CPU_INTER_TASK_EXECUTION_TIME,
T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_TOTAL_EXECUTION_TIME < T_GPU.VL_TOTAL_EXECUTION_TIME
AND T_CPU.DS_ALGORITHM = 'KMEANS'
AND T_CPU.NR_ITERATIONS = 5
AND T_CPU.DS_RESOURCE = 'MINOTAURO_1'
--AND T_CPU.VL_INTER_TASK_EXECUTION_TIME < T_GPU.VL_INTER_TASK_EXECUTION_TIME
--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
--AND T_CPU.DS_PARAMETER_TYPE = 'VAR_BLOCK_CAPACITY_SIZE'
--AND T_CPU.DS_PARAMETER_TYPE = 'VAR_PARALLELISM_LEVEL'
--ORDER BY T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME DESC
) X
ORDER BY SPEEDUP_CPU_TOTAL_EXECUTION_TIME DESC


-- MODE 9.1: GPU SPEEDUP OVER CPU
WITH T_CPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		),
T_GPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
		)
SELECT 
T_GPU.CD_PARAMETER,
T_GPU.DS_ALGORITHM,
T_GPU.NR_ITERATIONS,
T_GPU.DS_RESOURCE,
T_GPU.DS_PARAMETER_TYPE,
T_GPU.DS_PARAMETER_ATTRIBUTE,
T_GPU.DS_DATASET,
T_GPU.VL_DATASET_MEMORY_SIZE,
T_GPU.VL_DATASET_DIMENSION,
T_GPU.VL_DATASET_ROW_DIMENSION,
T_GPU.VL_DATASET_COLUMN_DIMENSION,
T_GPU.VL_GRID_ROW_DIMENSION,
T_GPU.VL_GRID_COLUMN_DIMENSION,
T_GPU.VL_BLOCK_ROW_DIMENSION,
T_GPU.VL_BLOCK_COLUMN_DIMENSION,
T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME AS SPEEDUP_GPU_TOTAL_EXECUTION_TIME,
T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME AS SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME,
T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_GPU.VL_TOTAL_EXECUTION_TIME < T_CPU.VL_TOTAL_EXECUTION_TIME
--AND T_GPU.VL_INTER_TASK_EXECUTION_TIME < T_CPU.VL_INTER_TASK_EXECUTION_TIME
--AND T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC < T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
--AND T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC < T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
--AND T_GPU.DS_PARAMETER_TYPE = 'VAR_BLOCK_CAPACITY_SIZE'
--AND T_GPU.DS_PARAMETER_TYPE = 'VAR_PARALLELISM_LEVEL'
ORDER BY T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME DESC


-- MODE 9.2: GPU SPEEDUP OVER CPU (GROUPED)
WITH T_CPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		),
T_GPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
		)
SELECT 
--T_GPU.CD_PARAMETER,
--T_GPU.DS_PARAMETER_TYPE,
--T_GPU.DS_PARAMETER_ATTRIBUTE,
--T_GPU.DS_DATASET,
T_GPU.VL_DATASET_MEMORY_SIZE,
--T_GPU.VL_DATASET_DIMENSION,
--T_GPU.VL_DATASET_ROW_DIMENSION,
--T_GPU.VL_DATASET_COLUMN_DIMENSION,
--T_GPU.VL_GRID_ROW_DIMENSION,
--T_GPU.VL_GRID_COLUMN_DIMENSION,
--T_GPU.VL_BLOCK_ROW_DIMENSION,
--T_GPU.VL_BLOCK_COLUMN_DIMENSION,
AVG(T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME) AS SPEEDUP_GPU_TOTAL_EXECUTION_TIME,
AVG(T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) AS SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME,
AVG(T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
AVG(T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_GPU.VL_TOTAL_EXECUTION_TIME < T_CPU.VL_TOTAL_EXECUTION_TIME
--AND T_GPU.VL_INTER_TASK_EXECUTION_TIME < T_CPU.VL_INTER_TASK_EXECUTION_TIME
--AND T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC < T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
--AND T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC < T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
--AND T_CPU.DS_PARAMETER_TYPE = 'VAR_BLOCK_CAPACITY_SIZE'
--AND T_CPU.DS_PARAMETER_TYPE = 'VAR_PARALLELISM_LEVEL'
GROUP BY T_GPU.VL_DATASET_MEMORY_SIZE
ORDER BY AVG(T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME) DESC


-- MODE 9.3: GPU SPEEDUP OVER CPU - HEATMAP
SELECT
X.DS_DATASET,
X.DS_PARAMETER_ATTRIBUTE,
X.SPEEDUP_GPU_TOTAL_EXECUTION_TIME
FROM
(
WITH T_CPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
		),
T_GPU AS (
				SELECT
				A.ID_EXPERIMENT,
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				A.DT_PROCESSING,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
		)
SELECT 
T_GPU.CD_PARAMETER,
T_GPU.DS_ALGORITHM,
T_GPU.NR_ITERATIONS,
T_GPU.DS_RESOURCE,
T_GPU.DS_PARAMETER_TYPE,
T_GPU.DS_PARAMETER_ATTRIBUTE,
T_GPU.DS_DATASET,
T_GPU.VL_DATASET_MEMORY_SIZE,
T_GPU.VL_DATASET_DIMENSION,
T_GPU.VL_DATASET_ROW_DIMENSION,
T_GPU.VL_DATASET_COLUMN_DIMENSION,
T_GPU.VL_GRID_ROW_DIMENSION,
T_GPU.VL_GRID_COLUMN_DIMENSION,
T_GPU.VL_BLOCK_ROW_DIMENSION,
T_GPU.VL_BLOCK_COLUMN_DIMENSION,
T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME AS SPEEDUP_GPU_TOTAL_EXECUTION_TIME,
T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME AS SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME,
T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_GPU.VL_TOTAL_EXECUTION_TIME < T_CPU.VL_TOTAL_EXECUTION_TIME
--AND T_GPU.VL_INTER_TASK_EXECUTION_TIME < T_CPU.VL_INTER_TASK_EXECUTION_TIME
--AND T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC < T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
--AND T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC < T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
--AND T_GPU.DS_PARAMETER_TYPE = 'VAR_BLOCK_CAPACITY_SIZE'
--AND T_GPU.DS_PARAMETER_TYPE = 'VAR_PARALLELISM_LEVEL'
--ORDER BY T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME DESC
) X
ORDER BY SPEEDUP_GPU_TOTAL_EXECUTION_TIME DESC


-- MODE 18: CPU AND GPU SPEEDUPS
WITH T_CPU AS (
				SELECT
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
			FROM EXPERIMENT A
			INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
			INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
			INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
			WHERE
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
			
			UNION ALL
	
				SELECT
				Y.VL_TOTAL_EXECUTION_TIME,
				Y.VL_INTER_TASK_EXECUTION_TIME,
				Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				Y.VL_COMMUNICATION_TIME,
				(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				Y.ID_PARAMETER,
				Y.CD_PARAMETER,
				Y.CD_CONFIGURATION,
				Y.ID_ALGORITHM,
				Y.DS_ALGORITHM,
				Y.ID_FUNCTION,
				Y.DS_FUNCTION,
				Y.ID_DEVICE,
				Y.DS_DEVICE,
				Y.ID_DATASET,
				Y.ID_RESOURCE,
				Y.ID_PARAMETER_TYPE,
				Y.DS_PARAMETER_TYPE,
				Y.DS_PARAMETER_ATTRIBUTE,
				Y.NR_ITERATIONS,
				Y.VL_GRID_ROW_DIMENSION,
				Y.VL_GRID_COLUMN_DIMENSION,
				Y.VL_BLOCK_ROW_DIMENSION,
				Y.VL_BLOCK_COLUMN_DIMENSION,
				Y.VL_BLOCK_MEMORY_SIZE,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				Y.DS_RESOURCE,
				Y.NR_NODES,
				Y.NR_COMPUTING_UNITS_CPU,
				Y.NR_COMPUTING_UNITS_GPU,
				Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				Y.DS_DATASET,
				Y.VL_DATASET_MEMORY_SIZE,
				Y.DS_DATA_TYPE,
				Y.VL_DATA_TYPE_MEMORY_SIZE,
				Y.VL_DATASET_DIMENSION,
				Y.VL_DATASET_ROW_DIMENSION,
				Y.VL_DATASET_COLUMN_DIMENSION,
				Y.NR_RANDOM_STATE
				FROM
				(
					SELECT
					AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
					AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
					AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
					AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
					AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
					AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
					AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
					AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
					X.ID_PARAMETER,
					X.CD_PARAMETER,
					X.CD_CONFIGURATION,
					X.ID_ALGORITHM,
					X.DS_ALGORITHM,
					X.ID_FUNCTION,
					X.DS_FUNCTION,
					X.ID_DEVICE,
					X.DS_DEVICE,
					X.ID_DATASET,
					X.ID_RESOURCE,
					X.ID_PARAMETER_TYPE,
					X.DS_PARAMETER_TYPE,
					X.DS_PARAMETER_ATTRIBUTE,
					X.NR_ITERATIONS,
					X.VL_GRID_ROW_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION,
					X.VL_GRID_ROW_X_COLUMN_DIMENSION,
					X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_BLOCK_ROW_DIMENSION,
					X.VL_BLOCK_COLUMN_DIMENSION,
					X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					X.VL_BLOCK_MEMORY_SIZE,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.DS_RESOURCE,
					X.NR_NODES,
					X.NR_COMPUTING_UNITS_CPU,
					X.NR_COMPUTING_UNITS_GPU,
					X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					X.DS_DATASET,
					X.VL_DATASET_MEMORY_SIZE,
					X.DS_DATA_TYPE,
					X.VL_DATA_TYPE_MEMORY_SIZE,
					X.VL_DATASET_DIMENSION,
					X.VL_DATASET_ROW_DIMENSION,
					X.VL_DATASET_COLUMN_DIMENSION,
					X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
					X.NR_RANDOM_STATE
					FROM
					(
						SELECT
							A.ID_EXPERIMENT,
							A.VL_TOTAL_EXECUTION_TIME,
							A.VL_INTER_TASK_EXECUTION_TIME,
							A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
							A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
							A.VL_COMMUNICATION_TIME_1,
							A.VL_COMMUNICATION_TIME_2,
							A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
							A.VL_ADDITIONAL_TIME_1,
							A.VL_ADDITIONAL_TIME_2,
							A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
							A.DT_PROCESSING,
							B.ID_PARAMETER,
							B.CD_PARAMETER,
							B.CD_CONFIGURATION,
							B.ID_ALGORITHM,
							(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
							B.ID_FUNCTION,
							(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
							(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
							(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
							B.ID_DATASET,
							B.ID_RESOURCE,
							B.ID_PARAMETER_TYPE,
							(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
							(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
							B.NR_ITERATIONS,
							B.VL_GRID_ROW_DIMENSION,
							B.VL_GRID_COLUMN_DIMENSION,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
							ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
							B.VL_BLOCK_ROW_DIMENSION,
							B.VL_BLOCK_COLUMN_DIMENSION,
							B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
							B.VL_BLOCK_MEMORY_SIZE,
							B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
							B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
							ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							C.DS_RESOURCE,
							C.NR_NODES,
							C.NR_COMPUTING_UNITS_CPU,
							C.NR_COMPUTING_UNITS_GPU,
							C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
							C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
							D.DS_DATASET,
							D.VL_DATASET_MEMORY_SIZE,
							D.DS_DATA_TYPE,
							D.VL_DATA_TYPE_MEMORY_SIZE,
							D.VL_DATASET_DIMENSION,
							D.VL_DATASET_ROW_DIMENSION,
							D.VL_DATASET_COLUMN_DIMENSION,
							D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
							D.NR_RANDOM_STATE
						FROM EXPERIMENT_RAW A
						INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
						INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
						INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
						WHERE
						(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
						A.NR_ALGORITHM_ITERATION <> 0
					) X
					GROUP BY
					X.ID_PARAMETER,
					X.CD_PARAMETER,
					X.CD_CONFIGURATION,
					X.ID_ALGORITHM,
					X.DS_ALGORITHM,
					X.ID_FUNCTION,
					X.DS_FUNCTION,
					X.ID_DEVICE,
					X.DS_DEVICE,
					X.ID_DATASET,
					X.ID_RESOURCE,
					X.ID_PARAMETER_TYPE,
					X.DS_PARAMETER_TYPE,
					X.DS_PARAMETER_ATTRIBUTE,
					X.NR_ITERATIONS,
					X.VL_GRID_ROW_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION,
					X.VL_GRID_ROW_X_COLUMN_DIMENSION,
					X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_BLOCK_ROW_DIMENSION,
					X.VL_BLOCK_COLUMN_DIMENSION,
					X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					X.VL_BLOCK_MEMORY_SIZE,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.DS_RESOURCE,
					X.NR_NODES,
					X.NR_COMPUTING_UNITS_CPU,
					X.NR_COMPUTING_UNITS_GPU,
					X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					X.DS_DATASET,
					X.VL_DATASET_MEMORY_SIZE,
					X.DS_DATA_TYPE,
					X.VL_DATA_TYPE_MEMORY_SIZE,
					X.VL_DATASET_DIMENSION,
					X.VL_DATASET_ROW_DIMENSION,
					X.VL_DATASET_COLUMN_DIMENSION,
					X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
					X.NR_RANDOM_STATE
				) Y
	
			),
T_GPU AS (
				SELECT
				A.VL_TOTAL_EXECUTION_TIME,
				A.VL_INTER_TASK_EXECUTION_TIME,
				A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				A.VL_COMMUNICATION_TIME,
				(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				B.ID_PARAMETER,
				B.CD_PARAMETER,
				B.CD_CONFIGURATION,
				B.ID_ALGORITHM,
				(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
				B.ID_FUNCTION,
				(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
				(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
				B.ID_DATASET,
				B.ID_RESOURCE,
				B.ID_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
				(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
				B.NR_ITERATIONS,
				B.VL_GRID_ROW_DIMENSION,
				B.VL_GRID_COLUMN_DIMENSION,
				B.VL_BLOCK_ROW_DIMENSION,
				B.VL_BLOCK_COLUMN_DIMENSION,
				B.VL_BLOCK_MEMORY_SIZE,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				C.DS_RESOURCE,
				C.NR_NODES,
				C.NR_COMPUTING_UNITS_CPU,
				C.NR_COMPUTING_UNITS_GPU,
				C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				D.DS_DATASET,
				D.VL_DATASET_MEMORY_SIZE,
				D.DS_DATA_TYPE,
				D.VL_DATA_TYPE_MEMORY_SIZE,
				D.VL_DATASET_DIMENSION,
				D.VL_DATASET_ROW_DIMENSION,
				D.VL_DATASET_COLUMN_DIMENSION,
				D.NR_RANDOM_STATE
				FROM EXPERIMENT A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
				(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
		
			UNION ALL
	
				SELECT
				Y.VL_TOTAL_EXECUTION_TIME,
				Y.VL_INTER_TASK_EXECUTION_TIME,
				Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
				Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
				Y.VL_COMMUNICATION_TIME,
				(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
				Y.ID_PARAMETER,
				Y.CD_PARAMETER,
				Y.CD_CONFIGURATION,
				Y.ID_ALGORITHM,
				Y.DS_ALGORITHM,
				Y.ID_FUNCTION,
				Y.DS_FUNCTION,
				Y.ID_DEVICE,
				Y.DS_DEVICE,
				Y.ID_DATASET,
				Y.ID_RESOURCE,
				Y.ID_PARAMETER_TYPE,
				Y.DS_PARAMETER_TYPE,
				Y.DS_PARAMETER_ATTRIBUTE,
				Y.NR_ITERATIONS,
				Y.VL_GRID_ROW_DIMENSION,
				Y.VL_GRID_COLUMN_DIMENSION,
				Y.VL_BLOCK_ROW_DIMENSION,
				Y.VL_BLOCK_COLUMN_DIMENSION,
				Y.VL_BLOCK_MEMORY_SIZE,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
				Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
				Y.DS_RESOURCE,
				Y.NR_NODES,
				Y.NR_COMPUTING_UNITS_CPU,
				Y.NR_COMPUTING_UNITS_GPU,
				Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
				Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
				Y.DS_DATASET,
				Y.VL_DATASET_MEMORY_SIZE,
				Y.DS_DATA_TYPE,
				Y.VL_DATA_TYPE_MEMORY_SIZE,
				Y.VL_DATASET_DIMENSION,
				Y.VL_DATASET_ROW_DIMENSION,
				Y.VL_DATASET_COLUMN_DIMENSION,
				Y.NR_RANDOM_STATE
				FROM
				(
					SELECT
					AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
					AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
					AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
					AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
					AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
					AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
					AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
					AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
					X.ID_PARAMETER,
					X.CD_PARAMETER,
					X.CD_CONFIGURATION,
					X.ID_ALGORITHM,
					X.DS_ALGORITHM,
					X.ID_FUNCTION,
					X.DS_FUNCTION,
					X.ID_DEVICE,
					X.DS_DEVICE,
					X.ID_DATASET,
					X.ID_RESOURCE,
					X.ID_PARAMETER_TYPE,
					X.DS_PARAMETER_TYPE,
					X.DS_PARAMETER_ATTRIBUTE,
					X.NR_ITERATIONS,
					X.VL_GRID_ROW_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION,
					X.VL_GRID_ROW_X_COLUMN_DIMENSION,
					X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_BLOCK_ROW_DIMENSION,
					X.VL_BLOCK_COLUMN_DIMENSION,
					X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					X.VL_BLOCK_MEMORY_SIZE,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.DS_RESOURCE,
					X.NR_NODES,
					X.NR_COMPUTING_UNITS_CPU,
					X.NR_COMPUTING_UNITS_GPU,
					X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					X.DS_DATASET,
					X.VL_DATASET_MEMORY_SIZE,
					X.DS_DATA_TYPE,
					X.VL_DATA_TYPE_MEMORY_SIZE,
					X.VL_DATASET_DIMENSION,
					X.VL_DATASET_ROW_DIMENSION,
					X.VL_DATASET_COLUMN_DIMENSION,
					X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
					X.NR_RANDOM_STATE
					FROM
					(
						SELECT
							A.ID_EXPERIMENT,
							A.VL_TOTAL_EXECUTION_TIME,
							A.VL_INTER_TASK_EXECUTION_TIME,
							A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
							A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
							A.VL_COMMUNICATION_TIME_1,
							A.VL_COMMUNICATION_TIME_2,
							A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
							A.VL_ADDITIONAL_TIME_1,
							A.VL_ADDITIONAL_TIME_2,
							A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
							A.DT_PROCESSING,
							B.ID_PARAMETER,
							B.CD_PARAMETER,
							B.CD_CONFIGURATION,
							B.ID_ALGORITHM,
							(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
							B.ID_FUNCTION,
							(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
							(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
							(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
							B.ID_DATASET,
							B.ID_RESOURCE,
							B.ID_PARAMETER_TYPE,
							(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
							(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
							B.NR_ITERATIONS,
							B.VL_GRID_ROW_DIMENSION,
							B.VL_GRID_COLUMN_DIMENSION,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,							
							ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
							B.VL_BLOCK_ROW_DIMENSION,
							B.VL_BLOCK_COLUMN_DIMENSION,
							B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
							B.VL_BLOCK_MEMORY_SIZE,
							B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
							B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
							ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							C.DS_RESOURCE,
							C.NR_NODES,
							C.NR_COMPUTING_UNITS_CPU,
							C.NR_COMPUTING_UNITS_GPU,
							C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
							C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
							D.DS_DATASET,
							D.VL_DATASET_MEMORY_SIZE,
							D.DS_DATA_TYPE,
							D.VL_DATA_TYPE_MEMORY_SIZE,
							D.VL_DATASET_DIMENSION,
							D.VL_DATASET_ROW_DIMENSION,
							D.VL_DATASET_COLUMN_DIMENSION,
							D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
							D.NR_RANDOM_STATE
						FROM EXPERIMENT_RAW A
						INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
						INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
						INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
						WHERE
						(SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
						A.NR_ALGORITHM_ITERATION <> 0
					) X
					GROUP BY
					X.ID_PARAMETER,
					X.CD_PARAMETER,
					X.CD_CONFIGURATION,
					X.ID_ALGORITHM,
					X.DS_ALGORITHM,
					X.ID_FUNCTION,
					X.DS_FUNCTION,
					X.ID_DEVICE,
					X.DS_DEVICE,
					X.ID_DATASET,
					X.ID_RESOURCE,
					X.ID_PARAMETER_TYPE,
					X.DS_PARAMETER_TYPE,
					X.DS_PARAMETER_ATTRIBUTE,
					X.NR_ITERATIONS,
					X.VL_GRID_ROW_DIMENSION,
					X.VL_GRID_COLUMN_DIMENSION,
					X.VL_GRID_ROW_X_COLUMN_DIMENSION,
					X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					X.VL_BLOCK_ROW_DIMENSION,
					X.VL_BLOCK_COLUMN_DIMENSION,
					X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					X.VL_BLOCK_MEMORY_SIZE,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					X.DS_RESOURCE,
					X.NR_NODES,
					X.NR_COMPUTING_UNITS_CPU,
					X.NR_COMPUTING_UNITS_GPU,
					X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					X.DS_DATASET,
					X.VL_DATASET_MEMORY_SIZE,
					X.DS_DATA_TYPE,
					X.VL_DATA_TYPE_MEMORY_SIZE,
					X.VL_DATASET_DIMENSION,
					X.VL_DATASET_ROW_DIMENSION,
					X.VL_DATASET_COLUMN_DIMENSION,
					X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
					X.NR_RANDOM_STATE
				) Y
)
SELECT
T_CPU.ID_PARAMETER_TYPE,
T_CPU.CD_PARAMETER,
T_CPU.DS_ALGORITHM,
T_CPU.NR_ITERATIONS,
ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
T_CPU.DS_RESOURCE,
T_CPU.DS_PARAMETER_TYPE,
T_CPU.DS_PARAMETER_ATTRIBUTE,
T_CPU.DS_DATASET,
CAST(T_CPU.VL_DATASET_MEMORY_SIZE*1e-6 AS BIGINT) as VL_DATASET_MEMORY_SIZE,
T_CPU.VL_DATASET_DIMENSION,
T_CPU.VL_DATASET_ROW_DIMENSION,
T_CPU.VL_DATASET_COLUMN_DIMENSION,
T_CPU.VL_GRID_ROW_DIMENSION,
T_CPU.VL_GRID_COLUMN_DIMENSION,
T_CPU.VL_BLOCK_ROW_DIMENSION,
T_CPU.VL_BLOCK_COLUMN_DIMENSION,
CASE
WHEN (T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME) > 1.00 THEN (T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME)
ELSE 0
END AS SPEEDUP_CPU_TOTAL_EXECUTION_TIME,
CASE
WHEN (T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME)
ELSE 0
END AS SPEEDUP_CPU_INTER_TASK_EXECUTION_TIME,
CASE
WHEN (T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) > 1.00 THEN (T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
ELSE 0
END AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
CASE
WHEN (T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
ELSE 0
END AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
CASE
WHEN (T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL) > 1.00 THEN (T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL)
ELSE 0
END AS SPEEDUP_CPU_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
CASE
WHEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME)
ELSE 0
END AS SPEEDUP_GPU_TOTAL_EXECUTION_TIME,
CASE
WHEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME)
ELSE 0
END AS SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
ELSE 0
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
ELSE 0
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
CASE
WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL)
ELSE 0
END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL
FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
WHERE
T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
ORDER BY
T_CPU.DS_DATASET,
T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET;


-- MODE 10.1: FIND WHERE CPUs HAVE A LOWER LATENCY THAN GPUs
SELECT
SBQ.ID_EXPERIMENT,
SBQ.ID_PARAMETER,
SBQ.CD_PARAMETER,
SBQ.DS_ALGORITHM,
SBQ.NR_ITERATIONS,
SBQ.DS_RESOURCE,
SBQ.DS_DEVICE,
SBQ.DS_PARAMETER_TYPE,
SBQ.DS_PARAMETER_ATTRIBUTE,
SBQ.DS_DATASET,
SBQ.VL_DATASET_MEMORY_SIZE,
SBQ.VL_DATASET_DIMENSION,
SBQ.VL_DATASET_ROW_DIMENSION,
SBQ.VL_DATASET_COLUMN_DIMENSION,
SBQ.VL_GRID_ROW_DIMENSION,
SBQ.VL_GRID_COLUMN_DIMENSION,
SBQ.VL_BLOCK_ROW_DIMENSION,
SBQ.VL_BLOCK_COLUMN_DIMENSION,
SBQ.VL_TOTAL_EXECUTION_TIME,
SBQ.VL_INTER_TASK_EXECUTION_TIME,
SBQ.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
SBQ.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
SBQ.VL_COMMUNICATION_TIME
FROM
(
	SELECT
		A.ID_EXPERIMENT,
		A.VL_TOTAL_EXECUTION_TIME,
		A.VL_INTER_TASK_EXECUTION_TIME,
		A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		A.VL_COMMUNICATION_TIME,
		A.DT_PROCESSING,
		B.ID_PARAMETER,
		B.CD_PARAMETER,
		B.CD_CONFIGURATION,
		B.ID_ALGORITHM,
		(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
		B.ID_FUNCTION,
		(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
		(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
		(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
		B.ID_DATASET,
		B.ID_RESOURCE,
		B.ID_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
		B.NR_ITERATIONS,
		B.VL_GRID_ROW_DIMENSION,
		B.VL_GRID_COLUMN_DIMENSION,
		B.VL_BLOCK_ROW_DIMENSION,
		B.VL_BLOCK_COLUMN_DIMENSION,
		B.VL_BLOCK_MEMORY_SIZE,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		C.DS_RESOURCE,
		C.NR_NODES,
		C.NR_COMPUTING_UNITS_CPU,
		C.NR_COMPUTING_UNITS_GPU,
		C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		D.DS_DATASET,
		D.VL_DATASET_MEMORY_SIZE,
		D.DS_DATA_TYPE,
		D.VL_DATA_TYPE_MEMORY_SIZE,
		D.VL_DATASET_DIMENSION,
		D.VL_DATASET_ROW_DIMENSION,
		D.VL_DATASET_COLUMN_DIMENSION,
		D.NR_RANDOM_STATE
	FROM EXPERIMENT A
	INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
	INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
	INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
	WHERE
	B.CD_PARAMETER IN
	(
		WITH T_CPU AS (
						SELECT
						A.ID_EXPERIMENT,
						A.VL_TOTAL_EXECUTION_TIME,
						A.VL_INTER_TASK_EXECUTION_TIME,
						A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
						A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
						A.VL_COMMUNICATION_TIME,
						A.DT_PROCESSING,
						B.ID_PARAMETER,
						B.CD_PARAMETER,
						B.CD_CONFIGURATION,
						B.ID_ALGORITHM,
						(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
						B.ID_FUNCTION,
						(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
						(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
						(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
						B.ID_DATASET,
						B.ID_RESOURCE,
						B.ID_PARAMETER_TYPE,
						(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
						(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
						B.NR_ITERATIONS,
						B.VL_GRID_ROW_DIMENSION,
						B.VL_GRID_COLUMN_DIMENSION,
						B.VL_BLOCK_ROW_DIMENSION,
						B.VL_BLOCK_COLUMN_DIMENSION,
						B.VL_BLOCK_MEMORY_SIZE,
						B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
						B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
						C.DS_RESOURCE,
						C.NR_NODES,
						C.NR_COMPUTING_UNITS_CPU,
						C.NR_COMPUTING_UNITS_GPU,
						C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
						C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
						D.DS_DATASET,
						D.VL_DATASET_MEMORY_SIZE,
						D.DS_DATA_TYPE,
						D.VL_DATA_TYPE_MEMORY_SIZE,
						D.VL_DATASET_DIMENSION,
						D.VL_DATASET_ROW_DIMENSION,
						D.VL_DATASET_COLUMN_DIMENSION,
						D.NR_RANDOM_STATE
					FROM EXPERIMENT A
					INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
					INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
					INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
					WHERE
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
				),
		T_GPU AS (
						SELECT
						A.ID_EXPERIMENT,
						A.VL_TOTAL_EXECUTION_TIME,
						A.VL_INTER_TASK_EXECUTION_TIME,
						A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
						A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
						A.VL_COMMUNICATION_TIME,
						A.DT_PROCESSING,
						B.ID_PARAMETER,
						B.CD_PARAMETER,
						B.CD_CONFIGURATION,
						B.ID_ALGORITHM,
						(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
						B.ID_FUNCTION,
						(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
						(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
						(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
						B.ID_DATASET,
						B.ID_RESOURCE,
						B.ID_PARAMETER_TYPE,
						(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
						(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
						B.NR_ITERATIONS,
						B.VL_GRID_ROW_DIMENSION,
						B.VL_GRID_COLUMN_DIMENSION,
						B.VL_BLOCK_ROW_DIMENSION,
						B.VL_BLOCK_COLUMN_DIMENSION,
						B.VL_BLOCK_MEMORY_SIZE,
						B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
						B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
						C.DS_RESOURCE,
						C.NR_NODES,
						C.NR_COMPUTING_UNITS_CPU,
						C.NR_COMPUTING_UNITS_GPU,
						C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
						C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
						D.DS_DATASET,
						D.VL_DATASET_MEMORY_SIZE,
						D.DS_DATA_TYPE,
						D.VL_DATA_TYPE_MEMORY_SIZE,
						D.VL_DATASET_DIMENSION,
						D.VL_DATASET_ROW_DIMENSION,
						D.VL_DATASET_COLUMN_DIMENSION,
						D.NR_RANDOM_STATE
					FROM EXPERIMENT A
					INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
					INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
					INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
					WHERE
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
				)
		SELECT DISTINCT T_CPU.CD_PARAMETER
		FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
		--WHERE
		--T_CPU.VL_TOTAL_EXECUTION_TIME is not null --EXPERIMENTS OK
		--T_CPU.VL_TOTAL_EXECUTION_TIME is null --FAILED EXPERIMENTS
		--AND T_CPU.VL_TOTAL_EXECUTION_TIME < T_GPU.VL_TOTAL_EXECUTION_TIME
		--AND T_CPU.VL_INTER_TASK_EXECUTION_TIME < T_GPU.VL_INTER_TASK_EXECUTION_TIME
		--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
		--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
	)
) SBQ
--WHERE
--SBQ.VL_DATASET_MEMORY_SIZE = 400
--AND SBQ.DS_DATASET = 'S_A_1'
--AND SBQ.DS_PARAMETER_TYPE = 'VAR_BLOCK_CAPACITY_SIZE'
--AND SBQ.DS_PARAMETER_TYPE = 'VAR_PARALLELISM_LEVEL'



-- MODE 10.2: EVALUATE CASES WHERE CPUs HAVE A LOWER LATENCY THAN GPUs (GROUPED)
SELECT
--SBQ.VL_DATASET_MEMORY_SIZE,
--SBQ.DS_DATASET,
--SBQ.DS_PARAMETER_TYPE,
SBQ.DS_PARAMETER_ATTRIBUTE,
COUNT(SBQ.ID_EXPERIMENT)
FROM
(
	SELECT
		A.ID_EXPERIMENT,
		A.VL_TOTAL_EXECUTION_TIME,
		A.VL_INTER_TASK_EXECUTION_TIME,
		A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		A.VL_COMMUNICATION_TIME,
		A.DT_PROCESSING,
		B.ID_PARAMETER,
		B.CD_PARAMETER,
		B.CD_CONFIGURATION,
		B.ID_ALGORITHM,
		(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
		B.ID_FUNCTION,
		(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
		(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
		(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
		B.ID_DATASET,
		B.ID_RESOURCE,
		B.ID_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
		B.NR_ITERATIONS,
		B.VL_GRID_ROW_DIMENSION,
		B.VL_GRID_COLUMN_DIMENSION,
		B.VL_BLOCK_ROW_DIMENSION,
		B.VL_BLOCK_COLUMN_DIMENSION,
		B.VL_BLOCK_MEMORY_SIZE,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		C.DS_RESOURCE,
		C.NR_NODES,
		C.NR_COMPUTING_UNITS_CPU,
		C.NR_COMPUTING_UNITS_GPU,
		C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		D.DS_DATASET,
		D.VL_DATASET_MEMORY_SIZE,
		D.DS_DATA_TYPE,
		D.VL_DATA_TYPE_MEMORY_SIZE,
		D.VL_DATASET_DIMENSION,
		D.VL_DATASET_ROW_DIMENSION,
		D.VL_DATASET_COLUMN_DIMENSION,
		D.NR_RANDOM_STATE
	FROM EXPERIMENT A
	INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
	INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
	INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
	WHERE
	(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'KMEANS' -- FIXED VALUE
	AND B.NR_ITERATIONS = 5 -- FIXED VALUE
	AND C.DS_RESOURCE = 'MINOTAURO_1' -- FIXED VALUE
	--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_BLOCK_CAPACITY_SIZE' -- 1.1, 1.2, 1.3, 1.4
	--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_PARALLELISM_LEVEL' -- 2.1, 2.2
	--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.25' -- 1.1
	--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.50' -- 1.2
	--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.75' -- 1.3
	--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '1.00' -- 1.4
	--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'MIN_INTER_MAX_INTRA'--2.1
	--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'MAX_INTER_MIN_INTRA'--2.2
	AND
	B.CD_PARAMETER IN
	(
		WITH T_CPU AS (
						SELECT
						A.ID_EXPERIMENT,
						A.VL_TOTAL_EXECUTION_TIME,
						A.VL_INTER_TASK_EXECUTION_TIME,
						A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
						A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
						A.VL_COMMUNICATION_TIME,
						A.DT_PROCESSING,
						B.ID_PARAMETER,
						B.CD_PARAMETER,
						B.CD_CONFIGURATION,
						B.ID_ALGORITHM,
						(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
						B.ID_FUNCTION,
						(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
						(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
						(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
						B.ID_DATASET,
						B.ID_RESOURCE,
						B.ID_PARAMETER_TYPE,
						(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
						(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
						B.NR_ITERATIONS,
						B.VL_GRID_ROW_DIMENSION,
						B.VL_GRID_COLUMN_DIMENSION,
						B.VL_BLOCK_ROW_DIMENSION,
						B.VL_BLOCK_COLUMN_DIMENSION,
						B.VL_BLOCK_MEMORY_SIZE,
						B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
						B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
						C.DS_RESOURCE,
						C.NR_NODES,
						C.NR_COMPUTING_UNITS_CPU,
						C.NR_COMPUTING_UNITS_GPU,
						C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
						C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
						D.DS_DATASET,
						D.VL_DATASET_MEMORY_SIZE,
						D.DS_DATA_TYPE,
						D.VL_DATA_TYPE_MEMORY_SIZE,
						D.VL_DATASET_DIMENSION,
						D.VL_DATASET_ROW_DIMENSION,
						D.VL_DATASET_COLUMN_DIMENSION,
						D.NR_RANDOM_STATE
					FROM EXPERIMENT A
					INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
					INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
					INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
					WHERE
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
				),
		T_GPU AS (
						SELECT
						A.ID_EXPERIMENT,
						A.VL_TOTAL_EXECUTION_TIME,
						A.VL_INTER_TASK_EXECUTION_TIME,
						A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
						A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
						A.VL_COMMUNICATION_TIME,
						A.DT_PROCESSING,
						B.ID_PARAMETER,
						B.CD_PARAMETER,
						B.CD_CONFIGURATION,
						B.ID_ALGORITHM,
						(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
						B.ID_FUNCTION,
						(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
						(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
						(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
						B.ID_DATASET,
						B.ID_RESOURCE,
						B.ID_PARAMETER_TYPE,
						(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
						(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
						B.NR_ITERATIONS,
						B.VL_GRID_ROW_DIMENSION,
						B.VL_GRID_COLUMN_DIMENSION,
						B.VL_BLOCK_ROW_DIMENSION,
						B.VL_BLOCK_COLUMN_DIMENSION,
						B.VL_BLOCK_MEMORY_SIZE,
						B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
						B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
						C.DS_RESOURCE,
						C.NR_NODES,
						C.NR_COMPUTING_UNITS_CPU,
						C.NR_COMPUTING_UNITS_GPU,
						C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
						C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
						D.DS_DATASET,
						D.VL_DATASET_MEMORY_SIZE,
						D.DS_DATA_TYPE,
						D.VL_DATA_TYPE_MEMORY_SIZE,
						D.VL_DATASET_DIMENSION,
						D.VL_DATASET_ROW_DIMENSION,
						D.VL_DATASET_COLUMN_DIMENSION,
						D.NR_RANDOM_STATE
					FROM EXPERIMENT A
					INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
					INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
					INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
					WHERE
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
				)
		SELECT DISTINCT T_CPU.CD_PARAMETER
		FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
		--WHERE
		--T_CPU.VL_TOTAL_EXECUTION_TIME is not null --EXPERIMENTS OK
		--T_CPU.VL_TOTAL_EXECUTION_TIME is null --FAILED EXPERIMENTS
		--AND T_CPU.VL_TOTAL_EXECUTION_TIME < T_GPU.VL_TOTAL_EXECUTION_TIME
		--AND T_CPU.VL_INTER_TASK_EXECUTION_TIME < T_GPU.VL_INTER_TASK_EXECUTION_TIME
		--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC
		--AND T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC < T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
	)
) SBQ
--WHERE
--SBQ.VL_DATASET_MEMORY_SIZE = 400
--AND SBQ.DS_DATASET = 'S_A_1'
--AND SBQ.DS_PARAMETER_TYPE = 'VAR_BLOCK_CAPACITY_SIZE'
--AND SBQ.DS_PARAMETER_TYPE = 'VAR_PARALLELISM_LEVEL'
GROUP BY
--SBQ.VL_DATASET_MEMORY_SIZE
--SBQ.DS_DATASET
--SBQ.DS_PARAMETER_TYPE
SBQ.DS_PARAMETER_ATTRIBUTE
ORDER BY
COUNT(SBQ.ID_EXPERIMENT) DESC



-- EXPERIMENT QUERIES
-- MODE 12: BEHAVIOR OF DEVICES ACCORDING TO #TASKS
SELECT
--SBQ.DS_DATASET,
SBQ.DS_DEVICE,
SBQ.vl_grid_row_dimension,
AVG(SBQ.VL_TOTAL_EXECUTION_TIME) AS AVG_VL_TOTAL_EXECUTION_TIME,
AVG(SBQ.VL_INTER_TASK_EXECUTION_TIME) AS AVG_VL_INTER_TASK_EXECUTION_TIME,
AVG(SBQ.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS AVG_VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
AVG(SBQ.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS AVG_VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
AVG(SBQ.VL_COMMUNICATION_TIME) AS AVG_VL_COMMUNICATION_TIME
FROM
(
			SELECT
			A.ID_EXPERIMENT,
			A.VL_TOTAL_EXECUTION_TIME,
			A.VL_INTER_TASK_EXECUTION_TIME,
			A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			A.VL_COMMUNICATION_TIME,
			A.DT_PROCESSING,
			B.ID_PARAMETER,
			B.CD_PARAMETER,
			B.CD_CONFIGURATION,
			B.ID_ALGORITHM,
			(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
			B.ID_FUNCTION,
			(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
			(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
			B.ID_DATASET,
			B.ID_RESOURCE,
			B.ID_PARAMETER_TYPE,
			(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
			(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
			B.NR_ITERATIONS,
			B.VL_GRID_ROW_DIMENSION,
			B.VL_GRID_COLUMN_DIMENSION,
			B.VL_BLOCK_ROW_DIMENSION,
			B.VL_BLOCK_COLUMN_DIMENSION,
			B.VL_BLOCK_MEMORY_SIZE,
			B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			C.DS_RESOURCE,
			C.NR_NODES,
			C.NR_COMPUTING_UNITS_CPU,
			C.NR_COMPUTING_UNITS_GPU,
			C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			D.DS_DATASET,
			D.VL_DATASET_MEMORY_SIZE,
			D.DS_DATA_TYPE,
			D.VL_DATA_TYPE_MEMORY_SIZE,
			D.VL_DATASET_DIMENSION,
			D.VL_DATASET_ROW_DIMENSION,
			D.VL_DATASET_COLUMN_DIMENSION,
			D.NR_RANDOM_STATE
		FROM EXPERIMENT A
		INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
		INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
		INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
		WHERE
		(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'KMEANS' -- FIXED VALUE
		AND B.NR_ITERATIONS = 5 -- FIXED VALUE
		AND C.DS_RESOURCE = 'MINOTAURO_1' -- FIXED VALUE
		--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_BLOCK_CAPACITY_SIZE' -- 1.1, 1.2, 1.3, 1.4
		--AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_PARALLELISM_LEVEL' -- 2.1, 2.2
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.25' -- 1.1
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.50' -- 1.2
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '0.75' -- 1.3
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = '1.00' -- 1.4
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'MIN_INTER_MAX_INTRA'--2.1
		--AND (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) <> 'MAX_INTER_MIN_INTRA'--2.2
		
) SBQ
GROUP BY
--SBQ.DS_DATASET,
SBQ.DS_DEVICE,
SBQ.vl_grid_row_dimension
ORDER BY
AVG(SBQ.VL_TOTAL_EXECUTION_TIME) DESC


-- MODE 17: VARYING GRID COLUMN DIMENSION FROM 1 TO THE MAXIMUM NUMBER OF CORES
SELECT
*
FROM
(
	SELECT
		A.ID_EXPERIMENT,
		A.VL_TOTAL_EXECUTION_TIME,
		A.VL_INTER_TASK_EXECUTION_TIME,
		A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		A.VL_COMMUNICATION_TIME,
		A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+A.VL_COMMUNICATION_TIME) AS ADDITIONAL_TIME,
		A.DT_PROCESSING,
		B.ID_PARAMETER,
		B.CD_PARAMETER,
		B.CD_CONFIGURATION,
		B.ID_ALGORITHM,
		(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
		B.ID_FUNCTION,
		(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
		(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
		(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
		B.ID_DATASET,
		B.ID_RESOURCE,
		B.ID_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
		B.NR_ITERATIONS,
		B.VL_GRID_ROW_DIMENSION,
		B.VL_GRID_COLUMN_DIMENSION,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		B.VL_BLOCK_ROW_DIMENSION,
		B.VL_BLOCK_COLUMN_DIMENSION,
		B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		B.VL_BLOCK_MEMORY_SIZE,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		C.DS_RESOURCE,
		C.NR_NODES,
		C.NR_COMPUTING_UNITS_CPU,
		C.NR_COMPUTING_UNITS_GPU,
		C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		D.DS_DATASET,
		D.VL_DATASET_MEMORY_SIZE,
		D.DS_DATA_TYPE,
		D.VL_DATA_TYPE_MEMORY_SIZE,
		D.VL_DATASET_DIMENSION,
		D.VL_DATASET_ROW_DIMENSION,
		D.VL_DATASET_COLUMN_DIMENSION,
		D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
		D.NR_RANDOM_STATE
	FROM EXPERIMENT A
	INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
	INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
	INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
	WHERE
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_GRID_COLUMN'

	UNION ALL

	SELECT
		A.ID_EXPERIMENT,
		A.VL_TOTAL_EXECUTION_TIME,
		A.VL_INTER_TASK_EXECUTION_TIME,
		A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		A.VL_COMMUNICATION_TIME,
		A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+A.VL_COMMUNICATION_TIME) AS ADDITIONAL_TIME,
		A.DT_PROCESSING,
		B.ID_PARAMETER,
		B.CD_PARAMETER,
		B.CD_CONFIGURATION,
		B.ID_ALGORITHM,
		(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
		B.ID_FUNCTION,
		(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
		(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
		(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
		B.ID_DATASET,
		B.ID_RESOURCE,
		B.ID_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
		(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
		B.NR_ITERATIONS,
		B.VL_GRID_ROW_DIMENSION,
		B.VL_GRID_COLUMN_DIMENSION,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		B.VL_BLOCK_ROW_DIMENSION,
		B.VL_BLOCK_COLUMN_DIMENSION,
		B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		B.VL_BLOCK_MEMORY_SIZE,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		C.DS_RESOURCE,
		C.NR_NODES,
		C.NR_COMPUTING_UNITS_CPU,
		C.NR_COMPUTING_UNITS_GPU,
		C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		D.DS_DATASET,
		D.VL_DATASET_MEMORY_SIZE,
		D.DS_DATA_TYPE,
		D.VL_DATA_TYPE_MEMORY_SIZE,
		D.VL_DATASET_DIMENSION,
		D.VL_DATASET_ROW_DIMENSION,
		D.VL_DATASET_COLUMN_DIMENSION,
		D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
		D.NR_RANDOM_STATE
	FROM EXPERIMENT A
	INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
	INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
	INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
	WHERE
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_GRID_ROW'
	AND B.VL_GRID_ROW_DIMENSION = 
	(
	SELECT MAX((R.NR_NODES-1)*R.NR_COMPUTING_UNITS_CPU) FROM RESOURCE R WHERE R.ID_RESOURCE = B.ID_RESOURCE
	)
	ORDER BY ID_PARAMETER
) Z
WHERE Z.DS_DATASET = 'S_1GB_1'






ALTER TABLE PARAMETER_TYPE ADD COLUMN BL_TRANSPOSE_MATRIX BOOLEAN;

UPDATE PARAMETER_TYPE SET BL_TRANSPOSE_MATRIX = FALSE WHERE BL_TRANSPOSE_MATRIX <> TRUE OR BL_TRANSPOSE_MATRIX IS NULL


--MATMUL
--PARAMETERS
SELECT
			A.ID_PARAMETER,
			A.CD_PARAMETER,
			A.CD_CONFIGURATION,
			A.ID_ALGORITHM,
			(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) AS DS_ALGORITHM,
			A.ID_FUNCTION,
			(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_FUNCTION,
			(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS ID_DEVICE,
			(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_DEVICE,
			A.ID_DATASET,
			A.ID_RESOURCE,
			A.ID_PARAMETER_TYPE,
			(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
			(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
			(SELECT X.DS_COMPSS_VERSION FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_COMPSS_VERSION,
			(SELECT X.DS_DISLIB_VERSION FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_DISLIB_VERSION,
			(SELECT X.DS_SCHDEULER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_SCHDEULER,
			(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS NR_CLUSTER,
			(SELECT X.BL_TRANSPOSE_MATRIX FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS BL_TRANSPOSE_MATRIX,
			A.NR_ITERATIONS,
			A.VL_GRID_ROW_DIMENSION,
			A.VL_GRID_COLUMN_DIMENSION,
			A.VL_BLOCK_ROW_DIMENSION,
			A.VL_BLOCK_COLUMN_DIMENSION,
			A.VL_BLOCK_MEMORY_SIZE,
			A.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			A.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			B.DS_RESOURCE,
			B.NR_NODES,
			B.NR_COMPUTING_UNITS_CPU,
			B.NR_COMPUTING_UNITS_GPU,
			B.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			B.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			C.DS_DATASET,
			C.VL_DATASET_MEMORY_SIZE,
			C.DS_DATA_TYPE,
			C.VL_DATA_TYPE_MEMORY_SIZE,
			C.VL_DATASET_DIMENSION,
			C.VL_DATASET_ROW_DIMENSION,
			C.VL_DATASET_COLUMN_DIMENSION,
			C.NR_RANDOM_STATE,
			C.VL_DATA_SPARSITY
		FROM PARAMETER A
		INNER JOIN RESOURCE B ON (A.ID_RESOURCE = B.ID_RESOURCE)
		INNER JOIN DATASET C ON (A.ID_DATASET = C.ID_DATASET)
		WHERE
		(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) = 'MATMUL_DISLIB'
		AND C.DS_DATASET = 'S_512MB_1'
		AND B.DS_RESOURCE = 'MINOTAURO_9_NODES_1_CORE'
		AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) = 'VAR_GRID_SHAPE_MATMUL_1'
		AND A.ID_FUNCTION IN (1,2)
		AND A.CD_CONFIGURATION IN (1,4)
		--(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) in ('VAR_GRID_ROW_5','VAR_GRID_ROW_6','VAR_GRID_ROW_7','VAR_GRID_ROW_8','VAR_GRID_ROW_9','VAR_GRID_ROW_10')
		--AND B.DS_RESOURCE = 'MINOTAURO_9_NODES_1_CORE'
		--AND C.DS_DATASET IN ('S_128MB_1','S_512MB_1','S_2GB_1','S_8GB_1','S_32GB_1')
		--A.ID_PARAMETER_TYPE >= 11
		ORDER BY A.ID_PARAMETER;

--MATMUL RESULTS (AVERAGE OF MAX)
SELECT
Y.VL_TOTAL_EXECUTION_TIME,
Y.VL_INTER_TASK_EXECUTION_TIME,
(Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
Y.VL_COMMUNICATION_TIME,
Y.VL_ADDITIONAL_TIME,
(Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
Y.VL_STD_TOTAL_EXECUTION_TIME,
Y.VL_STD_INTER_TASK_EXECUTION_TIME,
Y.VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
Y.VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
Y.VL_STD_COMMUNICATION_TIME,
Y.ID_PARAMETER,
Y.CD_PARAMETER,
Y.CD_CONFIGURATION,
Y.ID_ALGORITHM,
Y.DS_ALGORITHM,
Y.ID_FUNCTION,
Y.DS_FUNCTION,
Y.ID_DEVICE,
Y.DS_DEVICE,
Y.ID_DATASET,
Y.ID_RESOURCE,
Y.ID_PARAMETER_TYPE,
Y.DS_PARAMETER_TYPE,
Y.DS_PARAMETER_ATTRIBUTE,
Y.NR_ITERATIONS,
Y.VL_GRID_ROW_DIMENSION,
Y.VL_GRID_COLUMN_DIMENSION,
Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
Y.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
Y.VL_BLOCK_ROW_DIMENSION,
Y.VL_BLOCK_COLUMN_DIMENSION,
Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
Y.VL_BLOCK_MEMORY_SIZE,
Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
Y.DS_RESOURCE,
Y.NR_NODES,
Y.NR_COMPUTING_UNITS_CPU,
(Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
(Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
Y.NR_COMPUTING_UNITS_GPU,
Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
Y.DS_DATASET,
Y.VL_DATASET_MEMORY_SIZE,
Y.DS_DATA_TYPE,
Y.VL_DATA_TYPE_MEMORY_SIZE,
Y.VL_DATASET_DIMENSION,
Y.VL_DATASET_ROW_DIMENSION,
Y.VL_DATASET_COLUMN_DIMENSION,
Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
Y.NR_RANDOM_STATE
FROM
(
	SELECT
		AVG(W.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
		AVG(W.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
		AVG(W.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		AVG(W.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		AVG(W.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
		AVG(W.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
		AVG(W.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
		AVG(W.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
		AVG(W.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
		AVG(W.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
		STDDEV(W.VL_TOTAL_EXECUTION_TIME) AS VL_STD_TOTAL_EXECUTION_TIME,
		STDDEV(W.VL_INTER_TASK_EXECUTION_TIME) AS VL_STD_INTER_TASK_EXECUTION_TIME,
		STDDEV(W.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
		STDDEV(W.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
		STDDEV(W.VL_COMMUNICATION_TIME) AS VL_STD_COMMUNICATION_TIME,
		W.ID_PARAMETER,
		W.CD_PARAMETER,
		W.CD_CONFIGURATION,
		W.ID_ALGORITHM,
		W.DS_ALGORITHM,
		W.ID_FUNCTION,
		W.DS_FUNCTION,
		W.ID_DEVICE,
		W.DS_DEVICE,
		W.ID_DATASET,
		W.ID_RESOURCE,
		W.ID_PARAMETER_TYPE,
		W.DS_PARAMETER_TYPE,
		W.DS_PARAMETER_ATTRIBUTE,
		W.NR_ITERATIONS,
		W.VL_GRID_ROW_DIMENSION,
		W.VL_GRID_COLUMN_DIMENSION,
		W.VL_GRID_ROW_X_COLUMN_DIMENSION,
		W.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
		W.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		W.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		W.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		W.VL_BLOCK_ROW_DIMENSION,
		W.VL_BLOCK_COLUMN_DIMENSION,
		W.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		W.VL_BLOCK_MEMORY_SIZE,
		W.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		W.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		W.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		W.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		W.DS_RESOURCE,
		W.NR_NODES,
		W.NR_COMPUTING_UNITS_CPU,
		W.NR_COMPUTING_UNITS_GPU,
		W.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		W.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		W.DS_DATASET,
		W.VL_DATASET_MEMORY_SIZE,
		W.DS_DATA_TYPE,
		W.VL_DATA_TYPE_MEMORY_SIZE,
		W.VL_DATASET_DIMENSION,
		W.VL_DATASET_ROW_DIMENSION,
		W.VL_DATASET_COLUMN_DIMENSION,
		W.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		W.NR_RANDOM_STATE
		FROM
		(
			SELECT
			AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
			MAX(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
			AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
			AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
			AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
			AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
			AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
			AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
			AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
			X.NR_ALGORITHM_ITERATION,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
			FROM
			(
				SELECT
					A.ID_EXPERIMENT,
					A.VL_TOTAL_EXECUTION_TIME,
					A.VL_INTER_TASK_EXECUTION_TIME,
					A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
					A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
					A.VL_COMMUNICATION_TIME_1,
					A.VL_COMMUNICATION_TIME_2,
					A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
					A.VL_ADDITIONAL_TIME_1,
					A.VL_ADDITIONAL_TIME_2,
					A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
					(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
					A.NR_ALGORITHM_ITERATION,
					A.DT_PROCESSING,
					B.ID_PARAMETER,
					B.CD_PARAMETER,
					B.CD_CONFIGURATION,
					B.ID_ALGORITHM,
					(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
					B.ID_FUNCTION,
					(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
					(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
					(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
					B.ID_DATASET,
					B.ID_RESOURCE,
					B.ID_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
					(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
					B.NR_ITERATIONS,
					B.VL_GRID_ROW_DIMENSION,
					B.VL_GRID_COLUMN_DIMENSION,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
					CASE
						WHEN (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'MATMUL_FUNC' THEN B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')'
						WHEN (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'ADD_FUNC' THEN B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*(B.VL_GRID_COLUMN_DIMENSION-1) || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')'
						ELSE NULL
					END AS VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
					ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
					B.VL_BLOCK_ROW_DIMENSION,
					B.VL_BLOCK_COLUMN_DIMENSION,
					B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
					B.VL_BLOCK_MEMORY_SIZE,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
					B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
					ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
					C.DS_RESOURCE,
					C.NR_NODES,
					C.NR_COMPUTING_UNITS_CPU,
					C.NR_COMPUTING_UNITS_GPU,
					C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
					C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
					D.DS_DATASET,
					D.VL_DATASET_MEMORY_SIZE,
					D.DS_DATA_TYPE,
					D.VL_DATA_TYPE_MEMORY_SIZE,
					D.VL_DATASET_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION,
					D.VL_DATASET_COLUMN_DIMENSION,
					D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
					D.NR_RANDOM_STATE
				FROM EXPERIMENT_RAW A
				INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
				INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
				INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
				WHERE
                A.NR_ALGORITHM_ITERATION <> 0
			) X
			GROUP BY
			X.NR_ALGORITHM_ITERATION,
			X.ID_PARAMETER,
			X.CD_PARAMETER,
			X.CD_CONFIGURATION,
			X.ID_ALGORITHM,
			X.DS_ALGORITHM,
			X.ID_FUNCTION,
			X.DS_FUNCTION,
			X.ID_DEVICE,
			X.DS_DEVICE,
			X.ID_DATASET,
			X.ID_RESOURCE,
			X.ID_PARAMETER_TYPE,
			X.DS_PARAMETER_TYPE,
			X.DS_PARAMETER_ATTRIBUTE,
			X.NR_ITERATIONS,
			X.VL_GRID_ROW_DIMENSION,
			X.VL_GRID_COLUMN_DIMENSION,
			X.VL_GRID_ROW_X_COLUMN_DIMENSION,
			X.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
			X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
			X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
			X.VL_BLOCK_ROW_DIMENSION,
			X.VL_BLOCK_COLUMN_DIMENSION,
			X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
			X.VL_BLOCK_MEMORY_SIZE,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
			X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
			X.DS_RESOURCE,
			X.NR_NODES,
			X.NR_COMPUTING_UNITS_CPU,
			X.NR_COMPUTING_UNITS_GPU,
			X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
			X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
			X.DS_DATASET,
			X.VL_DATASET_MEMORY_SIZE,
			X.DS_DATA_TYPE,
			X.VL_DATA_TYPE_MEMORY_SIZE,
			X.VL_DATASET_DIMENSION,
			X.VL_DATASET_ROW_DIMENSION,
			X.VL_DATASET_COLUMN_DIMENSION,
			X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
			X.NR_RANDOM_STATE
		) W
		GROUP BY
		W.ID_PARAMETER,
		W.CD_PARAMETER,
		W.CD_CONFIGURATION,
		W.ID_ALGORITHM,
		W.DS_ALGORITHM,
		W.ID_FUNCTION,
		W.DS_FUNCTION,
		W.ID_DEVICE,
		W.DS_DEVICE,
		W.ID_DATASET,
		W.ID_RESOURCE,
		W.ID_PARAMETER_TYPE,
		W.DS_PARAMETER_TYPE,
		W.DS_PARAMETER_ATTRIBUTE,
		W.NR_ITERATIONS,
		W.VL_GRID_ROW_DIMENSION,
		W.VL_GRID_COLUMN_DIMENSION,
		W.VL_GRID_ROW_X_COLUMN_DIMENSION,
		W.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
		W.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
		W.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		W.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
		W.VL_BLOCK_ROW_DIMENSION,
		W.VL_BLOCK_COLUMN_DIMENSION,
		W.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
		W.VL_BLOCK_MEMORY_SIZE,
		W.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
		W.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
		W.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		W.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
		W.DS_RESOURCE,
		W.NR_NODES,
		W.NR_COMPUTING_UNITS_CPU,
		W.NR_COMPUTING_UNITS_GPU,
		W.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
		W.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
		W.DS_DATASET,
		W.VL_DATASET_MEMORY_SIZE,
		W.DS_DATA_TYPE,
		W.VL_DATA_TYPE_MEMORY_SIZE,
		W.VL_DATASET_DIMENSION,
		W.VL_DATASET_ROW_DIMENSION,
		W.VL_DATASET_COLUMN_DIMENSION,
		W.VL_DATASET_ROW_X_COLUMN_DIMENSION,
		W.NR_RANDOM_STATE
) Y
WHERE
Y.DS_DATASET = 'S_512MB_1'
AND Y.DS_PARAMETER_TYPE = 'VAR_GRID_SHAPE_MATMUL_1'
AND Y.DS_FUNCTION = 'MATMUL_FUNC'
ORDER BY ID_PARAMETER;
	


--MATMUL RESULTS (ONLY AVERAGE)
SELECT
                        Y.VL_TOTAL_EXECUTION_TIME,
                        Y.VL_INTER_TASK_EXECUTION_TIME,
                        (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
                        Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
                        Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                        Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                        Y.VL_COMMUNICATION_TIME,
                        Y.VL_ADDITIONAL_TIME,
                        (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                        Y.VL_STD_TOTAL_EXECUTION_TIME,
                        Y.VL_STD_INTER_TASK_EXECUTION_TIME,
                        Y.VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                        Y.VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                        Y.VL_STD_COMMUNICATION_TIME,
                        Y.ID_PARAMETER,
                        Y.CD_PARAMETER,
                        Y.CD_CONFIGURATION,
                        Y.ID_ALGORITHM,
                        Y.DS_ALGORITHM,
                        Y.ID_FUNCTION,
                        Y.DS_FUNCTION,
                        Y.ID_DEVICE,
                        Y.DS_DEVICE,
                        Y.ID_DATASET,
                        Y.ID_RESOURCE,
                        Y.ID_PARAMETER_TYPE,
                        Y.DS_PARAMETER_TYPE,
                        Y.DS_PARAMETER_ATTRIBUTE,
                        Y.NR_ITERATIONS,
                        Y.VL_GRID_ROW_DIMENSION,
                        Y.VL_GRID_COLUMN_DIMENSION,
                        Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
                        Y.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
                        Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                        Y.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                        Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                        Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                        Y.VL_BLOCK_ROW_DIMENSION,
                        Y.VL_BLOCK_COLUMN_DIMENSION,
                        Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                        Y.VL_BLOCK_MEMORY_SIZE,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                        Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                        Y.DS_RESOURCE,
                        Y.NR_NODES,
                        Y.NR_COMPUTING_UNITS_CPU,
                        (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
                        (Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
                        Y.NR_COMPUTING_UNITS_GPU,
                        Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                        Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                        Y.DS_DATASET,
                        Y.VL_DATASET_MEMORY_SIZE,
                        Y.DS_DATA_TYPE,
                        Y.VL_DATA_TYPE_MEMORY_SIZE,
                        Y.VL_DATASET_DIMENSION,
                        Y.VL_DATASET_ROW_DIMENSION,
                        Y.VL_DATASET_COLUMN_DIMENSION,
                        Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                        Y.NR_RANDOM_STATE,
                        Y.VL_DATA_SPARSITY,
                        CASE
                            WHEN Y.DS_DEVICE = 'CPU' AND Y.VL_DATA_SPARSITY = 0 THEN 'CPU dense'
                            WHEN Y.DS_DEVICE = 'CPU' AND Y.VL_DATA_SPARSITY = 1 THEN 'CPU sparse'
                            WHEN Y.DS_DEVICE = 'GPU' AND Y.VL_DATA_SPARSITY = 0 THEN 'GPU dense'
                            WHEN Y.DS_DEVICE = 'GPU' AND Y.VL_DATA_SPARSITY = 1 THEN 'GPU sparse'
                            ELSE ''
                        END AS DEVICE_SPARSITY
                        FROM
                        (
                            SELECT
                                AVG(W.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                                AVG(W.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
                                AVG(W.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                AVG(W.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                AVG(W.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                                AVG(W.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                                AVG(W.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                                AVG(W.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                                AVG(W.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                                AVG(W.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                                STDDEV(W.VL_TOTAL_EXECUTION_TIME) AS VL_STD_TOTAL_EXECUTION_TIME,
                                STDDEV(W.VL_INTER_TASK_EXECUTION_TIME) AS VL_STD_INTER_TASK_EXECUTION_TIME,
                                STDDEV(W.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                STDDEV(W.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                STDDEV(W.VL_COMMUNICATION_TIME) AS VL_STD_COMMUNICATION_TIME,
                                W.ID_PARAMETER,
                                W.CD_PARAMETER,
                                W.CD_CONFIGURATION,
                                W.ID_ALGORITHM,
                                W.DS_ALGORITHM,
                                W.ID_FUNCTION,
                                W.DS_FUNCTION,
                                W.ID_DEVICE,
                                W.DS_DEVICE,
                                W.ID_DATASET,
                                W.ID_RESOURCE,
                                W.ID_PARAMETER_TYPE,
                                W.DS_PARAMETER_TYPE,
                                W.DS_PARAMETER_ATTRIBUTE,
                                W.NR_ITERATIONS,
                                W.VL_GRID_ROW_DIMENSION,
                                W.VL_GRID_COLUMN_DIMENSION,
                                W.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                W.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
                                W.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                                W.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                                W.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                W.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                W.VL_BLOCK_ROW_DIMENSION,
                                W.VL_BLOCK_COLUMN_DIMENSION,
                                W.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                W.VL_BLOCK_MEMORY_SIZE,
                                W.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                W.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                W.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                W.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                W.DS_RESOURCE,
                                W.NR_NODES,
                                W.NR_COMPUTING_UNITS_CPU,
                                W.NR_COMPUTING_UNITS_GPU,
                                W.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                W.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                W.DS_DATASET,
                                W.VL_DATASET_MEMORY_SIZE,
                                W.DS_DATA_TYPE,
                                W.VL_DATA_TYPE_MEMORY_SIZE,
                                W.VL_DATASET_DIMENSION,
                                W.VL_DATASET_ROW_DIMENSION,
                                W.VL_DATASET_COLUMN_DIMENSION,
                                W.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                W.NR_RANDOM_STATE,
                                W.VL_DATA_SPARSITY
                                FROM
                                (
                                    SELECT
                                    AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                                    MAX(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
                                    AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                                    AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                                    AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                                    AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                                    AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                                    AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                                    X.NR_ALGORITHM_ITERATION,
                                    X.ID_PARAMETER,
                                    X.CD_PARAMETER,
                                    X.CD_CONFIGURATION,
                                    X.ID_ALGORITHM,
                                    X.DS_ALGORITHM,
                                    X.ID_FUNCTION,
                                    X.DS_FUNCTION,
                                    X.ID_DEVICE,
                                    X.DS_DEVICE,
                                    X.ID_DATASET,
                                    X.ID_RESOURCE,
                                    X.ID_PARAMETER_TYPE,
                                    X.DS_PARAMETER_TYPE,
                                    X.DS_PARAMETER_ATTRIBUTE,
                                    X.NR_ITERATIONS,
                                    X.VL_GRID_ROW_DIMENSION,
                                    X.VL_GRID_COLUMN_DIMENSION,
                                    X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                    X.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
                                    X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                                    X.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                                    X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    X.VL_BLOCK_ROW_DIMENSION,
                                    X.VL_BLOCK_COLUMN_DIMENSION,
                                    X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                    X.VL_BLOCK_MEMORY_SIZE,
                                    X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    X.DS_RESOURCE,
                                    X.NR_NODES,
                                    X.NR_COMPUTING_UNITS_CPU,
                                    X.NR_COMPUTING_UNITS_GPU,
                                    X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    X.DS_DATASET,
                                    X.VL_DATASET_MEMORY_SIZE,
                                    X.DS_DATA_TYPE,
                                    X.VL_DATA_TYPE_MEMORY_SIZE,
                                    X.VL_DATASET_DIMENSION,
                                    X.VL_DATASET_ROW_DIMENSION,
                                    X.VL_DATASET_COLUMN_DIMENSION,
                                    X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                    X.NR_RANDOM_STATE,
                                    X.VL_DATA_SPARSITY
                                    FROM
                                    (
                                        SELECT
                                            A.ID_EXPERIMENT,
                                            A.VL_TOTAL_EXECUTION_TIME,
                                            A.VL_INTER_TASK_EXECUTION_TIME,
                                            A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                            A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                            A.VL_COMMUNICATION_TIME_1,
                                            A.VL_COMMUNICATION_TIME_2,
                                            A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                            A.VL_ADDITIONAL_TIME_1,
                                            A.VL_ADDITIONAL_TIME_2,
                                            A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                            (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                            A.NR_ALGORITHM_ITERATION,
                                            A.DT_PROCESSING,
                                            B.ID_PARAMETER,
                                            B.CD_PARAMETER,
                                            B.CD_CONFIGURATION,
                                            B.ID_ALGORITHM,
                                            (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                            B.ID_FUNCTION,
                                            (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                            (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                            (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                            B.ID_DATASET,
                                            B.ID_RESOURCE,
                                            B.ID_PARAMETER_TYPE,
                                            (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                            (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                            B.NR_ITERATIONS,
                                            B.VL_GRID_ROW_DIMENSION,
                                            B.VL_GRID_COLUMN_DIMENSION,
                                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                                            CASE
                                                WHEN (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'MATMUL_FUNC' THEN B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')'
                                                WHEN (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'ADD_FUNC' THEN B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*(B.VL_GRID_COLUMN_DIMENSION-1) || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')'
                                                ELSE NULL
                                            END AS VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
                                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                                            ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                                            ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                            B.VL_BLOCK_ROW_DIMENSION,
                                            B.VL_BLOCK_COLUMN_DIMENSION,
                                            B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                            B.VL_BLOCK_MEMORY_SIZE,
                                            B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                            B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                            ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                            ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                            C.DS_RESOURCE,
                                            C.NR_NODES,
                                            C.NR_COMPUTING_UNITS_CPU,
                                            C.NR_COMPUTING_UNITS_GPU,
                                            C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                            C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                            D.DS_DATASET,
                                            D.VL_DATASET_MEMORY_SIZE,
                                            D.DS_DATA_TYPE,
                                            D.VL_DATA_TYPE_MEMORY_SIZE,
                                            D.VL_DATASET_DIMENSION,
                                            D.VL_DATASET_ROW_DIMENSION,
                                            D.VL_DATASET_COLUMN_DIMENSION,
                                            D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                            D.NR_RANDOM_STATE,
                                            D.VL_DATA_SPARSITY
                                        FROM EXPERIMENT_RAW A
                                        INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                        INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                        INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                        WHERE
                                        A.NR_ALGORITHM_ITERATION <> 0
                                    ) X
                                    GROUP BY
                                    X.NR_ALGORITHM_ITERATION,
                                    X.ID_PARAMETER,
                                    X.CD_PARAMETER,
                                    X.CD_CONFIGURATION,
                                    X.ID_ALGORITHM,
                                    X.DS_ALGORITHM,
                                    X.ID_FUNCTION,
                                    X.DS_FUNCTION,
                                    X.ID_DEVICE,
                                    X.DS_DEVICE,
                                    X.ID_DATASET,
                                    X.ID_RESOURCE,
                                    X.ID_PARAMETER_TYPE,
                                    X.DS_PARAMETER_TYPE,
                                    X.DS_PARAMETER_ATTRIBUTE,
                                    X.NR_ITERATIONS,
                                    X.VL_GRID_ROW_DIMENSION,
                                    X.VL_GRID_COLUMN_DIMENSION,
                                    X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                    X.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
                                    X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                                    X.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                                    X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    X.VL_BLOCK_ROW_DIMENSION,
                                    X.VL_BLOCK_COLUMN_DIMENSION,
                                    X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                    X.VL_BLOCK_MEMORY_SIZE,
                                    X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    X.DS_RESOURCE,
                                    X.NR_NODES,
                                    X.NR_COMPUTING_UNITS_CPU,
                                    X.NR_COMPUTING_UNITS_GPU,
                                    X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    X.DS_DATASET,
                                    X.VL_DATASET_MEMORY_SIZE,
                                    X.DS_DATA_TYPE,
                                    X.VL_DATA_TYPE_MEMORY_SIZE,
                                    X.VL_DATASET_DIMENSION,
                                    X.VL_DATASET_ROW_DIMENSION,
                                    X.VL_DATASET_COLUMN_DIMENSION,
                                    X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                    X.NR_RANDOM_STATE,
                                    X.VL_DATA_SPARSITY
                                ) W
                                GROUP BY
                                W.ID_PARAMETER,
                                W.CD_PARAMETER,
                                W.CD_CONFIGURATION,
                                W.ID_ALGORITHM,
                                W.DS_ALGORITHM,
                                W.ID_FUNCTION,
                                W.DS_FUNCTION,
                                W.ID_DEVICE,
                                W.DS_DEVICE,
                                W.ID_DATASET,
                                W.ID_RESOURCE,
                                W.ID_PARAMETER_TYPE,
                                W.DS_PARAMETER_TYPE,
                                W.DS_PARAMETER_ATTRIBUTE,
                                W.NR_ITERATIONS,
                                W.VL_GRID_ROW_DIMENSION,
                                W.VL_GRID_COLUMN_DIMENSION,
                                W.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                W.VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
                                W.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                                W.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                                W.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                W.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                W.VL_BLOCK_ROW_DIMENSION,
                                W.VL_BLOCK_COLUMN_DIMENSION,
                                W.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                W.VL_BLOCK_MEMORY_SIZE,
                                W.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                W.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                W.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                W.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                W.DS_RESOURCE,
                                W.NR_NODES,
                                W.NR_COMPUTING_UNITS_CPU,
                                W.NR_COMPUTING_UNITS_GPU,
                                W.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                W.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                W.DS_DATASET,
                                W.VL_DATASET_MEMORY_SIZE,
                                W.DS_DATA_TYPE,
                                W.VL_DATA_TYPE_MEMORY_SIZE,
                                W.VL_DATASET_DIMENSION,
                                W.VL_DATASET_ROW_DIMENSION,
                                W.VL_DATASET_COLUMN_DIMENSION,
                                W.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                W.NR_RANDOM_STATE,
                                W.VL_DATA_SPARSITY
                        ) Y
	WHERE
	Y.DS_DATASET = 'S_128MB_1'
	AND Y.DS_PARAMETER_TYPE = 'VAR_GRID_SHAPE_MATMUL_1'
	AND Y.DS_FUNCTION = 'MATMUL_FUNC'
	ORDER BY ID_PARAMETER;



select * from parameter where vl_grid_row_dimension = 1 and id_dataset = 1 and id_parameter_type = 1 order by id_parameter

--PARAMETER_TYPE NOT USED IN EXPERMENT AND EXPERIMENT_RAW
select * from parameter_type
where
id_parameter_type
not in
(
select distinct b.id_parameter_type from experiment_raw a inner join parameter b on (a.id_parameter = b.id_parameter)
union
select distinct b.id_parameter_type from experiment a inner join parameter b on (a.id_parameter = b.id_parameter)
--order by id_parameter_type
)


--EXPERIMENTS WITH LESS THAN 6 EXECUTIONS DUE TO BROKEN PIPE EXCEPTION (MATMUL, LOCAL DISK, S_8GB_1)
SELECT
	A.ID_PARAMETER,
	A.CD_PARAMETER,
	A.CD_CONFIGURATION,
	A.ID_ALGORITHM,
	(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = A.ID_ALGORITHM) AS DS_ALGORITHM,
	A.ID_FUNCTION,
	(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_FUNCTION,
	(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS ID_DEVICE,
	(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = A.ID_FUNCTION) AS DS_DEVICE,
	A.ID_DATASET,
	A.ID_RESOURCE,
	A.ID_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
	(SELECT X.DS_COMPSS_VERSION FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_COMPSS_VERSION,
	(SELECT X.DS_DISLIB_VERSION FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_DISLIB_VERSION,
	(SELECT X.DS_SCHDEULER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS DS_SCHDEULER,
	(SELECT X.NR_CLUSTER FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = A.ID_PARAMETER_TYPE) AS NR_CLUSTER,
	A.NR_ITERATIONS,
	A.VL_GRID_ROW_DIMENSION,
	A.VL_GRID_COLUMN_DIMENSION,
	A.VL_BLOCK_ROW_DIMENSION,
	A.VL_BLOCK_COLUMN_DIMENSION,
	A.VL_BLOCK_MEMORY_SIZE,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	A.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	B.DS_RESOURCE,
	B.NR_NODES,
	B.NR_COMPUTING_UNITS_CPU,
	B.NR_COMPUTING_UNITS_GPU,
	B.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	B.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	C.DS_DATASET,
	C.VL_DATASET_MEMORY_SIZE,
	C.DS_DATA_TYPE,
	C.VL_DATA_TYPE_MEMORY_SIZE,
	C.VL_DATASET_DIMENSION,
	C.VL_DATASET_ROW_DIMENSION,
	C.VL_DATASET_COLUMN_DIMENSION,
	C.NR_RANDOM_STATE
FROM PARAMETER A
INNER JOIN RESOURCE B ON (A.ID_RESOURCE = B.ID_RESOURCE)
INNER JOIN DATASET C ON (A.ID_DATASET = C.ID_DATASET)
WHERE A.ID_PARAMETER IN
(
	SELECT X.ID_PARAMETER
	FROM
	(
		SELECT ID_PARAMETER, COUNT(DISTINCT NR_ALGORITHM_ITERATION)
		FROM EXPERIMENT_RAW
		GROUP BY
		ID_PARAMETER
		HAVING
		COUNT(DISTINCT NR_ALGORITHM_ITERATION) <> 6
	) X
)

-- EXPERIMENTS WITH HIGH VALUES IN MATMUL WITH LOCAL DISK (ANOMALIES IN THE EXECUTION ENVIRONMENT IN THE END OF MARCH 2023 - MULTIPLE EXCEPTIONS WHEN RUNNING EXPERIMENTS)
SELECT
	A.ID_EXPERIMENT,
	A.VL_TOTAL_EXECUTION_TIME,
	A.VL_INTER_TASK_EXECUTION_TIME,
	A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
	A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
	A.VL_COMMUNICATION_TIME_1,
	A.VL_COMMUNICATION_TIME_2,
	A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
	A.VL_ADDITIONAL_TIME_1,
	A.VL_ADDITIONAL_TIME_2,
	A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
	(A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
	A.NR_ALGORITHM_ITERATION,
	A.DT_PROCESSING,
	B.ID_PARAMETER,
	B.CD_PARAMETER,
	B.CD_CONFIGURATION,
	B.ID_ALGORITHM,
	(SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
	B.ID_FUNCTION,
	(SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
	(SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
	(SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
	B.ID_DATASET,
	B.ID_RESOURCE,
	B.ID_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
	(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
	B.NR_ITERATIONS,
	B.VL_GRID_ROW_DIMENSION,
	B.VL_GRID_COLUMN_DIMENSION,
	B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
	CASE
		WHEN (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'MATMUL_FUNC' THEN B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')'
		WHEN (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'ADD_FUNC' THEN B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*(B.VL_GRID_COLUMN_DIMENSION-1) || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')'
		ELSE NULL
	END AS VL_CONCAT_NR_TASK_BLOCK_SIZE_MB,
	B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
	ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
	ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
	B.VL_BLOCK_ROW_DIMENSION,
	B.VL_BLOCK_COLUMN_DIMENSION,
	B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
	B.VL_BLOCK_MEMORY_SIZE,
	B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
	B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
	ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
	C.DS_RESOURCE,
	C.NR_NODES,
	C.NR_COMPUTING_UNITS_CPU,
	C.NR_COMPUTING_UNITS_GPU,
	C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
	C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
	D.DS_DATASET,
	D.VL_DATASET_MEMORY_SIZE,
	D.DS_DATA_TYPE,
	D.VL_DATA_TYPE_MEMORY_SIZE,
	D.VL_DATASET_DIMENSION,
	D.VL_DATASET_ROW_DIMENSION,
	D.VL_DATASET_COLUMN_DIMENSION,
	D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
	D.NR_RANDOM_STATE,
	D.VL_DATA_SPARSITY
FROM EXPERIMENT_RAW A
INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
INNER JOIN ALGORITHM E ON (B.ID_ALGORITHM = E.ID_ALGORITHM)
WHERE
A.NR_ALGORITHM_ITERATION <> 0
AND E.DS_ALGORITHM = 'MATMUL_DISLIB'
AND B.NR_ITERATIONS = 5
AND C.DS_RESOURCE = 'MINOTAURO_9_NODES_1_CORE'
AND D.DS_DATASET = 'S_8GB_1'
AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_GRID_SHAPE_MATMUL_2'
AND (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'MATMUL_FUNC'
AND B.VL_BLOCK_ROW_DIMENSION = 16000
AND (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
AND A.VL_TOTAL_EXECUTION_TIME IS NOT NULL



-- AVERAGE PARALLEL FRACTION
SELECT
DS_DEVICE,
AVG(P_FRACTION) AS P_FRACTION,
AVG(1-P_FRACTION) AS S_FRACTION
--DISTINCT ZZ.ds_dataset, ZZ.DS_PARAMETER_TYPE, ZZ.DS_RESOURCE
FROM
(
SELECT
                            A.VL_TOTAL_EXECUTION_TIME,
                            A.VL_INTER_TASK_EXECUTION_TIME,
                            (A.VL_INTER_TASK_EXECUTION_TIME - A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
                            A.VL_INTER_TASK_EXECUTION_TIME - (A.VL_INTER_TASK_EXECUTION_TIME - A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
                            A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                            A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                            A.VL_COMMUNICATION_TIME,
                            A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+A.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
                            (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
							NULL AS VL_STD_TOTAL_EXECUTION_TIME,
                            NULL AS VL_STD_INTER_TASK_EXECUTION_TIME,
                            NULL AS VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                            NULL AS VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                            NULL AS VL_STD_COMMUNICATION_TIME,
                            ROUND(((A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)/(A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC-A.VL_COMMUNICATION_TIME))::numeric,2) AS P_FRACTION,
                            B.ID_PARAMETER,
                            B.CD_PARAMETER,
                            B.CD_CONFIGURATION,
                            B.ID_ALGORITHM,
                            (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                            B.ID_FUNCTION,
                            (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                            (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                            (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                            B.ID_DATASET,
                            B.ID_RESOURCE,
                            B.ID_PARAMETER_TYPE,
                            (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                            (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                            B.NR_ITERATIONS,
                            B.VL_GRID_ROW_DIMENSION,
                            B.VL_GRID_COLUMN_DIMENSION,
                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
							B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            ROUND(D.VL_DATASET_MEMORY_SIZE*1e-6,0) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            CASE
								WHEN (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'KMEANS'
									THEN ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION*5  || ')'
								WHEN (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'MATMUL_DISLIB'
									THEN ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION + B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*(B.VL_GRID_ROW_DIMENSION-1)  || ')'
								ELSE
									'999999999999'
							END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
							ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                            ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            B.VL_BLOCK_ROW_DIMENSION,
                            B.VL_BLOCK_COLUMN_DIMENSION,
                            B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                            ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
                            B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            C.DS_RESOURCE,
                            C.NR_NODES,
                            C.NR_COMPUTING_UNITS_CPU,
                            (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
                            (C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
                            C.NR_COMPUTING_UNITS_GPU,
                            C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            D.DS_DATASET,
                            D.VL_DATASET_MEMORY_SIZE,
                            D.DS_DATA_TYPE,
                            D.VL_DATA_TYPE_MEMORY_SIZE,
                            D.VL_DATASET_DIMENSION,
                            D.VL_DATASET_ROW_DIMENSION,
                            D.VL_DATASET_COLUMN_DIMENSION,
                            D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            D.NR_RANDOM_STATE
                        FROM EXPERIMENT A
                        INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                        INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                        INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                        WHERE
                        A.VL_TOTAL_EXECUTION_TIME is not null
                        --(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) <> 'MAX_INTER_MIN_INTRA'
                        --AND DATE_TRUNC('day', A.DT_PROCESSING) < TO_DATE('15/11/2022', 'dd/mm/yyyy')
                        
                        UNION ALL

                        -- EXPERIMENT RAW QUERY
                        SELECT
                        Y.VL_TOTAL_EXECUTION_TIME,
                        Y.VL_INTER_TASK_EXECUTION_TIME,
                        (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
                        Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
                        Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                        Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                        Y.VL_COMMUNICATION_TIME,
                        Y.VL_ADDITIONAL_TIME,
                        (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
						Y.VL_STD_TOTAL_EXECUTION_TIME,
						Y.VL_STD_INTER_TASK_EXECUTION_TIME,
						Y.VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
						Y.VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
						Y.VL_STD_COMMUNICATION_TIME,
                        ROUND(((Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)/(Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC-Y.VL_COMMUNICATION_TIME))::numeric,2) AS P_FRACTION,
						Y.ID_PARAMETER,
                        Y.CD_PARAMETER,
                        Y.CD_CONFIGURATION,
                        Y.ID_ALGORITHM,
                        Y.DS_ALGORITHM,
                        Y.ID_FUNCTION,
                        Y.DS_FUNCTION,
                        Y.ID_DEVICE,
                        Y.DS_DEVICE,
                        Y.ID_DATASET,
                        Y.ID_RESOURCE,
                        Y.ID_PARAMETER_TYPE,
                        Y.DS_PARAMETER_TYPE,
                        Y.DS_PARAMETER_ATTRIBUTE,
                        Y.NR_ITERATIONS,
                        Y.VL_GRID_ROW_DIMENSION,
                        Y.VL_GRID_COLUMN_DIMENSION,
                        Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
						Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                        Y.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
						Y.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
                        Y.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                        Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                        Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                        Y.VL_BLOCK_ROW_DIMENSION,
                        Y.VL_BLOCK_COLUMN_DIMENSION,
                        Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
						ROUND(Y.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                        Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                        Y.DS_RESOURCE,
                        Y.NR_NODES,
                        Y.NR_COMPUTING_UNITS_CPU,
                        (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
                        (Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
                        Y.NR_COMPUTING_UNITS_GPU,
                        Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                        Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                        Y.DS_DATASET,
                        Y.VL_DATASET_MEMORY_SIZE,
                        Y.DS_DATA_TYPE,
                        Y.VL_DATA_TYPE_MEMORY_SIZE,
                        Y.VL_DATASET_DIMENSION,
                        Y.VL_DATASET_ROW_DIMENSION,
                        Y.VL_DATASET_COLUMN_DIMENSION,
                        Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                        Y.NR_RANDOM_STATE
                        FROM
                        (
                            SELECT
                            AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                            CASE
								WHEN X.DS_FUNCTION = 'MATMUL_FUNC' THEN AVG(X.VL_INTER_TASK_EXECUTION_TIME)
								WHEN X.DS_FUNCTION = 'ADD_FUNC' THEN AVG(X.VL_INTER_TASK_EXECUTION_TIME)*ceil(ln(X.VL_GRID_ROW_DIMENSION)/ln(2))
								ELSE AVG(X.VL_INTER_TASK_EXECUTION_TIME)
							END AS VL_INTER_TASK_EXECUTION_TIME,
                            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                            AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                            AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                            AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                            AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                            AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                            AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                            STDDEV(X.VL_TOTAL_EXECUTION_TIME) AS VL_STD_TOTAL_EXECUTION_TIME,
                            STDDEV(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_STD_INTER_TASK_EXECUTION_TIME,
                            STDDEV(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                            STDDEV(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_STD_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                            STDDEV(X.VL_COMMUNICATION_TIME) AS VL_STD_COMMUNICATION_TIME,
                            X.ID_PARAMETER,
                            X.CD_PARAMETER,
                            X.CD_CONFIGURATION,
                            X.ID_ALGORITHM,
                            X.DS_ALGORITHM,
                            X.ID_FUNCTION,
                            X.DS_FUNCTION,
                            X.ID_DEVICE,
                            X.DS_DEVICE,
                            X.ID_DATASET,
                            X.ID_RESOURCE,
                            X.ID_PARAMETER_TYPE,
                            X.DS_PARAMETER_TYPE,
                            X.DS_PARAMETER_ATTRIBUTE,
                            X.NR_ITERATIONS,
                            X.VL_GRID_ROW_DIMENSION,
                            X.VL_GRID_COLUMN_DIMENSION,
                            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
							X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            X.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							X.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
                            X.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_BLOCK_ROW_DIMENSION,
                            X.VL_BLOCK_COLUMN_DIMENSION,
                            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
							ROUND(X.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.DS_RESOURCE,
                            X.NR_NODES,
                            X.NR_COMPUTING_UNITS_CPU,
                            X.NR_COMPUTING_UNITS_GPU,
                            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            X.DS_DATASET,
                            X.VL_DATASET_MEMORY_SIZE,
                            X.DS_DATA_TYPE,
                            X.VL_DATA_TYPE_MEMORY_SIZE,
                            X.VL_DATASET_DIMENSION,
                            X.VL_DATASET_ROW_DIMENSION,
                            X.VL_DATASET_COLUMN_DIMENSION,
                            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            X.NR_RANDOM_STATE
                            FROM
                            (
                                SELECT
                                    A.ID_EXPERIMENT,
                                    A.VL_TOTAL_EXECUTION_TIME,
                                    A.VL_INTER_TASK_EXECUTION_TIME,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    A.VL_COMMUNICATION_TIME_1,
                                    A.VL_COMMUNICATION_TIME_2,
                                    A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                    A.VL_ADDITIONAL_TIME_1,
                                    A.VL_ADDITIONAL_TIME_2,
                                    A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                    (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    A.DT_PROCESSING,
                                    B.ID_PARAMETER,
                                    B.CD_PARAMETER,
                                    B.CD_CONFIGURATION,
                                    B.ID_ALGORITHM,
                                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                    B.ID_FUNCTION,
                                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                    B.ID_DATASET,
                                    B.ID_RESOURCE,
                                    B.ID_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                    B.NR_ITERATIONS,
                                    B.VL_GRID_ROW_DIMENSION,
                                    B.VL_GRID_COLUMN_DIMENSION,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
									B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                                    ROUND(D.VL_DATASET_MEMORY_SIZE*1e-6,0) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
									CASE
										WHEN (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'KMEANS'
											THEN ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION*5  || ')'
										WHEN (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) = 'MATMUL_DISLIB'
											THEN ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION + B.VL_GRID_ROW_DIMENSION*B.VL_GRID_ROW_DIMENSION*(B.VL_GRID_ROW_DIMENSION-1)  || ')'
										ELSE
											'999999999999'
									END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
									ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                                    ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    B.VL_BLOCK_ROW_DIMENSION,
                                    B.VL_BLOCK_COLUMN_DIMENSION,
                                    B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                    ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) AS VL_BLOCK_MEMORY_SIZE,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    C.DS_RESOURCE,
                                    C.NR_NODES,
                                    C.NR_COMPUTING_UNITS_CPU,
                                    C.NR_COMPUTING_UNITS_GPU,
                                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    D.DS_DATASET,
                                    D.VL_DATASET_MEMORY_SIZE,
                                    D.DS_DATA_TYPE,
                                    D.VL_DATA_TYPE_MEMORY_SIZE,
                                    D.VL_DATASET_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION,
                                    D.VL_DATASET_COLUMN_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                    D.NR_RANDOM_STATE
                                FROM EXPERIMENT_RAW A
                                INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                WHERE
                                A.NR_ALGORITHM_ITERATION <> 0
                                --AND DATE_TRUNC('day', A.DT_PROCESSING) < TO_DATE('15/11/2022', 'dd/mm/yyyy')
                            ) X
                            GROUP BY
                            X.ID_PARAMETER,
                            X.CD_PARAMETER,
                            X.CD_CONFIGURATION,
                            X.ID_ALGORITHM,
                            X.DS_ALGORITHM,
                            X.ID_FUNCTION,
                            X.DS_FUNCTION,
                            X.ID_DEVICE,
                            X.DS_DEVICE,
                            X.ID_DATASET,
                            X.ID_RESOURCE,
                            X.ID_PARAMETER_TYPE,
                            X.DS_PARAMETER_TYPE,
                            X.DS_PARAMETER_ATTRIBUTE,
                            X.NR_ITERATIONS,
                            X.VL_GRID_ROW_DIMENSION,
                            X.VL_GRID_COLUMN_DIMENSION,
                            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
							X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            X.VL_CONCAT_DATASET_MB_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
							X.VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
                            X.VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
                            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_BLOCK_ROW_DIMENSION,
                            X.VL_BLOCK_COLUMN_DIMENSION,
                            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
							X.VL_BLOCK_MEMORY_SIZE,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.DS_RESOURCE,
                            X.NR_NODES,
                            X.NR_COMPUTING_UNITS_CPU,
                            X.NR_COMPUTING_UNITS_GPU,
                            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            X.DS_DATASET,
                            X.VL_DATASET_MEMORY_SIZE,
                            X.DS_DATA_TYPE,
                            X.VL_DATA_TYPE_MEMORY_SIZE,
                            X.VL_DATASET_DIMENSION,
                            X.VL_DATASET_ROW_DIMENSION,
                            X.VL_DATASET_COLUMN_DIMENSION,
                            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            X.NR_RANDOM_STATE
                        ) Y
		) ZZ
WHERE ZZ.ds_algorithm='KMEANS'
AND ZZ.nr_iterations = 5
AND ZZ.ds_dataset = 'S_1GB_1'
AND ZZ.DS_RESOURCE = 'MINOTAURO_9_NODES_1_CORE'
--AND ZZ.ds_parameter_type = 'VAR_CORES_CLUSTER_1'
--AND ZZ.id_resource IN (3,4,5,6,7,8,9,10)
AND ZZ.ds_parameter_type = 'VAR_GRID_ROW_6'
GROUP BY 
DS_DEVICE
--ORDER BY ZZ.ID_PARAMETER


























--INTRO CHARTS PT 1
SELECT
VL_TOTAL_EXECUTION_TIME,
--VL_INTER_TASK_EXECUTION_TIME,
VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
DS_DEVICE,
VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB
FROM
(
SELECT
                            A.VL_TOTAL_EXECUTION_TIME,
                            A.VL_INTER_TASK_EXECUTION_TIME,
                            (A.VL_INTER_TASK_EXECUTION_TIME - A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
                            A.VL_INTER_TASK_EXECUTION_TIME - (A.VL_INTER_TASK_EXECUTION_TIME - A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
                            A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                            A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                            A.VL_COMMUNICATION_TIME,
                            A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC - (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC+A.VL_COMMUNICATION_TIME) AS VL_ADDITIONAL_TIME,
                            (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                            B.ID_PARAMETER,
                            B.CD_PARAMETER,
                            B.CD_CONFIGURATION,
                            B.ID_ALGORITHM,
                            (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                            B.ID_FUNCTION,
                            (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                            (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                            (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                            B.ID_DATASET,
                            B.ID_RESOURCE,
                            B.ID_PARAMETER_TYPE,
                            (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                            (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                            B.NR_ITERATIONS,
                            B.VL_GRID_ROW_DIMENSION,
                            B.VL_GRID_COLUMN_DIMENSION,
                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            B.VL_BLOCK_ROW_DIMENSION,
                            B.VL_BLOCK_COLUMN_DIMENSION,
                            B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                            B.VL_BLOCK_MEMORY_SIZE,
                            B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            C.DS_RESOURCE,
                            C.NR_NODES,
                            C.NR_COMPUTING_UNITS_CPU,
                            (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
                            (C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
                            C.NR_COMPUTING_UNITS_GPU,
                            C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            D.DS_DATASET,
                            D.VL_DATASET_MEMORY_SIZE,
                            D.DS_DATA_TYPE,
                            D.VL_DATA_TYPE_MEMORY_SIZE,
                            D.VL_DATASET_DIMENSION,
                            D.VL_DATASET_ROW_DIMENSION,
                            D.VL_DATASET_COLUMN_DIMENSION,
                            D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            D.NR_RANDOM_STATE
                        FROM EXPERIMENT A
                        INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                        INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                        INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                        WHERE
                        A.VL_TOTAL_EXECUTION_TIME is not null
                        --(SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) <> 'MAX_INTER_MIN_INTRA'

                        UNION ALL


                        -- EXPERIMENT RAW QUERY
                        SELECT
                        Y.VL_TOTAL_EXECUTION_TIME,
                        Y.VL_INTER_TASK_EXECUTION_TIME,
                        (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_OVERHEAD_TIME,
                        Y.VL_INTER_TASK_EXECUTION_TIME - (Y.VL_INTER_TASK_EXECUTION_TIME - Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTER_TASK_EXECUTION_TIME_FREE_OVERHEAD,
                        Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                        Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                        Y.VL_COMMUNICATION_TIME,
                        Y.VL_ADDITIONAL_TIME,
                        (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                        Y.ID_PARAMETER,
                        Y.CD_PARAMETER,
                        Y.CD_CONFIGURATION,
                        Y.ID_ALGORITHM,
                        Y.DS_ALGORITHM,
                        Y.ID_FUNCTION,
                        Y.DS_FUNCTION,
                        Y.ID_DEVICE,
                        Y.DS_DEVICE,
                        Y.ID_DATASET,
                        Y.ID_RESOURCE,
                        Y.ID_PARAMETER_TYPE,
                        Y.DS_PARAMETER_TYPE,
                        Y.DS_PARAMETER_ATTRIBUTE,
                        Y.NR_ITERATIONS,
                        Y.VL_GRID_ROW_DIMENSION,
                        Y.VL_GRID_COLUMN_DIMENSION,
                        Y.VL_GRID_ROW_X_COLUMN_DIMENSION,
Y.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                        Y.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                        Y.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                        Y.VL_BLOCK_ROW_DIMENSION,
                        Y.VL_BLOCK_COLUMN_DIMENSION,
                        Y.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                        Y.VL_BLOCK_MEMORY_SIZE,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                        Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                        Y.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                        Y.DS_RESOURCE,
                        Y.NR_NODES,
                        Y.NR_COMPUTING_UNITS_CPU,
                        (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU AS NR_TOTAL_COMPUTING_UNITS_CPU,
                        (Y.NR_NODES-1) || ' (' || (Y.NR_NODES-1)*Y.NR_COMPUTING_UNITS_CPU || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU,
                        Y.NR_COMPUTING_UNITS_GPU,
                        Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                        Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                        Y.DS_DATASET,
                        Y.VL_DATASET_MEMORY_SIZE,
                        Y.DS_DATA_TYPE,
                        Y.VL_DATA_TYPE_MEMORY_SIZE,
                        Y.VL_DATASET_DIMENSION,
                        Y.VL_DATASET_ROW_DIMENSION,
                        Y.VL_DATASET_COLUMN_DIMENSION,
                        Y.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                        Y.NR_RANDOM_STATE
                        FROM
                        (
                            SELECT
                            AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                            AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
                            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                            AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                            AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                            AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                            AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                            AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                            AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                            AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                            X.ID_PARAMETER,
                            X.CD_PARAMETER,
                            X.CD_CONFIGURATION,
                            X.ID_ALGORITHM,
                            X.DS_ALGORITHM,
                            X.ID_FUNCTION,
                            X.DS_FUNCTION,
                            X.ID_DEVICE,
                            X.DS_DEVICE,
                            X.ID_DATASET,
                            X.ID_RESOURCE,
                            X.ID_PARAMETER_TYPE,
                            X.DS_PARAMETER_TYPE,
                            X.DS_PARAMETER_ATTRIBUTE,
                            X.NR_ITERATIONS,
                            X.VL_GRID_ROW_DIMENSION,
                            X.VL_GRID_COLUMN_DIMENSION,
                            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_BLOCK_ROW_DIMENSION,
                            X.VL_BLOCK_COLUMN_DIMENSION,
                            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                            X.VL_BLOCK_MEMORY_SIZE,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.DS_RESOURCE,
                            X.NR_NODES,
                            X.NR_COMPUTING_UNITS_CPU,
                            X.NR_COMPUTING_UNITS_GPU,
                            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            X.DS_DATASET,
                            X.VL_DATASET_MEMORY_SIZE,
                            X.DS_DATA_TYPE,
                            X.VL_DATA_TYPE_MEMORY_SIZE,
                            X.VL_DATASET_DIMENSION,
                            X.VL_DATASET_ROW_DIMENSION,
                            X.VL_DATASET_COLUMN_DIMENSION,
                            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            X.NR_RANDOM_STATE
                            FROM
                            (
                                SELECT
                                    A.ID_EXPERIMENT,
                                    A.VL_TOTAL_EXECUTION_TIME,
                                    A.VL_INTER_TASK_EXECUTION_TIME,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    A.VL_COMMUNICATION_TIME_1,
                                    A.VL_COMMUNICATION_TIME_2,
                                    A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                    A.VL_ADDITIONAL_TIME_1,
                                    A.VL_ADDITIONAL_TIME_2,
                                    A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                    (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    A.DT_PROCESSING,
                                    B.ID_PARAMETER,
                                    B.CD_PARAMETER,
                                    B.CD_CONFIGURATION,
                                    B.ID_ALGORITHM,
                                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                    B.ID_FUNCTION,
                                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                    B.ID_DATASET,
                                    B.ID_RESOURCE,
                                    B.ID_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                    B.NR_ITERATIONS,
                                    B.VL_GRID_ROW_DIMENSION,
                                    B.VL_GRID_COLUMN_DIMENSION,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    B.VL_BLOCK_ROW_DIMENSION,
                                    B.VL_BLOCK_COLUMN_DIMENSION,
                                    B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                    B.VL_BLOCK_MEMORY_SIZE,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    C.DS_RESOURCE,
                                    C.NR_NODES,
                                    C.NR_COMPUTING_UNITS_CPU,
                                    C.NR_COMPUTING_UNITS_GPU,
                                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    D.DS_DATASET,
                                    D.VL_DATASET_MEMORY_SIZE,
                                    D.DS_DATA_TYPE,
                                    D.VL_DATA_TYPE_MEMORY_SIZE,
                                    D.VL_DATASET_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION,
                                    D.VL_DATASET_COLUMN_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                    D.NR_RANDOM_STATE
                                FROM EXPERIMENT_RAW A
                                INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                WHERE
                                A.NR_ALGORITHM_ITERATION <> 0
                            ) X
                            GROUP BY
                            X.ID_PARAMETER,
                            X.CD_PARAMETER,
                            X.CD_CONFIGURATION,
                            X.ID_ALGORITHM,
                            X.DS_ALGORITHM,
                            X.ID_FUNCTION,
                            X.DS_FUNCTION,
                            X.ID_DEVICE,
                            X.DS_DEVICE,
                            X.ID_DATASET,
                            X.ID_RESOURCE,
                            X.ID_PARAMETER_TYPE,
                            X.DS_PARAMETER_TYPE,
                            X.DS_PARAMETER_ATTRIBUTE,
                            X.NR_ITERATIONS,
                            X.VL_GRID_ROW_DIMENSION,
                            X.VL_GRID_COLUMN_DIMENSION,
                            X.VL_GRID_ROW_X_COLUMN_DIMENSION,
X.VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
                            X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                            X.VL_BLOCK_ROW_DIMENSION,
                            X.VL_BLOCK_COLUMN_DIMENSION,
                            X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                            X.VL_BLOCK_MEMORY_SIZE,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                            X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                            X.DS_RESOURCE,
                            X.NR_NODES,
                            X.NR_COMPUTING_UNITS_CPU,
                            X.NR_COMPUTING_UNITS_GPU,
                            X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                            X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                            X.DS_DATASET,
                            X.VL_DATASET_MEMORY_SIZE,
                            X.DS_DATA_TYPE,
                            X.VL_DATA_TYPE_MEMORY_SIZE,
                            X.VL_DATASET_DIMENSION,
                            X.VL_DATASET_ROW_DIMENSION,
                            X.VL_DATASET_COLUMN_DIMENSION,
                            X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                            X.NR_RANDOM_STATE
                        ) Y
) ZZ
WHERE ZZ.ds_algorithm='MATMUL_DISLIB'
AND ZZ.nr_iterations = 5
AND ZZ.ds_dataset = 'S_8GB_1'
--AND ZZ.ds_parameter_type = 'VAR_CORES_CLUSTER_1'
--AND ZZ.id_resource IN (3,4,5,6,7,8,9,10)
AND ZZ.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
AND ZZ.DS_FUNCTION = 'MATMUL_FUNC'
AND ZZ.VL_GRID_ROW_X_COLUMN_DIMENSION in ('16 x 16')
--AND ZZ.id_resource IN (3,11,12,13,14,15,16)
ORDER BY ZZ.ID_PARAMETER




--INTRO CHARTS PT 2
                       WITH T_CPU AS (
                                    SELECT
                                    A.VL_TOTAL_EXECUTION_TIME,
                                    A.VL_INTER_TASK_EXECUTION_TIME,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    A.VL_COMMUNICATION_TIME,
                                    (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    B.ID_PARAMETER,
                                    B.CD_PARAMETER,
                                    B.CD_CONFIGURATION,
                                    B.ID_ALGORITHM,
                                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                    B.ID_FUNCTION,
                                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                    B.ID_DATASET,
                                    B.ID_RESOURCE,
                                    B.ID_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                    B.NR_ITERATIONS,
                                    B.VL_GRID_ROW_DIMENSION,
                                    B.VL_GRID_COLUMN_DIMENSION,
                                    B.VL_BLOCK_ROW_DIMENSION,
                                    B.VL_BLOCK_COLUMN_DIMENSION,
                                    B.VL_BLOCK_MEMORY_SIZE,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    C.DS_RESOURCE,
                                    C.NR_NODES,
                                    C.NR_COMPUTING_UNITS_CPU,
                                    C.NR_COMPUTING_UNITS_GPU,
                                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    D.DS_DATASET,
                                    D.VL_DATASET_MEMORY_SIZE,
                                    D.DS_DATA_TYPE,
                                    D.VL_DATA_TYPE_MEMORY_SIZE,
                                    D.VL_DATASET_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION,
                                    D.VL_DATASET_COLUMN_DIMENSION,
                                    D.NR_RANDOM_STATE
                                FROM EXPERIMENT A
                                INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                WHERE
                                (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'

                                UNION ALL

                                    SELECT
                                    Y.VL_TOTAL_EXECUTION_TIME,
                                    Y.VL_INTER_TASK_EXECUTION_TIME,
                                    Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    Y.VL_COMMUNICATION_TIME,
                                    (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    Y.ID_PARAMETER,
                                    Y.CD_PARAMETER,
                                    Y.CD_CONFIGURATION,
                                    Y.ID_ALGORITHM,
                                    Y.DS_ALGORITHM,
                                    Y.ID_FUNCTION,
                                    Y.DS_FUNCTION,
                                    Y.ID_DEVICE,
                                    Y.DS_DEVICE,
                                    Y.ID_DATASET,
                                    Y.ID_RESOURCE,
                                    Y.ID_PARAMETER_TYPE,
                                    Y.DS_PARAMETER_TYPE,
                                    Y.DS_PARAMETER_ATTRIBUTE,
                                    Y.NR_ITERATIONS,
                                    Y.VL_GRID_ROW_DIMENSION,
                                    Y.VL_GRID_COLUMN_DIMENSION,
                                    Y.VL_BLOCK_ROW_DIMENSION,
                                    Y.VL_BLOCK_COLUMN_DIMENSION,
                                    Y.VL_BLOCK_MEMORY_SIZE,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    Y.DS_RESOURCE,
                                    Y.NR_NODES,
                                    Y.NR_COMPUTING_UNITS_CPU,
                                    Y.NR_COMPUTING_UNITS_GPU,
                                    Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    Y.DS_DATASET,
                                    Y.VL_DATASET_MEMORY_SIZE,
                                    Y.DS_DATA_TYPE,
                                    Y.VL_DATA_TYPE_MEMORY_SIZE,
                                    Y.VL_DATASET_DIMENSION,
                                    Y.VL_DATASET_ROW_DIMENSION,
                                    Y.VL_DATASET_COLUMN_DIMENSION,
                                    Y.NR_RANDOM_STATE
                                    FROM
                                    (
                                        SELECT
                                        AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                                        AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
                                        AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                        AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                        AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                                        AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                                        AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                                        AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                                        AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                                        AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                                        X.ID_PARAMETER,
                                        X.CD_PARAMETER,
                                        X.CD_CONFIGURATION,
                                        X.ID_ALGORITHM,
                                        X.DS_ALGORITHM,
                                        X.ID_FUNCTION,
                                        X.DS_FUNCTION,
                                        X.ID_DEVICE,
                                        X.DS_DEVICE,
                                        X.ID_DATASET,
                                        X.ID_RESOURCE,
                                        X.ID_PARAMETER_TYPE,
                                        X.DS_PARAMETER_TYPE,
                                        X.DS_PARAMETER_ATTRIBUTE,
                                        X.NR_ITERATIONS,
                                        X.VL_GRID_ROW_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION,
                                        X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_BLOCK_ROW_DIMENSION,
                                        X.VL_BLOCK_COLUMN_DIMENSION,
                                        X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                        X.VL_BLOCK_MEMORY_SIZE,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.DS_RESOURCE,
                                        X.NR_NODES,
                                        X.NR_COMPUTING_UNITS_CPU,
                                        X.NR_COMPUTING_UNITS_GPU,
                                        X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                        X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                        X.DS_DATASET,
                                        X.VL_DATASET_MEMORY_SIZE,
                                        X.DS_DATA_TYPE,
                                        X.VL_DATA_TYPE_MEMORY_SIZE,
                                        X.VL_DATASET_DIMENSION,
                                        X.VL_DATASET_ROW_DIMENSION,
                                        X.VL_DATASET_COLUMN_DIMENSION,
                                        X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                        X.NR_RANDOM_STATE
                                        FROM
                                        (
                                            SELECT
                                                A.ID_EXPERIMENT,
                                                A.VL_TOTAL_EXECUTION_TIME,
                                                A.VL_INTER_TASK_EXECUTION_TIME,
                                                A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                                A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                                A.VL_COMMUNICATION_TIME_1,
                                                A.VL_COMMUNICATION_TIME_2,
                                                A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                                A.VL_ADDITIONAL_TIME_1,
                                                A.VL_ADDITIONAL_TIME_2,
                                                A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                                A.DT_PROCESSING,
                                                B.ID_PARAMETER,
                                                B.CD_PARAMETER,
                                                B.CD_CONFIGURATION,
                                                B.ID_ALGORITHM,
                                                (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                                B.ID_FUNCTION,
                                                (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                                (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                                (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                                B.ID_DATASET,
                                                B.ID_RESOURCE,
                                                B.ID_PARAMETER_TYPE,
                                                (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                                (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                                B.NR_ITERATIONS,
                                                B.VL_GRID_ROW_DIMENSION,
                                                B.VL_GRID_COLUMN_DIMENSION,
                                                B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                                                ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                                B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                                B.VL_BLOCK_ROW_DIMENSION,
                                                B.VL_BLOCK_COLUMN_DIMENSION,
                                                B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                                B.VL_BLOCK_MEMORY_SIZE,
                                                B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                                B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                                ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                                ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                                C.DS_RESOURCE,
                                                C.NR_NODES,
                                                C.NR_COMPUTING_UNITS_CPU,
                                                C.NR_COMPUTING_UNITS_GPU,
                                                C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                                C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                                D.DS_DATASET,
                                                D.VL_DATASET_MEMORY_SIZE,
                                                D.DS_DATA_TYPE,
                                                D.VL_DATA_TYPE_MEMORY_SIZE,
                                                D.VL_DATASET_DIMENSION,
                                                D.VL_DATASET_ROW_DIMENSION,
                                                D.VL_DATASET_COLUMN_DIMENSION,
                                                D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                                D.NR_RANDOM_STATE
                                            FROM EXPERIMENT_RAW A
                                            INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                            INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                            INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                            WHERE
                                            (SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
                                            AND A.NR_ALGORITHM_ITERATION <> 0
                                        ) X
										WHERE
										X.DS_FUNCTION = 'MATMUL_FUNC'
                                        GROUP BY
                                        X.ID_PARAMETER,
                                        X.CD_PARAMETER,
                                        X.CD_CONFIGURATION,
                                        X.ID_ALGORITHM,
                                        X.DS_ALGORITHM,
                                        X.ID_FUNCTION,
                                        X.DS_FUNCTION,
                                        X.ID_DEVICE,
                                        X.DS_DEVICE,
                                        X.ID_DATASET,
                                        X.ID_RESOURCE,
                                        X.ID_PARAMETER_TYPE,
                                        X.DS_PARAMETER_TYPE,
                                        X.DS_PARAMETER_ATTRIBUTE,
                                        X.NR_ITERATIONS,
                                        X.VL_GRID_ROW_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION,
                                        X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_BLOCK_ROW_DIMENSION,
                                        X.VL_BLOCK_COLUMN_DIMENSION,
                                        X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                        X.VL_BLOCK_MEMORY_SIZE,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.DS_RESOURCE,
                                        X.NR_NODES,
                                        X.NR_COMPUTING_UNITS_CPU,
                                        X.NR_COMPUTING_UNITS_GPU,
                                        X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                        X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                        X.DS_DATASET,
                                        X.VL_DATASET_MEMORY_SIZE,
                                        X.DS_DATA_TYPE,
                                        X.VL_DATA_TYPE_MEMORY_SIZE,
                                        X.VL_DATASET_DIMENSION,
                                        X.VL_DATASET_ROW_DIMENSION,
                                        X.VL_DATASET_COLUMN_DIMENSION,
                                        X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                        X.NR_RANDOM_STATE
                                    ) Y

                                ),
                    T_GPU AS (
                                    SELECT
                                    A.VL_TOTAL_EXECUTION_TIME,
                                    A.VL_INTER_TASK_EXECUTION_TIME,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    A.VL_COMMUNICATION_TIME,
                                    (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    B.ID_PARAMETER,
                                    B.CD_PARAMETER,
                                    B.CD_CONFIGURATION,
                                    B.ID_ALGORITHM,
                                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                    B.ID_FUNCTION,
                                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                    B.ID_DATASET,
                                    B.ID_RESOURCE,
                                    B.ID_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                    B.NR_ITERATIONS,
                                    B.VL_GRID_ROW_DIMENSION,
                                    B.VL_GRID_COLUMN_DIMENSION,
                                    B.VL_BLOCK_ROW_DIMENSION,
                                    B.VL_BLOCK_COLUMN_DIMENSION,
                                    B.VL_BLOCK_MEMORY_SIZE,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    C.DS_RESOURCE,
                                    C.NR_NODES,
                                    C.NR_COMPUTING_UNITS_CPU,
                                    C.NR_COMPUTING_UNITS_GPU,
                                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    D.DS_DATASET,
                                    D.VL_DATASET_MEMORY_SIZE,
                                    D.DS_DATA_TYPE,
                                    D.VL_DATA_TYPE_MEMORY_SIZE,
                                    D.VL_DATASET_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION,
                                    D.VL_DATASET_COLUMN_DIMENSION,
                                    D.NR_RANDOM_STATE
                                    FROM EXPERIMENT A
                                    INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                    INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                    INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                    WHERE
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'

                                UNION ALL

                                    SELECT
                                    Y.VL_TOTAL_EXECUTION_TIME,
                                    Y.VL_INTER_TASK_EXECUTION_TIME,
                                    Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    Y.VL_COMMUNICATION_TIME,
                                    (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    Y.ID_PARAMETER,
                                    Y.CD_PARAMETER,
                                    Y.CD_CONFIGURATION,
                                    Y.ID_ALGORITHM,
                                    Y.DS_ALGORITHM,
                                    Y.ID_FUNCTION,
                                    Y.DS_FUNCTION,
                                    Y.ID_DEVICE,
                                    Y.DS_DEVICE,
                                    Y.ID_DATASET,
                                    Y.ID_RESOURCE,
                                    Y.ID_PARAMETER_TYPE,
                                    Y.DS_PARAMETER_TYPE,
                                    Y.DS_PARAMETER_ATTRIBUTE,
                                    Y.NR_ITERATIONS,
                                    Y.VL_GRID_ROW_DIMENSION,
                                    Y.VL_GRID_COLUMN_DIMENSION,
                                    Y.VL_BLOCK_ROW_DIMENSION,
                                    Y.VL_BLOCK_COLUMN_DIMENSION,
                                    Y.VL_BLOCK_MEMORY_SIZE,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    Y.DS_RESOURCE,
                                    Y.NR_NODES,
                                    Y.NR_COMPUTING_UNITS_CPU,
                                    Y.NR_COMPUTING_UNITS_GPU,
                                    Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    Y.DS_DATASET,
                                    Y.VL_DATASET_MEMORY_SIZE,
                                    Y.DS_DATA_TYPE,
                                    Y.VL_DATA_TYPE_MEMORY_SIZE,
                                    Y.VL_DATASET_DIMENSION,
                                    Y.VL_DATASET_ROW_DIMENSION,
                                    Y.VL_DATASET_COLUMN_DIMENSION,
                                    Y.NR_RANDOM_STATE
                                    FROM
                                    (
                                        SELECT
                                        AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                                        AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
                                        AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                        AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                        AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                                        AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                                        AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                                        AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                                        AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                                        AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                                        X.ID_PARAMETER,
                                        X.CD_PARAMETER,
                                        X.CD_CONFIGURATION,
                                        X.ID_ALGORITHM,
                                        X.DS_ALGORITHM,
                                        X.ID_FUNCTION,
                                        X.DS_FUNCTION,
                                        X.ID_DEVICE,
                                        X.DS_DEVICE,
                                        X.ID_DATASET,
                                        X.ID_RESOURCE,
                                        X.ID_PARAMETER_TYPE,
                                        X.DS_PARAMETER_TYPE,
                                        X.DS_PARAMETER_ATTRIBUTE,
                                        X.NR_ITERATIONS,
                                        X.VL_GRID_ROW_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION,
                                        X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_BLOCK_ROW_DIMENSION,
                                        X.VL_BLOCK_COLUMN_DIMENSION,
                                        X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                        X.VL_BLOCK_MEMORY_SIZE,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.DS_RESOURCE,
                                        X.NR_NODES,
                                        X.NR_COMPUTING_UNITS_CPU,
                                        X.NR_COMPUTING_UNITS_GPU,
                                        X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                        X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                        X.DS_DATASET,
                                        X.VL_DATASET_MEMORY_SIZE,
                                        X.DS_DATA_TYPE,
                                        X.VL_DATA_TYPE_MEMORY_SIZE,
                                        X.VL_DATASET_DIMENSION,
                                        X.VL_DATASET_ROW_DIMENSION,
                                        X.VL_DATASET_COLUMN_DIMENSION,
                                        X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                        X.NR_RANDOM_STATE
                                        FROM
                                        (
                                            SELECT
                                                A.ID_EXPERIMENT,
                                                A.VL_TOTAL_EXECUTION_TIME,
                                                A.VL_INTER_TASK_EXECUTION_TIME,
                                                A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                                A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                                A.VL_COMMUNICATION_TIME_1,
                                                A.VL_COMMUNICATION_TIME_2,
                                                A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                                A.VL_ADDITIONAL_TIME_1,
                                                A.VL_ADDITIONAL_TIME_2,
                                                A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                                A.DT_PROCESSING,
                                                B.ID_PARAMETER,
                                                B.CD_PARAMETER,
                                                B.CD_CONFIGURATION,
                                                B.ID_ALGORITHM,
                                                (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                                B.ID_FUNCTION,
                                                (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                                (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                                (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                                B.ID_DATASET,
                                                B.ID_RESOURCE,
                                                B.ID_PARAMETER_TYPE,
                                                (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                                (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                                B.NR_ITERATIONS,
                                                B.VL_GRID_ROW_DIMENSION,
                                                B.VL_GRID_COLUMN_DIMENSION,
                                                B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                                                ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                                B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                                B.VL_BLOCK_ROW_DIMENSION,
                                                B.VL_BLOCK_COLUMN_DIMENSION,
                                                B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                                B.VL_BLOCK_MEMORY_SIZE,
                                                B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                                B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                                ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                                ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                                C.DS_RESOURCE,
                                                C.NR_NODES,
                                                C.NR_COMPUTING_UNITS_CPU,
                                                C.NR_COMPUTING_UNITS_GPU,
                                                C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                                C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                                D.DS_DATASET,
                                                D.VL_DATASET_MEMORY_SIZE,
                                                D.DS_DATA_TYPE,
                                                D.VL_DATA_TYPE_MEMORY_SIZE,
                                                D.VL_DATASET_DIMENSION,
                                                D.VL_DATASET_ROW_DIMENSION,
                                                D.VL_DATASET_COLUMN_DIMENSION,
                                                D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                                D.NR_RANDOM_STATE
                                            FROM EXPERIMENT_RAW A
                                            INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                            INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                            INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                            WHERE
                                            (SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
                                            AND A.NR_ALGORITHM_ITERATION <> 0
                                        ) X
										WHERE
										X.DS_FUNCTION = 'MATMUL_FUNC'
                                        GROUP BY
                                        X.ID_PARAMETER,
                                        X.CD_PARAMETER,
                                        X.CD_CONFIGURATION,
                                        X.ID_ALGORITHM,
                                        X.DS_ALGORITHM,
                                        X.ID_FUNCTION,
                                        X.DS_FUNCTION,
                                        X.ID_DEVICE,
                                        X.DS_DEVICE,
                                        X.ID_DATASET,
                                        X.ID_RESOURCE,
                                        X.ID_PARAMETER_TYPE,
                                        X.DS_PARAMETER_TYPE,
                                        X.DS_PARAMETER_ATTRIBUTE,
                                        X.NR_ITERATIONS,
                                        X.VL_GRID_ROW_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION,
                                        X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_BLOCK_ROW_DIMENSION,
                                        X.VL_BLOCK_COLUMN_DIMENSION,
                                        X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                        X.VL_BLOCK_MEMORY_SIZE,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.DS_RESOURCE,
                                        X.NR_NODES,
                                        X.NR_COMPUTING_UNITS_CPU,
                                        X.NR_COMPUTING_UNITS_GPU,
                                        X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                        X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                        X.DS_DATASET,
                                        X.VL_DATASET_MEMORY_SIZE,
                                        X.DS_DATA_TYPE,
                                        X.VL_DATA_TYPE_MEMORY_SIZE,
                                        X.VL_DATASET_DIMENSION,
                                        X.VL_DATASET_ROW_DIMENSION,
                                        X.VL_DATASET_COLUMN_DIMENSION,
                                        X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                        X.NR_RANDOM_STATE
                                    ) Y
                    )
                    SELECT
                    T_CPU.ID_PARAMETER_TYPE,
                    T_CPU.CD_PARAMETER,
                    T_CPU.DS_ALGORITHM,
                    T_CPU.DS_FUNCTION,
                    T_CPU.NR_ITERATIONS,
                    CASE
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3
                    ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) END AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                    CASE
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' END AS CONCAT_BLOCK_PERCENT_DATASET_GRID_DIMENSION,
                    --ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                    T_CPU.DS_RESOURCE,
                    T_CPU.DS_PARAMETER_TYPE,
                    T_CPU.DS_PARAMETER_ATTRIBUTE,
                    T_CPU.DS_DATASET,
                    CAST(T_CPU.VL_DATASET_MEMORY_SIZE*1e-6 AS BIGINT) as VL_DATASET_MEMORY_SIZE,
                    T_CPU.VL_DATASET_DIMENSION,
                    T_CPU.VL_DATASET_ROW_DIMENSION,
                    T_CPU.VL_DATASET_COLUMN_DIMENSION,
                    T_CPU.VL_GRID_ROW_DIMENSION,
                    T_CPU.VL_GRID_COLUMN_DIMENSION,
                    T_CPU.VL_BLOCK_ROW_DIMENSION,
                    T_CPU.VL_BLOCK_COLUMN_DIMENSION,
                    T_CPU.VL_BLOCK_MEMORY_SIZE,
                    ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
					CASE
						WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
							THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
						WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
							THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
						ELSE
							'999999999999'
					END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
					CASE
						WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
							THEN
								CASE
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
								END
						WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
							THEN
								CASE
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
								END
						ELSE
							'999999999999'
					END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
                    CASE
                    WHEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_TOTAL_EXECUTION_TIME/T_GPU.VL_TOTAL_EXECUTION_TIME)
                    ELSE -(T_GPU.VL_TOTAL_EXECUTION_TIME/T_CPU.VL_TOTAL_EXECUTION_TIME)
                    END AS SPEEDUP_GPU_TOTAL_EXECUTION_TIME,
                    CASE
                    WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
                    ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
                    END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                    CASE
                    WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
                    ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
                    END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
                    FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
                    WHERE
                    T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
                    AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
                    AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
                    AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
					AND T_CPU.ds_algorithm='MATMUL_DISLIB'
					AND T_CPU.nr_iterations = 5
					AND T_CPU.ds_dataset = 'S_8GB_1'
					--AND ZZ.ds_parameter_type = 'VAR_CORES_CLUSTER_1'
					--AND ZZ.id_resource IN (3,4,5,6,7,8,9,10)
					AND T_CPU.ds_parameter_type = 'VAR_GRID_SHAPE_MATMUL_1'
					AND T_CPU.DS_FUNCTION = 'MATMUL_FUNC'
					AND T_CPU.VL_GRID_ROW_DIMENSION in (16)
					AND T_CPU.VL_GRID_ROW_DIMENSION in (16)
					ORDER BY
					T_CPU.DS_DATASET,
					T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET;





-- KMEANS INTRO CHARTS
WITH T_CPU AS (
                                    SELECT
                                    A.VL_TOTAL_EXECUTION_TIME,
                                    A.VL_INTER_TASK_EXECUTION_TIME,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    A.VL_COMMUNICATION_TIME,
                                    (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    B.ID_PARAMETER,
                                    B.CD_PARAMETER,
                                    B.CD_CONFIGURATION,
                                    B.ID_ALGORITHM,
                                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                    B.ID_FUNCTION,
                                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                    B.ID_DATASET,
                                    B.ID_RESOURCE,
                                    B.ID_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                    B.NR_ITERATIONS,
                                    B.VL_GRID_ROW_DIMENSION,
                                    B.VL_GRID_COLUMN_DIMENSION,
                                    B.VL_BLOCK_ROW_DIMENSION,
                                    B.VL_BLOCK_COLUMN_DIMENSION,
                                    B.VL_BLOCK_MEMORY_SIZE,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    C.DS_RESOURCE,
                                    C.NR_NODES,
                                    C.NR_COMPUTING_UNITS_CPU,
                                    C.NR_COMPUTING_UNITS_GPU,
                                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
									(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                    D.DS_DATASET,
                                    D.VL_DATASET_MEMORY_SIZE,
                                    D.DS_DATA_TYPE,
                                    D.VL_DATA_TYPE_MEMORY_SIZE,
                                    D.VL_DATASET_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION,
                                    D.VL_DATASET_COLUMN_DIMENSION,
                                    D.NR_RANDOM_STATE
                                FROM EXPERIMENT A
                                INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                WHERE
                                (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
                                
                                UNION ALL
                        
                                    SELECT
                                    Y.VL_TOTAL_EXECUTION_TIME,
                                    Y.VL_INTER_TASK_EXECUTION_TIME,
                                    Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    Y.VL_COMMUNICATION_TIME,
                                    (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    Y.ID_PARAMETER,
                                    Y.CD_PARAMETER,
                                    Y.CD_CONFIGURATION,
                                    Y.ID_ALGORITHM,
                                    Y.DS_ALGORITHM,
                                    Y.ID_FUNCTION,
                                    Y.DS_FUNCTION,
                                    Y.ID_DEVICE,
                                    Y.DS_DEVICE,
                                    Y.ID_DATASET,
                                    Y.ID_RESOURCE,
                                    Y.ID_PARAMETER_TYPE,
                                    Y.DS_PARAMETER_TYPE,
                                    Y.DS_PARAMETER_ATTRIBUTE,
                                    Y.NR_ITERATIONS,
                                    Y.VL_GRID_ROW_DIMENSION,
                                    Y.VL_GRID_COLUMN_DIMENSION,
                                    Y.VL_BLOCK_ROW_DIMENSION,
                                    Y.VL_BLOCK_COLUMN_DIMENSION,
                                    Y.VL_BLOCK_MEMORY_SIZE,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    Y.DS_RESOURCE,
                                    Y.NR_NODES,
                                    Y.NR_COMPUTING_UNITS_CPU,
                                    Y.NR_COMPUTING_UNITS_GPU,
                                    Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
									Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                    Y.DS_DATASET,
                                    Y.VL_DATASET_MEMORY_SIZE,
                                    Y.DS_DATA_TYPE,
                                    Y.VL_DATA_TYPE_MEMORY_SIZE,
                                    Y.VL_DATASET_DIMENSION,
                                    Y.VL_DATASET_ROW_DIMENSION,
                                    Y.VL_DATASET_COLUMN_DIMENSION,
                                    Y.NR_RANDOM_STATE
                                    FROM
                                    (
                                        SELECT
                                        AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                                        AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
                                        AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                        AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                        AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                                        AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                                        AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                                        AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                                        AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                                        AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                                        X.ID_PARAMETER,
                                        X.CD_PARAMETER,
                                        X.CD_CONFIGURATION,
                                        X.ID_ALGORITHM,
                                        X.DS_ALGORITHM,
                                        X.ID_FUNCTION,
                                        X.DS_FUNCTION,
                                        X.ID_DEVICE,
                                        X.DS_DEVICE,
                                        X.ID_DATASET,
                                        X.ID_RESOURCE,
                                        X.ID_PARAMETER_TYPE,
                                        X.DS_PARAMETER_TYPE,
                                        X.DS_PARAMETER_ATTRIBUTE,
                                        X.NR_ITERATIONS,
                                        X.VL_GRID_ROW_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION,
                                        X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_BLOCK_ROW_DIMENSION,
                                        X.VL_BLOCK_COLUMN_DIMENSION,
                                        X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                        X.VL_BLOCK_MEMORY_SIZE,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.DS_RESOURCE,
                                        X.NR_NODES,
                                        X.NR_COMPUTING_UNITS_CPU,
                                        X.NR_COMPUTING_UNITS_GPU,
                                        X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                        X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
										X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                        X.DS_DATASET,
                                        X.VL_DATASET_MEMORY_SIZE,
                                        X.DS_DATA_TYPE,
                                        X.VL_DATA_TYPE_MEMORY_SIZE,
                                        X.VL_DATASET_DIMENSION,
                                        X.VL_DATASET_ROW_DIMENSION,
                                        X.VL_DATASET_COLUMN_DIMENSION,
                                        X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                        X.NR_RANDOM_STATE
                                        FROM
                                        (
                                            SELECT
                                                A.ID_EXPERIMENT,
                                                A.VL_TOTAL_EXECUTION_TIME,
                                                A.VL_INTER_TASK_EXECUTION_TIME,
                                                A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                                A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                                A.VL_COMMUNICATION_TIME_1,
                                                A.VL_COMMUNICATION_TIME_2,
                                                A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                                A.VL_ADDITIONAL_TIME_1,
                                                A.VL_ADDITIONAL_TIME_2,
                                                A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                                A.DT_PROCESSING,
                                                B.ID_PARAMETER,
                                                B.CD_PARAMETER,
                                                B.CD_CONFIGURATION,
                                                B.ID_ALGORITHM,
                                                (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                                B.ID_FUNCTION,
                                                (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                                (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                                (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                                B.ID_DATASET,
                                                B.ID_RESOURCE,
                                                B.ID_PARAMETER_TYPE,
                                                (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                                (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                                B.NR_ITERATIONS,
                                                B.VL_GRID_ROW_DIMENSION,
                                                B.VL_GRID_COLUMN_DIMENSION,
                                                B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                                                ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                                B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                                B.VL_BLOCK_ROW_DIMENSION,
                                                B.VL_BLOCK_COLUMN_DIMENSION,
                                                B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                                B.VL_BLOCK_MEMORY_SIZE,
                                                B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                                B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                                ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                                ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                                C.DS_RESOURCE,
                                                C.NR_NODES,
                                                C.NR_COMPUTING_UNITS_CPU,
                                                C.NR_COMPUTING_UNITS_GPU,
                                                C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                                C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
												(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                                D.DS_DATASET,
                                                D.VL_DATASET_MEMORY_SIZE,
                                                D.DS_DATA_TYPE,
                                                D.VL_DATA_TYPE_MEMORY_SIZE,
                                                D.VL_DATASET_DIMENSION,
                                                D.VL_DATASET_ROW_DIMENSION,
                                                D.VL_DATASET_COLUMN_DIMENSION,
                                                D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                                D.NR_RANDOM_STATE
                                            FROM EXPERIMENT_RAW A
                                            INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                            INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                            INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                            WHERE
                                            (SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
                                            AND A.NR_ALGORITHM_ITERATION <> 0
                                        ) X
                                        GROUP BY
                                        X.ID_PARAMETER,
                                        X.CD_PARAMETER,
                                        X.CD_CONFIGURATION,
                                        X.ID_ALGORITHM,
                                        X.DS_ALGORITHM,
                                        X.ID_FUNCTION,
                                        X.DS_FUNCTION,
                                        X.ID_DEVICE,
                                        X.DS_DEVICE,
                                        X.ID_DATASET,
                                        X.ID_RESOURCE,
                                        X.ID_PARAMETER_TYPE,
                                        X.DS_PARAMETER_TYPE,
                                        X.DS_PARAMETER_ATTRIBUTE,
                                        X.NR_ITERATIONS,
                                        X.VL_GRID_ROW_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION,
                                        X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_BLOCK_ROW_DIMENSION,
                                        X.VL_BLOCK_COLUMN_DIMENSION,
                                        X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                        X.VL_BLOCK_MEMORY_SIZE,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.DS_RESOURCE,
                                        X.NR_NODES,
                                        X.NR_COMPUTING_UNITS_CPU,
                                        X.NR_COMPUTING_UNITS_GPU,
                                        X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                        X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
										X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                        X.DS_DATASET,
                                        X.VL_DATASET_MEMORY_SIZE,
                                        X.DS_DATA_TYPE,
                                        X.VL_DATA_TYPE_MEMORY_SIZE,
                                        X.VL_DATASET_DIMENSION,
                                        X.VL_DATASET_ROW_DIMENSION,
                                        X.VL_DATASET_COLUMN_DIMENSION,
                                        X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                        X.NR_RANDOM_STATE
                                    ) Y
                        
                                ),
                    T_GPU AS (
                                    SELECT
                                    A.VL_TOTAL_EXECUTION_TIME,
                                    A.VL_INTER_TASK_EXECUTION_TIME,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    A.VL_COMMUNICATION_TIME,
                                    (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    B.ID_PARAMETER,
                                    B.CD_PARAMETER,
                                    B.CD_CONFIGURATION,
                                    B.ID_ALGORITHM,
                                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                    B.ID_FUNCTION,
                                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                    B.ID_DATASET,
                                    B.ID_RESOURCE,
                                    B.ID_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                    B.NR_ITERATIONS,
                                    B.VL_GRID_ROW_DIMENSION,
                                    B.VL_GRID_COLUMN_DIMENSION,
                                    B.VL_BLOCK_ROW_DIMENSION,
                                    B.VL_BLOCK_COLUMN_DIMENSION,
                                    B.VL_BLOCK_MEMORY_SIZE,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    C.DS_RESOURCE,
                                    C.NR_NODES,
                                    C.NR_COMPUTING_UNITS_CPU,
                                    C.NR_COMPUTING_UNITS_GPU,
                                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
									(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                    D.DS_DATASET,
                                    D.VL_DATASET_MEMORY_SIZE,
                                    D.DS_DATA_TYPE,
                                    D.VL_DATA_TYPE_MEMORY_SIZE,
                                    D.VL_DATASET_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION,
                                    D.VL_DATASET_COLUMN_DIMENSION,
                                    D.NR_RANDOM_STATE
                                    FROM EXPERIMENT A
                                    INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                    INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                    INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                    WHERE
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
                            
                                UNION ALL
                        
                                    SELECT
                                    Y.VL_TOTAL_EXECUTION_TIME,
                                    Y.VL_INTER_TASK_EXECUTION_TIME,
                                    Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    Y.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    Y.VL_COMMUNICATION_TIME,
                                    (Y.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + Y.VL_COMMUNICATION_TIME) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    Y.ID_PARAMETER,
                                    Y.CD_PARAMETER,
                                    Y.CD_CONFIGURATION,
                                    Y.ID_ALGORITHM,
                                    Y.DS_ALGORITHM,
                                    Y.ID_FUNCTION,
                                    Y.DS_FUNCTION,
                                    Y.ID_DEVICE,
                                    Y.DS_DEVICE,
                                    Y.ID_DATASET,
                                    Y.ID_RESOURCE,
                                    Y.ID_PARAMETER_TYPE,
                                    Y.DS_PARAMETER_TYPE,
                                    Y.DS_PARAMETER_ATTRIBUTE,
                                    Y.NR_ITERATIONS,
                                    Y.VL_GRID_ROW_DIMENSION,
                                    Y.VL_GRID_COLUMN_DIMENSION,
                                    Y.VL_BLOCK_ROW_DIMENSION,
                                    Y.VL_BLOCK_COLUMN_DIMENSION,
                                    Y.VL_BLOCK_MEMORY_SIZE,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    Y.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    Y.DS_RESOURCE,
                                    Y.NR_NODES,
                                    Y.NR_COMPUTING_UNITS_CPU,
                                    Y.NR_COMPUTING_UNITS_GPU,
                                    Y.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    Y.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
									Y.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                    Y.DS_DATASET,
                                    Y.VL_DATASET_MEMORY_SIZE,
                                    Y.DS_DATA_TYPE,
                                    Y.VL_DATA_TYPE_MEMORY_SIZE,
                                    Y.VL_DATASET_DIMENSION,
                                    Y.VL_DATASET_ROW_DIMENSION,
                                    Y.VL_DATASET_COLUMN_DIMENSION,
                                    Y.NR_RANDOM_STATE
                                    FROM
                                    (
                                        SELECT
                                        AVG(X.VL_TOTAL_EXECUTION_TIME) AS VL_TOTAL_EXECUTION_TIME,
                                        AVG(X.VL_INTER_TASK_EXECUTION_TIME) AS VL_INTER_TASK_EXECUTION_TIME,
                                        AVG(X.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                        AVG(X.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                        AVG(X.VL_COMMUNICATION_TIME_1) AS VL_COMMUNICATION_TIME_1,
                                        AVG(X.VL_COMMUNICATION_TIME_2) AS VL_COMMUNICATION_TIME_2,
                                        AVG(X.VL_COMMUNICATION_TIME) AS VL_COMMUNICATION_TIME,
                                        AVG(X.VL_ADDITIONAL_TIME_1) AS VL_ADDITIONAL_TIME_1,
                                        AVG(X.VL_ADDITIONAL_TIME_2) AS VL_ADDITIONAL_TIME_2,
                                        AVG(X.VL_ADDITIONAL_TIME) AS VL_ADDITIONAL_TIME,
                                        X.ID_PARAMETER,
                                        X.CD_PARAMETER,
                                        X.CD_CONFIGURATION,
                                        X.ID_ALGORITHM,
                                        X.DS_ALGORITHM,
                                        X.ID_FUNCTION,
                                        X.DS_FUNCTION,
                                        X.ID_DEVICE,
                                        X.DS_DEVICE,
                                        X.ID_DATASET,
                                        X.ID_RESOURCE,
                                        X.ID_PARAMETER_TYPE,
                                        X.DS_PARAMETER_TYPE,
                                        X.DS_PARAMETER_ATTRIBUTE,
                                        X.NR_ITERATIONS,
                                        X.VL_GRID_ROW_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION,
                                        X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_BLOCK_ROW_DIMENSION,
                                        X.VL_BLOCK_COLUMN_DIMENSION,
                                        X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                        X.VL_BLOCK_MEMORY_SIZE,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.DS_RESOURCE,
                                        X.NR_NODES,
                                        X.NR_COMPUTING_UNITS_CPU,
                                        X.NR_COMPUTING_UNITS_GPU,
                                        X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                        X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
										X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                        X.DS_DATASET,
                                        X.VL_DATASET_MEMORY_SIZE,
                                        X.DS_DATA_TYPE,
                                        X.VL_DATA_TYPE_MEMORY_SIZE,
                                        X.VL_DATASET_DIMENSION,
                                        X.VL_DATASET_ROW_DIMENSION,
                                        X.VL_DATASET_COLUMN_DIMENSION,
                                        X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                        X.NR_RANDOM_STATE
                                        FROM
                                        (
                                            SELECT
                                                A.ID_EXPERIMENT,
                                                A.VL_TOTAL_EXECUTION_TIME,
                                                A.VL_INTER_TASK_EXECUTION_TIME,
                                                A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                                A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                                A.VL_COMMUNICATION_TIME_1,
                                                A.VL_COMMUNICATION_TIME_2,
                                                A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                                A.VL_ADDITIONAL_TIME_1,
                                                A.VL_ADDITIONAL_TIME_2,
                                                A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                                A.DT_PROCESSING,
                                                B.ID_PARAMETER,
                                                B.CD_PARAMETER,
                                                B.CD_CONFIGURATION,
                                                B.ID_ALGORITHM,
                                                (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                                B.ID_FUNCTION,
                                                (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                                (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                                (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                                B.ID_DATASET,
                                                B.ID_RESOURCE,
                                                B.ID_PARAMETER_TYPE,
                                                (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                                (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                                B.NR_ITERATIONS,
                                                B.VL_GRID_ROW_DIMENSION,
                                                B.VL_GRID_COLUMN_DIMENSION,
                                                B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                                                ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                                B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                                B.VL_BLOCK_ROW_DIMENSION,
                                                B.VL_BLOCK_COLUMN_DIMENSION,
                                                B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                                B.VL_BLOCK_MEMORY_SIZE,
                                                B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                                B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                                ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                                ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                                C.DS_RESOURCE,
                                                C.NR_NODES,
                                                C.NR_COMPUTING_UNITS_CPU,
                                                C.NR_COMPUTING_UNITS_GPU,
                                                C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                                C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
												(C.NR_NODES-1) || ' (' || (C.NR_NODES-1)*C.NR_COMPUTING_UNITS_CPU || ';' || (C.NR_NODES-1)*4 || ')' AS NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                                D.DS_DATASET,
                                                D.VL_DATASET_MEMORY_SIZE,
                                                D.DS_DATA_TYPE,
                                                D.VL_DATA_TYPE_MEMORY_SIZE,
                                                D.VL_DATASET_DIMENSION,
                                                D.VL_DATASET_ROW_DIMENSION,
                                                D.VL_DATASET_COLUMN_DIMENSION,
                                                D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                                D.NR_RANDOM_STATE
                                            FROM EXPERIMENT_RAW A
                                            INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                            INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                            INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                            WHERE
                                            (SELECT DISTINCT Z.DS_DEVICE FROM FUNCTION W INNER JOIN DEVICE Z ON (W.ID_DEVICE = Z.ID_DEVICE) WHERE W.ID_FUNCTION = B.ID_FUNCTION) = 'GPU'
                                            AND A.NR_ALGORITHM_ITERATION <> 0
                                        ) X
                                        GROUP BY
                                        X.ID_PARAMETER,
                                        X.CD_PARAMETER,
                                        X.CD_CONFIGURATION,
                                        X.ID_ALGORITHM,
                                        X.DS_ALGORITHM,
                                        X.ID_FUNCTION,
                                        X.DS_FUNCTION,
                                        X.ID_DEVICE,
                                        X.DS_DEVICE,
                                        X.ID_DATASET,
                                        X.ID_RESOURCE,
                                        X.ID_PARAMETER_TYPE,
                                        X.DS_PARAMETER_TYPE,
                                        X.DS_PARAMETER_ATTRIBUTE,
                                        X.NR_ITERATIONS,
                                        X.VL_GRID_ROW_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION,
                                        X.VL_GRID_ROW_X_COLUMN_DIMENSION,
                                        X.VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                        X.VL_BLOCK_ROW_DIMENSION,
                                        X.VL_BLOCK_COLUMN_DIMENSION,
                                        X.VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                        X.VL_BLOCK_MEMORY_SIZE,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                        X.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                        X.DS_RESOURCE,
                                        X.NR_NODES,
                                        X.NR_COMPUTING_UNITS_CPU,
                                        X.NR_COMPUTING_UNITS_GPU,
                                        X.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                        X.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
										X.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
                                        X.DS_DATASET,
                                        X.VL_DATASET_MEMORY_SIZE,
                                        X.DS_DATA_TYPE,
                                        X.VL_DATA_TYPE_MEMORY_SIZE,
                                        X.VL_DATASET_DIMENSION,
                                        X.VL_DATASET_ROW_DIMENSION,
                                        X.VL_DATASET_COLUMN_DIMENSION,
                                        X.VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                        X.NR_RANDOM_STATE
                                    ) Y
                    )
                    SELECT
                    T_CPU.ID_PARAMETER_TYPE,
                    T_CPU.CD_PARAMETER,
                    T_CPU.DS_ALGORITHM,
                    T_CPU.NR_ITERATIONS,
                    CASE
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3
                    ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1)
					END AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                    CASE
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
                    ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')'
					END AS CONCAT_BLOCK_PERCENT_DATASET_GRID_DIMENSION,
                    --ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                    T_CPU.DS_RESOURCE,
                    T_CPU.DS_PARAMETER_TYPE,
                    T_CPU.DS_PARAMETER_ATTRIBUTE,
                    T_CPU.DS_DATASET,
                    CAST(T_CPU.VL_DATASET_MEMORY_SIZE*1e-6 AS BIGINT) as VL_DATASET_MEMORY_SIZE,
                    T_CPU.VL_DATASET_DIMENSION,
                    T_CPU.VL_DATASET_ROW_DIMENSION,
                    T_CPU.VL_DATASET_COLUMN_DIMENSION,
                    T_CPU.VL_GRID_ROW_DIMENSION,
                    T_CPU.VL_GRID_COLUMN_DIMENSION,
                    T_CPU.VL_BLOCK_ROW_DIMENSION,
                    T_CPU.VL_BLOCK_COLUMN_DIMENSION,
                    T_CPU.VL_BLOCK_MEMORY_SIZE,
                    ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION || ' x ' || T_CPU.VL_GRID_COLUMN_DIMENSION  || ')' AS VL_CONCAT_BLOCK_SIZE_MB_GRID_ROW_X_COLUMN_DIMENSION,
					T_CPU.NR_CONCAT_NODES_TOTAL_COMPUTING_UNITS_CPU_GPU,
					CASE
						WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
							THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5 || ')'
						WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
							THEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE*1e-6,0) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
						ELSE
							'999999999999'
					END AS VL_CONCAT_BLOCK_SIZE_MB_NR_TASKS,
					CASE
						WHEN T_CPU.DS_ALGORITHM = 'KMEANS'
							THEN
								CASE
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
									ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
								END
						WHEN T_CPU.DS_ALGORITHM = 'MATMUL_DISLIB'
							THEN
								CASE
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.3 THEN 0.4 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 0.7 THEN 0.8 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 1.5 THEN 1.6 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 3.0 THEN 3.1 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									WHEN ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) = 6.2 THEN 6.3 || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION + T_CPU.VL_GRID_ROW_DIMENSION*T_CPU.VL_GRID_ROW_DIMENSION*(T_CPU.VL_GRID_ROW_DIMENSION-1)  || ')'
									ELSE ROUND(T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,1) || ' (' || T_CPU.VL_GRID_ROW_DIMENSION*5  || ')'
								END
						ELSE
							'999999999999'
					END AS CONCAT_BLOCK_PERCENT_DATASET_NR_TASKS,
                    T_CPU.VL_INTER_TASK_EXECUTION_TIME AS VL_INTER_TASK_EXECUTION_TIME_CPU,
					T_GPU.VL_INTER_TASK_EXECUTION_TIME AS VL_INTER_TASK_EXECUTION_TIME_GPU,
					T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC_CPU,
					T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC_GPU,
					T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC_CPU,
					T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC AS VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC_GPU,
					CASE
                    WHEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME) > 1.00 THEN (T_CPU.VL_INTER_TASK_EXECUTION_TIME/T_GPU.VL_INTER_TASK_EXECUTION_TIME)
                    ELSE -(T_GPU.VL_INTER_TASK_EXECUTION_TIME/T_CPU.VL_INTER_TASK_EXECUTION_TIME)
                    END AS SPEEDUP_GPU_INTER_TASK_EXECUTION_TIME,
                    CASE
                    WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
                    ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC)
                    END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                    CASE
                    WHEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC) > 1.00 THEN (T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
                    ELSE -(T_GPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC/T_CPU.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC)
                    END AS SPEEDUP_GPU_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC
                    FROM T_CPU INNER JOIN T_GPU ON (T_CPU.CD_PARAMETER = T_GPU.CD_PARAMETER)
                    WHERE
                    T_CPU.VL_GRID_ROW_DIMENSION = T_GPU.VL_GRID_ROW_DIMENSION
                    AND T_CPU.VL_GRID_COLUMN_DIMENSION = T_GPU.VL_GRID_COLUMN_DIMENSION
                    AND T_CPU.VL_BLOCK_ROW_DIMENSION = T_GPU.VL_BLOCK_ROW_DIMENSION
                    AND T_CPU.VL_BLOCK_COLUMN_DIMENSION = T_GPU.VL_BLOCK_COLUMN_DIMENSION
					AND T_CPU.ds_algorithm='KMEANS'
					AND T_CPU.nr_iterations = 5
					AND T_CPU.ds_dataset = 'S_10GB_1'
					--AND ZZ.ds_parameter_type = 'VAR_CORES_CLUSTER_1'
					--AND ZZ.id_resource IN (3,4,5,6,7,8,9,10)
					AND T_CPU.ds_parameter_type = 'VAR_GRID_ROW_5'
					AND T_CPU.VL_GRID_ROW_DIMENSION in (256)
					AND T_CPU.VL_GRID_COLUMN_DIMENSION in (1)
					ORDER BY
					T_CPU.DS_DATASET,
					T_CPU.VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET;

					




-- Query to check individual executions
				SELECT
                                    A.ID_EXPERIMENT,
                                    A.VL_TOTAL_EXECUTION_TIME,
                                    A.VL_INTER_TASK_EXECUTION_TIME,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_FULL_FUNC,
                                    A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC,
                                    A.VL_COMMUNICATION_TIME_1,
                                    A.VL_COMMUNICATION_TIME_2,
                                    A.VL_COMMUNICATION_TIME_1 + A.VL_COMMUNICATION_TIME_2 AS VL_COMMUNICATION_TIME,
                                    A.VL_ADDITIONAL_TIME_1,
                                    A.VL_ADDITIONAL_TIME_2,
                                    A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2 AS VL_ADDITIONAL_TIME,
                                    (A.VL_INTRA_TASK_EXECUTION_TIME_DEVICE_FUNC + A.VL_ADDITIONAL_TIME_1 + A.VL_ADDITIONAL_TIME_2) AS VL_INTRA_TASK_EXECUTION_TIME_FREE_ADDITIONAL,
                                    A.DT_PROCESSING,
                                    B.ID_PARAMETER,
                                    B.CD_PARAMETER,
                                    B.CD_CONFIGURATION,
                                    B.ID_ALGORITHM,
                                    (SELECT DISTINCT X.DS_ALGORITHM FROM ALGORITHM X WHERE X.ID_ALGORITHM = B.ID_ALGORITHM) AS DS_ALGORITHM,
                                    B.ID_FUNCTION,
                                    (SELECT DISTINCT X.DS_FUNCTION FROM FUNCTION X WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_FUNCTION,
                                    (SELECT DISTINCT Y.ID_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS ID_DEVICE,
                                    (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) AS DS_DEVICE,
                                    B.ID_DATASET,
                                    B.ID_RESOURCE,
                                    B.ID_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_TYPE,
                                    (SELECT X.DS_PARAMETER_ATTRIBUTE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) AS DS_PARAMETER_ATTRIBUTE,
                                    B.NR_ITERATIONS,
                                    B.VL_GRID_ROW_DIMENSION,
                                    B.VL_GRID_COLUMN_DIMENSION,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION AS VL_GRID_ROW_X_COLUMN_DIMENSION,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || '(' || ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ')' AS VL_CONCAT_GRID_ROW_X_COLUMN_DIMENSION_BLOCK_SIZE_MB,
									ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) AS VL_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    B.VL_GRID_ROW_DIMENSION || ' x ' || B.VL_GRID_COLUMN_DIMENSION || ' (' || ROUND((CAST(B.VL_GRID_COLUMN_DIMENSION AS NUMERIC)/CAST(D.VL_DATASET_COLUMN_DIMENSION AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_GRID_COLUMN_DIMENSION_PERCENT_DATASET,
                                    B.VL_BLOCK_ROW_DIMENSION,
                                    B.VL_BLOCK_COLUMN_DIMENSION,
                                    B.VL_BLOCK_ROW_DIMENSION || ' x ' || B.VL_BLOCK_COLUMN_DIMENSION AS VL_BLOCK_ROW_X_COLUMN_DIMENSION,
                                    B.VL_BLOCK_MEMORY_SIZE,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_CPU,
                                    B.VL_BLOCK_MEMORY_SIZE_PERCENT_GPU,
                                    ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) AS VL_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    ROUND(B.VL_BLOCK_MEMORY_SIZE*1e-6,2) || ' (' || ROUND((CAST(B.VL_BLOCK_MEMORY_SIZE AS NUMERIC)/CAST(D.VL_DATASET_MEMORY_SIZE AS NUMERIC))*100,2) || '%)' AS VL_CONCAT_BLOCK_MEMORY_SIZE_PERCENT_DATASET,
                                    C.DS_RESOURCE,
                                    C.NR_NODES,
                                    C.NR_COMPUTING_UNITS_CPU,
                                    C.NR_COMPUTING_UNITS_GPU,
                                    C.VL_MEMORY_SIZE_PER_CPU_COMPUTING_UNIT,
                                    C.VL_MEMORY_SIZE_PER_GPU_COMPUTING_UNIT,
                                    D.DS_DATASET,
                                    D.VL_DATASET_MEMORY_SIZE,
                                    D.DS_DATA_TYPE,
                                    D.VL_DATA_TYPE_MEMORY_SIZE,
                                    D.VL_DATASET_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION,
                                    D.VL_DATASET_COLUMN_DIMENSION,
                                    D.VL_DATASET_ROW_DIMENSION || ' x ' || D.VL_DATASET_COLUMN_DIMENSION AS VL_DATASET_ROW_X_COLUMN_DIMENSION,
                                    D.NR_RANDOM_STATE
                                FROM EXPERIMENT_RAW A
                                INNER JOIN PARAMETER B ON (A.ID_PARAMETER = B.ID_PARAMETER)
                                INNER JOIN RESOURCE C ON (B.ID_RESOURCE = C.ID_RESOURCE)
                                INNER JOIN DATASET D ON (B.ID_DATASET = D.ID_DATASET)
                                WHERE
                                A.NR_ALGORITHM_ITERATION = 0
								AND B.nr_iterations = 5
								AND D.ds_dataset = 'S_10GB_1'
								AND (SELECT X.DS_PARAMETER_TYPE FROM PARAMETER_TYPE X WHERE X.ID_PARAMETER_TYPE = B.ID_PARAMETER_TYPE) = 'VAR_GRID_ROW_11'
								AND B.VL_GRID_ROW_DIMENSION = 16
								AND B.VL_GRID_COLUMN_DIMENSION = 1
								AND A.VL_INTER_TASK_EXECUTION_TIME IS NOT NULL
								AND (SELECT DISTINCT Y.DS_DEVICE FROM FUNCTION X INNER JOIN DEVICE Y ON (X.ID_DEVICE = Y.ID_DEVICE) WHERE X.ID_FUNCTION = B.ID_FUNCTION) = 'CPU'
								--ORDER BY A.VL_INTER_TASK_EXECUTION_TIME DESC